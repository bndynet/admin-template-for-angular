/**!
 * admin-template-for-angular v0.0.0
 *
 * Copyright (c) 2024 Bendy Zhang
 * Released under the undefined license
 */
var APP_BUILD = 'Sun Nov 17 2024 11:21:03 GMT+0000 (Coordinated Universal Time)';var APP_VERSION = '0.0.0';(self.webpackChunkadmin_template_for_angular=self.webpackChunkadmin_template_for_angular||[]).push([[139],{139:(fe,oe,K)=>{"use strict";K.r(oe),K.d(oe,{DevModule:()=>mt});var ee=K(1391),Z=K(177),I=K(3666),n=K(3266),a=K(923),l=K(2791),f=K(8359),o=K(8141),d=K(980),e=K(4438),g=K(1626),h=K(6850);let i=(()=>{class E{constructor(C,k,L){this.el=C,this.renderer=k,this.document=L}ngOnChanges(C){C.loading&&(C.loading.currentValue?this.enable():this.disable())}enable(){this.el.nativeElement.classList.add("overlay-parent"),this.renderer.appendChild(this.el.nativeElement,this.getElement())}disable(){this.el.nativeElement.classList.remove("overlay-parent"),this.el.nativeElement.querySelector(".overlay-loading")&&this.renderer.removeChild(this.el.nativeElement,this.el.nativeElement.querySelector(".overlay-loading"))}getElement(){const C=this.document.createElement("div");C.className="overlay overlay-loading";const k=this.document.createElement("div");if(k.className="loading-body",k.innerHTML='<svg class="loading-spinner" viewBox="25 25 50 50" class="circular"><circle cx="50" cy="50" r="20" fill="none" class="path"></circle></svg>',C.appendChild(k),this.loadingText){const L=this.document.createElement("div");L.classList.add("loading-text"),L.innerHTML=this.loadingText,k.appendChild(L)}return C}static{this.\u0275fac=function(k){return new(k||E)(e.rXU(e.aKT),e.rXU(e.sFG),e.rXU(Z.qQ))}}static{this.\u0275dir=e.FsC({type:E,selectors:[["","vLoading",""]],inputs:{loading:[0,"vLoading","loading"],loadingText:[0,"vLoadingText","loadingText"]},features:[e.OA$]})}}return E})();var s=K(9924),t=K(8656),r=K(3801),c=K(4943),_=K(9417),p=K(8834),m=K(9213),u=K(8068);const v=E=>({"no-line-numbers":E});function R(E,A){if(1&E&&(e.j41(0,"div",5),e.EFF(1),e.k0s()),2&E){const C=e.XpG();e.R7$(),e.SpI(" ",C.title," ")}}function D(E,A){if(1&E){const C=e.RV6();e.j41(0,"button",6),e.bIt("click",function(){e.eBV(C);const L=e.XpG();return e.Njj(L.copyContent())}),e.j41(1,"mat-icon"),e.EFF(2,"content_copy"),e.k0s()()}}let B=(()=>{class E{constructor(C,k,L){this.theme=C,this.clipboard=k,this.appService=L,this.theme.themeChanged.subscribe(W=>{this.themeName=this.theme.isDark()?"material":"default"})}ngOnInit(){this.theme.isDark()&&(this.themeName="material")}copyContent(){this.clipboard.copy(this.content),this.appService.notification.success("Copied Successfully")}getOptions(){let C={lineNumbers:!this.hideLineNumbers,mode:this.language,readOnly:!this.editable};return this.themeName&&(C={...C,theme:this.themeName}),C}static{this.\u0275fac=function(k){return new(k||E)(e.rXU(t.F),e.rXU(r.B0),e.rXU(c.d3))}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["el-code-block"]],inputs:{title:"title",content:"content",language:"language",loading:"loading",editable:"editable",hideLineNumbers:"hideLineNumbers"},decls:5,vars:9,consts:[[1,"cb",3,"ngClass"],["class","cb-header",4,"ngIf"],[1,"cb-content",3,"vLoading"],["mat-icon-button","","class","cb-copy-button","aria-label","Copy",3,"click",4,"ngIf"],[3,"ngModelChange","ngModel","preserveScrollPosition","options"],[1,"cb-header"],["mat-icon-button","","aria-label","Copy",1,"cb-copy-button",3,"click"]],template:function(k,L){1&k&&(e.j41(0,"div",0),e.DNE(1,R,2,1,"div",1),e.j41(2,"div",2),e.DNE(3,D,3,0,"button",3),e.j41(4,"ngx-codemirror",4),e.mxI("ngModelChange",function(J){return e.DH7(L.content,J)||(L.content=J),J}),e.k0s()()()),2&k&&(e.Y8G("ngClass",e.eq3(7,v,L.hideLineNumbers)),e.R7$(),e.Y8G("ngIf",L.title),e.R7$(),e.Y8G("vLoading",!0===L.loading),e.R7$(),e.Y8G("ngIf",L.content),e.R7$(),e.R50("ngModel",L.content),e.Y8G("preserveScrollPosition",!1)("options",L.getOptions()))},dependencies:[Z.YU,Z.bT,_.BC,_.vS,p.iY,m.An,u.W,i],styles:[".cb[_ngcontent-%COMP%]{position:relative}.cb.no-line-numbers[_ngcontent-%COMP%]   .cb-content[_ngcontent-%COMP%]{padding:0 0 0 .75rem}.cb-header[_ngcontent-%COMP%]{border-radius:5px 5px 0 0;color:#fff;min-height:20px;padding:.75rem 1rem}.cb-copy-button[_ngcontent-%COMP%]{position:absolute;right:5px;top:2px;z-index:10}.cb-content[_ngcontent-%COMP%]{background-color:#fff;border:solid 1px #efefef;border-radius:0 0 5px 5px;border-top:none;position:relative}[_nghost-%COMP%]   .cb-header[_ngcontent-%COMP%]{background-color:var(----background)}[_nghost-%COMP%]   .cb-content[_ngcontent-%COMP%]{background-color:var(----secondary-background);border-color:var(----divider)}[_nghost-%COMP%]     .CodeMirror{background-color:transparent!important}.popular   [_nghost-%COMP%]   .cb-header[_ngcontent-%COMP%]{background-color:var(--popular--background)}.popular   [_nghost-%COMP%]   .cb-content[_ngcontent-%COMP%]{background-color:var(--popular--secondary-background);border-color:var(--popular--divider)}.popular   [_nghost-%COMP%]     .CodeMirror{background-color:transparent!important}.dark   [_nghost-%COMP%]   .cb-header[_ngcontent-%COMP%]{background-color:var(--dark--background)}.dark   [_nghost-%COMP%]   .cb-content[_ngcontent-%COMP%]{background-color:var(--dark--secondary-background);border-color:var(--dark--divider)}.dark   [_nghost-%COMP%]     .CodeMirror{background-color:transparent!important}  .CodeMirror,   .CodeMirror pre.CodeMirror-line,   .CodeMirror pre.CodeMirror-line-like{font-family:Roboto Mono,monospace}  .CodeMirror-gutters{border-color:#efefef}"]})}}return E})();function y(E,A){if(1&E&&(e.j41(0,"mat-tab",6),e.nrm(1,"el-code-block",7),e.k0s()),2&E){const C=A.$implicit,k=e.XpG(2);e.FS9("label",C.tag),e.R7$(),e.Y8G("vLoading",k.loadingCode)("language",C.lang)("content",C.code)("hideLineNumbers",!0)}}function O(E,A){if(1&E){const C=e.RV6();e.j41(0,"section",3)(1,"mat-tab-group",4),e.mxI("selectedIndexChange",function(L){e.eBV(C);const W=e.XpG();return e.DH7(W.currentTabIndex,L)||(W.currentTabIndex=L),e.Njj(L)}),e.bIt("selectedTabChange",function(L){e.eBV(C);const W=e.XpG();return e.Njj(W.changeCompFile(L))}),e.DNE(2,y,2,5,"mat-tab",5),e.k0s()()}if(2&E){const C=e.XpG();e.R7$(),e.R50("selectedIndex",C.currentTabIndex),e.Y8G("@.disabled",!0),e.R7$(),e.Y8G("ngForOf",C.compFiles)}}let H=(()=>{class E{constructor(C,k){this.router=C,this.http=k,this.currentTabIndex=0,this.compFiles=[],this.showCode=!0,this.fileTagLangMapping={TS:"javascript",HTML:"xml",SCSS:"css"},this.subs=new f.yU,this.router.events.subscribe(L=>{if(L instanceof l.wF){const W=L.urlAfterRedirects,J=W.split("/")[W.split("/").length-1],pe=`${W.replace("/admin/","assets/")}/${J}.component`;if(this.title=J.toUpperCase().replace("-"," "),!L.url.includes("examples"))return void(this.showCode=!1);this.showCode=!0,this.compFiles=[],Object.keys(this.fileTagLangMapping).forEach(_e=>{this.compFiles.push({tag:_e,lang:this.fileTagLangMapping[_e],name:`${pe}.${_e.toLowerCase()}`,code:""})}),this.currentTabIndex=0,this.changeCompFile({index:this.currentTabIndex,tab:null})}})}ngOnInit(){}ngOnDestroy(){this.subs.unsubscribe()}changeCompFile(C){const k=this.compFiles[C.index];k.code||this.subs.add(this.http.get(k.name,{responseType:"text"}).pipe((0,o.M)(()=>{this.loadingCode=!0}),(0,d.j)(()=>{this.loadingCode=!1})).subscribe(L=>{k.code=L}))}static{this.\u0275fac=function(k){return new(k||E)(e.rXU(l.Ix),e.rXU(g.Qq))}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["app-dev"]],decls:4,vars:2,consts:[[3,"title"],[1,"page-container"],["class","code-section",4,"ngIf"],[1,"code-section"],[3,"selectedIndexChange","selectedTabChange","selectedIndex"],[3,"label",4,"ngFor","ngForOf"],[3,"label"],[3,"vLoading","language","content","hideLineNumbers"]],template:function(k,L){1&k&&(e.nrm(0,"el-page-header",0),e.j41(1,"div",1),e.nrm(2,"router-outlet"),e.DNE(3,O,3,3,"section",2),e.k0s()),2&k&&(e.Y8G("title",L.title),e.R7$(3),e.Y8G("ngIf",L.showCode))},dependencies:[Z.Sq,Z.bT,l.n3,h.mq,h.T8,i,s.y,B],styles:[".code-section[_ngcontent-%COMP%]{margin-top:2rem}"]})}}return E})();var U=K(123),z=K(1835),$=K(5351),S=K(9631),w=K(3719),x=K(1958);function T(E,A){if(1&E&&(e.j41(0,"h3"),e.EFF(1),e.k0s()),2&E){const C=e.XpG();e.R7$(),e.SpI("Hi ",C.name,"!")}}let F=(()=>{class E{constructor(C,k){this.app=C,this.dialog=k}ngOnInit(){}close(){this.dialog.close()}save(){this.pending=!0,this.app.status.requesting(),setTimeout(()=>{this.close(),this.pending=!1,this.app.status.requested(),this.app.notification.info(`Saving ${name} ...`)},3e3)}static{this.\u0275fac=function(k){return new(k||E)(e.rXU(z.d),e.rXU($.CP))}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["app-examples-dialog-form"]],decls:17,vars:7,consts:[["title","Form",3,"showCloseIcon","loading"],["body",""],[2,"width","600px",3,"vLoading"],[1,"full-width"],["name","name","matInput","","placeholder","Your name...",3,"ngModelChange","ngModel"],["rows","8","name","des","matInput","","placeholder","Your name..."],[4,"ngIf"],["footer",""],["mat-raised-button","",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(k,L){1&k&&(e.j41(0,"el-dialog",0),e.qex(1,1),e.j41(2,"form",2)(3,"mat-form-field",3)(4,"mat-label"),e.EFF(5,"Name"),e.k0s(),e.j41(6,"input",4),e.mxI("ngModelChange",function(J){return e.DH7(L.name,J)||(L.name=J),J}),e.k0s()(),e.j41(7,"mat-form-field",3)(8,"mat-label"),e.EFF(9,"Description"),e.k0s(),e.nrm(10,"textarea",5),e.k0s()(),e.DNE(11,T,2,1,"h3",6),e.bVm(),e.qex(12,7),e.j41(13,"button",8),e.bIt("click",function(){return L.close()}),e.EFF(14," Cancel "),e.k0s(),e.j41(15,"button",9),e.bIt("click",function(){return L.save()}),e.EFF(16," Save "),e.k0s(),e.bVm(),e.k0s()),2&k&&(e.Y8G("showCloseIcon",!0)("loading",L.pending),e.R7$(2),e.Y8G("vLoading",L.pending),e.R7$(4),e.R50("ngModel",L.name),e.R7$(5),e.Y8G("ngIf",L.name),e.R7$(2),e.Y8G("disabled",L.pending),e.R7$(2),e.Y8G("disabled",L.pending))},dependencies:[Z.bT,_.qT,_.me,_.BC,_.cb,_.vS,_.cV,p.$z,S.fg,w.rl,w.nJ,i,x.m]})}}return E})();const j=E=>({loading:E});let q=(()=>{class E{constructor(C,k,L,W){this.http=C,this.app=k,this.status=L,this.notification=W,this.buttonLoading=!1,this.requesting=!1}ngOnInit(){}toggleRequesting(){this.requesting=!this.requesting,this.requesting?this.status.requesting():this.status.requested()}showInfo(C){this.notification.info(C)}showSuccess(C){this.notification.success(C)}showWarning(C){this.notification.warn(C)}showError(C){this.notification.error(C)}alert(){this.app.dialog.alert("Alert Dialog","This is an alert dialog.",()=>{this.notification.info("Done")})}confirm(){this.app.dialog.confirm("Confirm Dialog","This is a confirm dialog.",()=>{this.notification.info("Done")})}delete(){this.app.dialog.deleteConfirm(()=>{this.notification.info("Done")})}formDialog(){this.app.dialog.open(F,{},()=>{})}requestError(){(0,U.OC)(this.http).subscribe()}static{this.\u0275fac=function(k){return new(k||E)(e.rXU(g.Qq),e.rXU(c.d3),e.rXU(c.KJ),e.rXU(c.JE))}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["app-examples-button"]],decls:42,vars:22,consts:[["mat-raised-button","",3,"click"],["mat-raised-button","",3,"click","ngClass"],["mat-raised-button","","color","primary",3,"click","ngClass","disabled"],["mat-fab","","color","primary",3,"click","ngClass"],["mat-fab","","color","primary",3,"click","ngClass","disabled"],["mat-mini-fab","","color","primary",3,"click","ngClass","disabled"],["mat-icon-button","","color","primary",3,"click","ngClass","disabled"]],template:function(k,L){1&k&&(e.j41(0,"button",0),e.bIt("click",function(){return L.toggleRequesting()}),e.EFF(1,"Global Progress"),e.k0s(),e.j41(2,"button",1),e.bIt("click",function(){return L.buttonLoading=!L.buttonLoading}),e.EFF(3,"Loading Button"),e.k0s(),e.j41(4,"button",2),e.bIt("click",function(){return L.buttonLoading=!L.buttonLoading}),e.EFF(5,"Loading"),e.k0s(),e.j41(6,"button",3),e.bIt("click",function(){return L.buttonLoading=!L.buttonLoading}),e.j41(7,"mat-icon"),e.EFF(8,"save"),e.k0s()(),e.j41(9,"button",4),e.bIt("click",function(){return L.buttonLoading=!L.buttonLoading}),e.j41(10,"mat-icon"),e.EFF(11,"save"),e.k0s()(),e.j41(12,"button",5),e.bIt("click",function(){return L.buttonLoading=!L.buttonLoading}),e.j41(13,"mat-icon"),e.EFF(14,"save"),e.k0s()(),e.j41(15,"button",6),e.bIt("click",function(){return L.buttonLoading=!L.buttonLoading}),e.j41(16,"mat-icon"),e.EFF(17,"save"),e.k0s()(),e.nrm(18,"br")(19,"br"),e.j41(20,"button",0),e.bIt("click",function(){return L.showInfo("Information")}),e.EFF(21,"Show Information"),e.k0s(),e.j41(22,"button",0),e.bIt("click",function(){return L.showSuccess("Success")}),e.EFF(23,"Show Success"),e.k0s(),e.j41(24,"button",0),e.bIt("click",function(){return L.showWarning("Warning")}),e.EFF(25,"Show Warning"),e.k0s(),e.j41(26,"button",0),e.bIt("click",function(){return L.showError("Error")}),e.EFF(27,"Show Error"),e.k0s(),e.nrm(28,"br")(29,"br"),e.j41(30,"button",0),e.bIt("click",function(){return L.alert()}),e.EFF(31,"Alert"),e.k0s(),e.j41(32,"button",0),e.bIt("click",function(){return L.confirm()}),e.EFF(33,"Confirm"),e.k0s(),e.j41(34,"button",0),e.bIt("click",function(){return L.delete()}),e.EFF(35,"Delete Confirm"),e.k0s(),e.j41(36,"button",0),e.bIt("click",function(){return L.formDialog()}),e.EFF(37,"Form Dialog"),e.k0s(),e.nrm(38,"br")(39,"br"),e.j41(40,"button",0),e.bIt("click",function(){return L.requestError()}),e.EFF(41,"Request with Error"),e.k0s()),2&k&&(e.R7$(2),e.Y8G("ngClass",e.eq3(10,j,L.buttonLoading)),e.R7$(2),e.Y8G("ngClass",e.eq3(12,j,L.buttonLoading))("disabled",L.buttonLoading),e.R7$(2),e.Y8G("ngClass",e.eq3(14,j,L.buttonLoading)),e.R7$(3),e.Y8G("ngClass",e.eq3(16,j,L.buttonLoading))("disabled",L.buttonLoading),e.R7$(3),e.Y8G("ngClass",e.eq3(18,j,L.buttonLoading))("disabled",L.buttonLoading),e.R7$(3),e.Y8G("ngClass",e.eq3(20,j,L.buttonLoading))("disabled",L.buttonLoading))},dependencies:[Z.YU,p.$z,p.iY,p.$0,p.Sr,m.An],styles:["button[_ngcontent-%COMP%]{margin-right:.5rem}"]})}}return E})();var Y=K(5596);function M(E,A){if(1&E&&(e.j41(0,"a",2),e.EFF(1),e.k0s()),2&E){const C=A.$implicit;e.Y8G("routerLink",C.value),e.R7$(),e.JRh(C.key)}}let b=(()=>{class E{constructor(){}ngOnInit(){}static{this.\u0275fac=function(k){return new(k||E)}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["el-icon-card"]],inputs:{color:"color",icon:"icon",value:"value",label:"label",links:"links"},decls:10,vars:9,consts:[["appearance","outlined"],["routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf"],["routerLinkActive","active",3,"routerLink"]],template:function(k,L){1&k&&(e.j41(0,"mat-card",0)(1,"mat-icon"),e.EFF(2),e.k0s(),e.j41(3,"mat-card-title"),e.EFF(4),e.k0s(),e.j41(5,"mat-card-subtitle"),e.EFF(6),e.k0s(),e.j41(7,"mat-card-footer"),e.DNE(8,M,2,2,"a",1),e.nI1(9,"keyvalue"),e.k0s()()),2&k&&(e.ZvI("mat-",L.color,""),e.R7$(2),e.JRh(L.icon),e.R7$(2),e.JRh(L.value),e.R7$(2),e.JRh(L.label),e.R7$(2),e.Y8G("ngForOf",e.bMT(9,7,L.links)))},dependencies:[Z.Sq,l.Wk,l.wQ,Y.RN,Y.WQ,Y.Lc,Y.dh,m.An,Z.lG],styles:["[_nghost-%COMP%]{display:block;min-width:200px;width:100%}[_nghost-%COMP%]:hover   .mat-icon[_ngcontent-%COMP%]{transform:scale(1.25)}[color][_nghost-%COMP%]   a[_ngcontent-%COMP%]{color:#dedede}[color][_nghost-%COMP%]   .mat-mdc-card[_ngcontent-%COMP%]{color:#ffffffb3}[color][_nghost-%COMP%]   .mat-mdc-card-subtitle[_ngcontent-%COMP%]{color:#ffffffb3}[color][_nghost-%COMP%]:hover   .mat-mdc-card[_ngcontent-%COMP%]{color:#fff}[color][_nghost-%COMP%]:hover   .mat-mdc-card-subtitle[_ngcontent-%COMP%]{color:#fff}[_nghost-%COMP%]     .mat-mdc-card-title, [_nghost-%COMP%]     .mat-mdc-card-subtitle{padding:.5rem 1rem}a[_ngcontent-%COMP%]{text-decoration:none}.mat-icon[_ngcontent-%COMP%]{font-size:3.5rem;height:inherit;opacity:.2;position:absolute;right:10px;top:10px;transition:all .5s ease-in-out;width:inherit}.mat-mdc-card-footer[_ngcontent-%COMP%]{display:flex;font-size:.85rem;text-align:center}.mat-mdc-card-footer[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{background-color:#0000001a;cursor:pointer;flex:1;padding:5px}.mat-mdc-card-footer[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:hover{background-color:#0003}[color=primary][_nghost-%COMP%]     .mat-mdc-card{background-color:var(----primary)}[color=accent][_nghost-%COMP%]     .mat-mdc-card{background-color:var(----accent)}[color=warn][_nghost-%COMP%]     .mat-mdc-card{background-color:var(----warn)}.popular   [color=primary][_nghost-%COMP%]     .mat-mdc-card{background-color:var(--popular--primary)}.popular   [color=accent][_nghost-%COMP%]     .mat-mdc-card{background-color:var(--popular--accent)}.popular   [color=warn][_nghost-%COMP%]     .mat-mdc-card{background-color:var(--popular--warn)}.dark   [color=primary][_nghost-%COMP%]     .mat-mdc-card{background-color:var(--dark--primary)}.dark   [color=accent][_nghost-%COMP%]     .mat-mdc-card{background-color:var(--dark--accent)}.dark   [color=warn][_nghost-%COMP%]     .mat-mdc-card{background-color:var(--dark--warn)}"]})}}return E})(),P=(()=>{class E{constructor(){this.links={"Link #1":"link-url","Link #2":"link-url"}}ngOnInit(){}static{this.\u0275fac=function(k){return new(k||E)}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["app-examples-card"]],decls:5,vars:4,consts:[[1,"row","gutter"],["color","primary","icon","shopping_cart","label","New Orders","value","123,231",3,"links"],["color","accent","icon","shopping_cart","label","New Orders","value","123,231",3,"links"],["color","warn","icon","shopping_cart","label","New Orders","value","123,231",3,"links"],["icon","shopping_cart","label","New Orders","value","123,231",3,"links"]],template:function(k,L){1&k&&(e.j41(0,"div",0),e.nrm(1,"el-icon-card",1)(2,"el-icon-card",2)(3,"el-icon-card",3)(4,"el-icon-card",4),e.k0s()),2&k&&(e.R7$(),e.Y8G("links",L.links),e.R7$(),e.Y8G("links",L.links),e.R7$(),e.Y8G("links",L.links),e.R7$(),e.Y8G("links",L.links))},dependencies:[b]})}}return E})(),N=(()=>{class E{toFromGroup(C){const k={};return C.forEach(L=>{k[L.name]=L.required?new _.MJ({value:L.value,disabled:!!L.disabled},_.k0.required):new _.MJ({value:L.value,disabled:!!L.disabled})}),new _.gE(k)}static{this.\u0275fac=function(k){return new(k||E)}}static{this.\u0275prov=e.jDH({token:E,factory:E.\u0275fac})}}return E})();const V=E=>({required:E});function G(E,A){1&E&&(e.j41(0,"span",7),e.EFF(1,"*"),e.k0s())}function Q(E,A){if(1&E){const C=e.RV6();e.j41(0,"input",9),e.bIt("change",function(L){e.eBV(C);const W=e.XpG(2).$implicit,J=e.XpG();return e.Njj(J.changeValue(W,L))}),e.k0s()}if(2&E){const C=e.XpG(2).$implicit;e.Y8G("id",C.name)("name",C.name)("formControlName",C.name),e.BMQ("disabled",C.disabled)("placeholder",C.placeholder)("style",C.style,e.$dS)}}function ie(E,A){if(1&E){const C=e.RV6();e.j41(0,"textarea",9),e.bIt("change",function(L){e.eBV(C);const W=e.XpG(2).$implicit,J=e.XpG();return e.Njj(J.changeValue(W,L))}),e.EFF(1,"      "),e.k0s()}if(2&E){const C=e.XpG(2).$implicit;e.Y8G("id",C.name)("name",C.name)("formControlName",C.name),e.BMQ("disabled",C.disabled)("placeholder",C.placeholder)("style",C.style,e.$dS)}}function re(E,A){if(1&E&&(e.qex(0),e.DNE(1,Q,1,6,"input",8)(2,ie,2,6,"textarea",8),e.bVm()),2&E){const C=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",!C.isMultiline),e.R7$(),e.Y8G("ngIf",C.isMultiline)}}function ne(E,A){if(1&E&&(e.j41(0,"option",11),e.EFF(1),e.k0s()),2&E){const C=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",C.placeholder," ")}}function X(E,A){if(1&E&&(e.j41(0,"option",15),e.EFF(1),e.k0s()),2&E){const C=A.$implicit;e.Y8G("value",C.value),e.R7$(),e.SpI(" ",C.label," ")}}function ge(E,A){if(1&E&&(e.j41(0,"optgroup",13),e.DNE(1,X,2,2,"option",14),e.k0s()),2&E){const C=A.$implicit;e.Y8G("label",C.name),e.R7$(),e.Y8G("ngForOf",C.options)}}function we(E,A){if(1&E&&(e.qex(0),e.DNE(1,ge,2,2,"optgroup",12),e.bVm()),2&E){const C=e.XpG().ngIf;e.R7$(),e.Y8G("ngForOf",C)}}function Ee(E,A){if(1&E&&(e.j41(0,"option",15),e.EFF(1),e.k0s()),2&E){const C=A.$implicit;e.Y8G("value",C.value),e.R7$(),e.SpI(" ",C.label," ")}}function ke(E,A){if(1&E&&(e.qex(0),e.DNE(1,Ee,2,2,"option",14),e.bVm()),2&E){const C=e.XpG(3).$implicit;e.R7$(),e.Y8G("ngForOf",C.options)}}function Ce(E,A){if(1&E&&(e.qex(0),e.DNE(1,we,2,1,"ng-container",5)(2,ke,2,1,"ng-container",5),e.bVm()),2&E){const C=A.ngIf;e.R7$(),e.Y8G("ngIf",C.length>1),e.R7$(),e.Y8G("ngIf",1===C.length)}}function ae(E,A){if(1&E){const C=e.RV6();e.qex(0),e.j41(1,"select",9),e.bIt("change",function(L){e.eBV(C);const W=e.XpG().$implicit,J=e.XpG();return e.Njj(J.changeValue(W,L))}),e.DNE(2,ne,2,1,"option",10)(3,Ce,3,2,"ng-container",5),e.k0s(),e.bVm()}if(2&E){const C=e.XpG().$implicit,k=e.XpG();e.R7$(),e.Y8G("id",C.name)("name",C.name)("formControlName",C.name),e.BMQ("disabled",C.disabled),e.R7$(),e.Y8G("ngIf",!C.required),e.R7$(),e.Y8G("ngIf",k.fieldOptionGroups[C.name])}}function me(E,A){if(1&E&&(e.j41(0,"div",16),e.EFF(1),e.k0s()),2&E){const C=e.XpG().$implicit;e.R7$(),e.SpI(" ",C.requiredMessage," ")}}function he(E,A){if(1&E&&(e.j41(0,"div",2),e.nI1(1,"lowercase"),e.j41(2,"label")(3,"span",3),e.EFF(4),e.k0s(),e.DNE(5,G,2,0,"span",4),e.k0s(),e.DNE(6,re,3,2,"ng-container",5)(7,ae,4,6,"ng-container",5)(8,me,2,1,"div",6),e.k0s()),2&E){const C=A.$implicit,k=e.XpG();e.ZvI("field-item ",e.bMT(1,11,null==k.formGroup.controls[C.name]?null:k.formGroup.controls[C.name].status),""),e.Y8G("ngClass",e.eq3(13,V,C.required)),e.R7$(2),e.BMQ("for",C.name)("style",C.labelStyle,e.$dS),e.R7$(2),e.SpI(" ",C.label," "),e.R7$(),e.Y8G("ngIf",C.required),e.R7$(),e.Y8G("ngIf",!C.options),e.R7$(),e.Y8G("ngIf",C.options),e.R7$(),e.Y8G("ngIf",!(null!=k.formGroup.controls[C.name]&&k.formGroup.controls[C.name].valid))}}let ve=(()=>{class E{constructor(C,k){this.changeDetectorRef=C,this.formControlService=k,this.fieldValueChange=new e.bkB,this.init=new e.bkB,this.fieldOptionGroups={}}ngOnInit(){this.formGroup=this.formControlService.toFromGroup(this.fields),this.fields.forEach(C=>{this.fieldOptionGroups[C.name]||(this.fieldOptionGroups[C.name]=[]),C.options?.forEach(L=>{let W=this.fieldOptionGroups[C.name].find(J=>J.name===L.group);W||(W={name:L.group,options:[]},this.fieldOptionGroups[C.name].push(W)),W.options.push(L)})}),console.log(this.fieldOptionGroups),this.init.emit(this.formGroup)}changeValue(C,k){const L=this.formGroup.get(C.name);C.value=L.value,this.fieldValueChange.emit({fieldName:C.name,fieldValue:C.value,formGroup:this.formGroup,event:k})}getOptionGroups(C){const k=[];return C.forEach(L=>{let W=k.find(J=>J.group===L.group);W||(W={name:L.group,items:[]},k.push(W)),W.items.push(L)}),k}writeValue(C){console.log(C)}registerOnChange(C){throw new Error("Method not implemented.")}registerOnTouched(C){throw new Error("Method not implemented.")}setDisabledState(C){throw new Error("Method not implemented.")}static{this.\u0275fac=function(k){return new(k||E)(e.rXU(e.gRc),e.rXU(N))}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["el-form"]],inputs:{fields:"fields",formGroup:"formGroup"},outputs:{fieldValueChange:"fieldValueChange",init:"init"},features:[e.Jv_([{provide:_.kq,useExisting:(0,e.Rfq)(()=>E),multi:!0},N])],decls:2,vars:2,consts:[[3,"formGroup"],[3,"class","ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"label"],["class","required",4,"ngIf"],[4,"ngIf"],["class","hint",4,"ngIf"],[1,"required"],[3,"id","name","formControlName","change",4,"ngIf"],[3,"change","id","name","formControlName"],["value","",4,"ngIf"],["value",""],[3,"label",4,"ngFor","ngForOf"],[3,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"hint"]],template:function(k,L){1&k&&(e.j41(0,"div",0),e.DNE(1,he,9,15,"div",1),e.k0s()),2&k&&(e.Y8G("formGroup",L.formGroup),e.R7$(),e.Y8G("ngForOf",L.fields))},dependencies:[Z.YU,Z.Sq,Z.bT,_.xH,_.y7,_.me,_.wz,_.BC,_.cb,_.j4,_.JD,Z.GH],styles:["[_nghost-%COMP%]{display:block;width:100%}.field-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:1rem}.field-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .field-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .field-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border:solid #aaa 1px;border-radius:4px;min-height:1.5rem;padding:.25rem .75rem}.field-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:3rem}.field-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{height:2rem}.field-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:.25rem}.field-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:red}.field-item[_ngcontent-%COMP%]   .hint[_ngcontent-%COMP%]{font-style:italic;margin-top:.25rem}.field-item.invalid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .field-item.invalid[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .field-item.invalid[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{border-color:red}"],changeDetection:0})}}return E})();var be=K(6195);let de=(()=>{class E{show(){console.log(this.fields)}formInit(C){this.formStatus=C.status}formValueChange(C){this.formStatus=C.formGroup.status,console.log(C)}constructor(){this.fields=[{name:"yourName",label:"Your Name",value:"Bing",required:!0,requiredMessage:"Your name is required.",placeholder:"Your full name",style:"font-size: 1.25rem; height: 2rem",labelStyle:"font-weight: bold;"},{name:"yourCompany",label:"Your Company",value:"BNDY-NET",disabled:!0},{name:"yourCountry",label:"Your Country",options:[{label:"China",value:"cn",group:"ASIA"},{label:"United State",value:"us",group:"EMEA"}]},{name:"yourcountry1",label:"Has Placeholder",placeholder:"select one",options:[{label:"China",value:"cn",group:"ASIA"},{label:"United State",value:"us",group:"EMEA"}]},{name:"des",label:"Your Description",isMultiline:!0}]}ngOnInit(){}static{this.\u0275fac=function(k){return new(k||E)}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["app-example-form"]],decls:12,vars:5,consts:[["cols","2","rowHeight","480px"],[2,"width","100%","height","100%","padding-right","100px"],[3,"init","fieldValueChange","fields"],["mat-raised-button","",3,"click"],[2,"width","100%","height","calc(100% - 20px)","margin-top","10px","overflow","auto"]],template:function(k,L){1&k&&(e.j41(0,"mat-grid-list",0)(1,"mat-grid-tile")(2,"div",1)(3,"el-form",2),e.bIt("init",function(J){return L.formInit(J)})("fieldValueChange",function(J){return L.formValueChange(J)}),e.k0s(),e.j41(4,"button",3),e.bIt("click",function(){return L.show()}),e.EFF(5,"Print to console"),e.k0s(),e.EFF(6),e.k0s()(),e.j41(7,"mat-grid-tile")(8,"div",4)(9,"pre"),e.EFF(10),e.nI1(11,"json"),e.k0s()()()()),2&k&&(e.R7$(3),e.Y8G("fields",L.fields),e.R7$(3),e.SpI(" \xa0\xa0 Form Status: ",L.formStatus," "),e.R7$(4),e.JRh(e.bMT(11,3,L.fields)))},dependencies:[ve,p.$z,be.B_,be.NS,Z.TG],styles:[".mat-grid-tile-content[_ngcontent-%COMP%]{align-items:flex-start!important}"],changeDetection:0})}}return E})();var ce=function(E){return E.Row="row",E.Column="column",E.Free="free",E}(ce||{});const ue=(E,A)=>({$implicit:E,index:A});function Se(E,A){1&E&&e.eu8(0)}function te(E,A){if(1&E&&(e.j41(0,"div",2),e.DNE(1,Se,1,0,"ng-container",3),e.k0s()),2&E){const C=A.$implicit,k=A.index,L=e.XpG();e.Y8G("ngStyle",L.getItemStyle(C)),e.R7$(),e.Y8G("ngTemplateOutlet",L.itemTemplate)("ngTemplateOutletContext",e.l_i(3,ue,C,k))}}let De=(()=>{class E{constructor(){this.mode=ce.Row,this.items=[],this.itemSorted=new e.bkB,this.sortDirection="horizontal",this.styleMap={},this.itemGlobalStyleMap={}}ngOnInit(){}ngOnChanges(C){C.mode&&C.mode.currentValue!==C.mode.previousValue&&this.changeLayout(C.mode.currentValue),C.gutter&&(this.halfOfGutter=this.halfOf(this.gutter),this.changeLayout(this.mode))}drop(C){(0,ee.HD)(this.items,C.previousIndex,C.currentIndex),this.itemSorted.emit(this.items)}changeLayout(C){switch(this.sortDirection=C===ce.Column?"vertical":"horizontal",this.mode){case ce.Row:this.styleMap["margin-top"]="0",this.styleMap["margin-right"]="-"+this.halfOfGutter,this.styleMap["margin-bottom"]="0",this.styleMap["margin-left"]="-"+this.halfOfGutter,this.itemGlobalStyleMap["margin-top"]="0",this.itemGlobalStyleMap["margin-right"]=this.halfOfGutter,this.itemGlobalStyleMap["margin-bottom"]="0",this.itemGlobalStyleMap["margin-left"]=this.halfOfGutter;break;case ce.Column:this.styleMap["margin-top"]="-"+this.halfOfGutter,this.styleMap["margin-right"]="0",this.styleMap["margin-bottom"]="-"+this.halfOfGutter,this.styleMap["margin-left"]="0",this.itemGlobalStyleMap["margin-top"]=this.halfOfGutter,this.itemGlobalStyleMap["margin-right"]="0",this.itemGlobalStyleMap["margin-bottom"]=this.halfOfGutter,this.itemGlobalStyleMap["margin-left"]="0"}}getItemStyle(C){const k={};if(this.mode===ce.Row){const L=C.__width||C._width||C.width;L&&("number"==typeof L?k.flex=L.toString():k.width=L)}return{...this.itemGlobalStyleMap,...k}}halfOf(C){return C?"number"==typeof C?C/2+"rem":`${parseInt(C.replace(/(px)(pt)(rem)(em)(%)/g,""))/2}${C.replace(/\d+/gi,"")}`:""}static{this.\u0275fac=function(k){return new(k||E)}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["el-layout"]],hostVars:2,hostBindings:function(k,L){2&k&&e.HbH(L.mode)},inputs:{mode:"mode",items:"items",gutter:"gutter",itemTemplate:"itemTemplate",dragEnabled:"dragEnabled"},outputs:{itemSorted:"itemSorted"},features:[e.OA$],decls:2,vars:7,consts:[["cdkDropList","",1,"el-layout-container",3,"cdkDropListDropped","ngStyle","cdkDropListDisabled","cdkDropListOrientation"],["cdkDrag","","class","el-layout-item",3,"ngStyle",4,"ngFor","ngForOf"],["cdkDrag","",1,"el-layout-item",3,"ngStyle"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(k,L){1&k&&(e.j41(0,"div",0),e.bIt("cdkDropListDropped",function(J){return L.drop(J)}),e.DNE(1,te,2,6,"div",1),e.k0s()),2&k&&(e.HbH("layout-"+L.mode),e.Y8G("ngStyle",L.styleMap)("cdkDropListDisabled",!L.dragEnabled)("cdkDropListOrientation",L.sortDirection),e.R7$(),e.Y8G("ngForOf",L.items))},dependencies:[Z.Sq,Z.T3,Z.B3,ee.O7,ee.T1],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   .el-layout-container.layout-row[_ngcontent-%COMP%]{display:flex}[_nghost-%COMP%]   .el-layout-container.layout-column[_ngcontent-%COMP%]{display:flex;flex-direction:column}  .cdk-drag-placeholder{background-color:#dedede;border:dotted 3px #ddd;opacity:0;transition:transform .25s cubic-bezier(0,0,.2,1)}  .cdk-drag-animating{transition:transform .25s cubic-bezier(0,0,.2,1)}  .el-layout-item.cdk-drag-preview>*{border-radius:0;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f;box-sizing:border-box}  .el-layout-item.cdk-drop-list-dragging *:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]})}}return E})();function Fe(E,A){if(1&E&&(e.j41(0,"div",7),e.EFF(1),e.k0s()),2&E){const C=e.XpG(),k=C.$implicit,L=C.index;e.R7$(),e.Lme(" ",k.data.text," #",L," ")}}function He(E,A){if(1&E){const C=e.RV6();e.j41(0,"el-layout",4),e.bIt("itemSorted",function(L){e.eBV(C);const W=e.XpG(2);return e.Njj(W.sort(L))}),e.k0s()}if(2&E){const C=e.XpG().$implicit,k=e.XpG(),L=e.sdS(13);e.Y8G("mode",C.mode)("gutter",C.gutter)("items",C.items)("dragEnabled",k.draggable)("itemTemplate",L)}}function Ne(E,A){if(1&E&&e.DNE(0,Fe,2,2,"div",5)(1,He,1,5,"el-layout",6),2&E){const C=A.$implicit;e.Y8G("ngIf",C.data),e.R7$(),e.Y8G("ngIf",C.isLayout)}}let We=(()=>{class E{constructor(){this.draggable=!0,this.layoutData={mode:ce.Row,gutter:"1rem",items:[{id:1,width:1,data:{text:"#1 This defines the default behavior for how flex items..."}},{id:2,width:2,data:{text:"#2 This defines the default behavior for how flex items..."}},{id:3,width:2,data:{text:"#3 This defines the default behavior for how flex items..."}},{id:4,width:"100px",data:{text:"#4  100px This defines the default behavior for how flex items..."}},{id:5,width:2,isLayout:!0,mode:ce.Row,items:[{id:51,width:1,data:{text:"#51 Text"}},{id:52,width:2,data:{text:"#52 Text"}},{id:53,width:1,data:{text:"#53 Text"}}]}]}}ngOnInit(){}changeLayout(C){this.layoutData.mode=C,console.log("\u{1f680} ~ file: layout.component.ts ~ line 67 ~ LayoutComponent ~ changeLayout ~ mode",this.layoutData)}sort(C){console.log(C)}static{this.\u0275fac=function(k){return new(k||E)}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["app-examples-layout"]],decls:14,vars:7,consts:[["layoutItemTemplate",""],["mat-raised-button","",3,"click"],["mat-raised-button","",3,"click","disabled"],[1,"layout-container"],[3,"itemSorted","mode","gutter","items","dragEnabled","itemTemplate"],["class","block block-1",4,"ngIf"],[3,"mode","gutter","items","dragEnabled","itemTemplate","itemSorted",4,"ngIf"],[1,"block","block-1"]],template:function(k,L){if(1&k){const W=e.RV6();e.j41(0,"button",1),e.bIt("click",function(){return e.eBV(W),e.Njj(L.changeLayout("column"))}),e.EFF(1," Column Layout\n"),e.k0s(),e.j41(2,"button",1),e.bIt("click",function(){return e.eBV(W),e.Njj(L.changeLayout("row"))}),e.EFF(3,"Row Layout"),e.k0s(),e.j41(4,"button",2),e.bIt("click",function(){return e.eBV(W),e.Njj(L.draggable=!0)}),e.EFF(5," Enable Sorting\n"),e.k0s(),e.j41(6,"button",2),e.bIt("click",function(){return e.eBV(W),e.Njj(L.draggable=!1)}),e.EFF(7," Disable Sorting\n"),e.k0s(),e.nrm(8,"br")(9,"br"),e.j41(10,"div",3)(11,"el-layout",4),e.bIt("itemSorted",function(pe){return e.eBV(W),e.Njj(L.sort(pe))}),e.k0s()(),e.DNE(12,Ne,2,2,"ng-template",null,0,e.C5r)}if(2&k){const W=e.sdS(13);e.R7$(4),e.Y8G("disabled",L.draggable),e.R7$(2),e.Y8G("disabled",!L.draggable),e.R7$(5),e.Y8G("mode",L.layoutData.mode)("gutter",L.layoutData.gutter)("items",L.layoutData.items)("dragEnabled",L.draggable)("itemTemplate",W)}},dependencies:[Z.bT,p.$z,De],styles:["button[_ngcontent-%COMP%]{margin-right:.5rem}el-layout[_ngcontent-%COMP%]{border:dotted}.block[_ngcontent-%COMP%]{background-color:#efefef;border:solid 1px #ddd;padding:.5rem}"]})}}return E})();var Be=K(6354);let $e=(()=>{class E{constructor(C){this.route=C,this.hero={}}ngOnInit(){this.route.paramMap.pipe((0,Be.T)(C=>{this.hero.id=+C.get("id")})).subscribe()}static{this.\u0275fac=function(k){return new(k||E)(e.rXU(l.nX))}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["app-examples-table-detail"]],decls:3,vars:1,template:function(k,L){1&k&&(e.j41(0,"mat-card")(1,"h1"),e.EFF(2),e.k0s()()),2&k&&(e.R7$(2),e.SpI(" # ",L.hero.id,""))},dependencies:[Y.RN],styles:["[_nghost-%COMP%]{display:block}"]})}}return E})();var je=K(1986),Ue=K(3099),Ge=K(6024),ze=K(9183);function Ve(E,A){if(1&E&&(e.j41(0,"h1"),e.EFF(1),e.k0s()),2&E){const C=e.XpG(2);e.R7$(),e.JRh(C.title)}}function Ke(E,A){if(1&E&&(e.j41(0,"div",5),e.EFF(1),e.k0s()),2&E){const C=e.XpG(2);e.R7$(),e.JRh(C.description)}}function qe(E,A){if(1&E&&(e.j41(0,"div",1),e.nrm(1,"mat-spinner",2),e.DNE(2,Ve,2,1,"h1",3)(3,Ke,2,1,"div",4),e.k0s()),2&E){const C=e.XpG();e.R7$(2),e.Y8G("ngIf",C.title),e.R7$(),e.Y8G("ngIf",C.description)}}let Ye=(()=>{class E{constructor(){this.title="Loading..."}ngOnInit(){}static{this.\u0275fac=function(k){return new(k||E)}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["el-page-loading"]],inputs:{show:"show",title:"title",description:"description"},decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],["strokeWidth","5"],[4,"ngIf"],["class","secondary-text",4,"ngIf"],[1,"secondary-text"]],template:function(k,L){1&k&&e.DNE(0,qe,4,2,"div",0),2&k&&e.Y8G("ngIf",L.show)},dependencies:[Z.bT,ze.LG],styles:[".container[_ngcontent-%COMP%]{display:block;padding:5rem 0;text-align:center}.container[_ngcontent-%COMP%]   .mat-mdc-progress-spinner[_ngcontent-%COMP%]{display:inline-block;margin-bottom:1rem}"]})}}return E})();const Xe=["contentSidebar"],Je=E=>({loading:E}),Ze=()=>[5,10,25,100],Qe=E=>({active:E});function et(E,A){if(1&E){const C=e.RV6();e.j41(0,"tr",17)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"a",18),e.EFF(7,"open in current page"),e.k0s()(),e.j41(8,"td",19)(9,"button",20),e.bIt("click",function(){const L=e.eBV(C).$implicit,W=e.XpG(2);return e.Njj(W.gotoDetail(L.id))}),e.j41(10,"mat-icon"),e.EFF(11,"edit"),e.k0s()(),e.j41(12,"button",21),e.bIt("click",function(){const L=e.eBV(C).$implicit,W=e.XpG(2);return e.Njj(W.remove(L.id))}),e.j41(13,"mat-icon"),e.EFF(14,"delete"),e.k0s()()()()}if(2&E){const C=A.$implicit,k=e.XpG(2);e.Y8G("ngClass",e.eq3(4,Qe,k.currentHero&&C.id===k.currentHero.id)),e.R7$(2),e.JRh(C.id),e.R7$(2),e.JRh(C.name),e.R7$(2),e.Y8G("routerLink",C.id)}}function tt(E,A){if(1&E){const C=e.RV6();e.j41(0,"div",10)(1,"div",11)(2,"table",12)(3,"thead")(4,"tr")(5,"th"),e.EFF(6,"ID"),e.k0s(),e.j41(7,"th"),e.EFF(8,"Name"),e.k0s(),e.nrm(9,"th")(10,"th"),e.k0s()(),e.j41(11,"tbody"),e.DNE(12,et,15,6,"tr",13),e.k0s(),e.j41(13,"tfoot")(14,"tr")(15,"td",14)(16,"mat-paginator",15),e.bIt("page",function(L){e.eBV(C);const W=e.XpG();return e.Njj(W.getHeroes(L))}),e.k0s()()()()()(),e.j41(17,"div",16),e.nrm(18,"router-outlet"),e.k0s()()}if(2&E){const C=e.XpG();e.R7$(),e.Y8G("vLoading",C.loading),e.R7$(11),e.Y8G("ngForOf",C.heroes),e.R7$(4),e.Y8G("length",100)("pageSize",10)("pageSizeOptions",e.lJ4(5,Ze))}}function it(E,A){if(1&E){const C=e.RV6();e.j41(0,"form",22)(1,"mat-form-field")(2,"input",23),e.mxI("ngModelChange",function(L){e.eBV(C);const W=e.XpG();return e.DH7(W.currentHero.name,L)||(W.currentHero.name=L),e.Njj(L)}),e.k0s()()()}if(2&E){const C=e.XpG();e.R7$(2),e.R50("ngModel",C.currentHero.name)}}let rt=(()=>{class E{constructor(C,k,L){this.http=C,this.app=k,this.notification=L,this.heroes=[],this.saving=!1,this.loading=!1,this.initializing=!1}ngOnInit(){this.getHeroes(null)}getHeroes(C){C?this.loading=!0:this.initializing=!0,this.http.get((0,U.Nv)(`/assets/heroes.json?p=${C?C.pageIndex:0}`)).pipe((0,je.c)(2e3)).subscribe(k=>{this.heroes=k,C?this.loading=!1:this.initializing=!1})}gotoDetail(C){this.currentHero=Object.assign({},this.heroes.find(k=>k.id===C))}save(){this.saving=!0,(0,U.yU)().subscribe(()=>{this.saving=!1;const C=this.heroes.findIndex(k=>k.id===this.currentHero.id);this.heroes[C]=Object.assign({},this.currentHero),this.currentHero=null,this.notification.success("Save Successfully.")})}remove(C){this.app.dialog.deleteConfirm(()=>{alert("ok")})}onClosedContentSidebar(){this.currentHero=null}static{this.\u0275fac=function(k){return new(k||E)(e.rXU(g.Qq),e.rXU(z.d),e.rXU(c.JE))}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["app-examples-table"]],viewQuery:function(k,L){if(1&k&&e.GBs(Xe,5),2&k){let W;e.mGM(W=e.lsd())&&(L.contentSidebarRef=W.first)}},decls:13,vars:10,consts:[["contentSidebar",""],[3,"show"],["class","row",4,"ngIf"],["elementsToOpen",".btn-edit",3,"closed","title","progressShown","open"],[1,"padding"],["style","height: 2000px;",4,"ngIf"],[1,"footer","row"],[1,"fill","text-block"],[1,"right"],["mat-raised-button","","color","primary",3,"click","ngClass","disabled"],[1,"row"],["vLoadingText","Fetching data...",1,"fill",3,"vLoading"],[1,"border-radius"],[3,"ngClass",4,"ngFor","ngForOf"],["colspan","5"],[3,"page","length","pageSize","pageSizeOptions"],[1,"margin-left"],[3,"ngClass"],[3,"routerLink"],[1,"no-padding"],["mat-icon-button","",1,"btn-edit",3,"click"],["mat-icon-button","",1,"btn-delete",3,"click"],[2,"height","2000px"],["matInput","","name","name","placeholder","Name",3,"ngModelChange","ngModel"]],template:function(k,L){if(1&k){const W=e.RV6();e.j41(0,"div"),e.nrm(1,"el-page-loading",1),e.DNE(2,tt,19,6,"div",2),e.j41(3,"el-content-sidebar",3,0),e.bIt("closed",function(){return e.eBV(W),e.Njj(L.onClosedContentSidebar())}),e.j41(5,"div",4),e.DNE(6,it,3,1,"form",5),e.k0s(),e.j41(7,"div",6)(8,"div",7),e.EFF(9," Here to place footer. "),e.k0s(),e.j41(10,"div",8)(11,"button",9),e.bIt("click",function(){return e.eBV(W),e.Njj(L.save())}),e.EFF(12,"Save"),e.k0s()()()()()}2&k&&(e.R7$(),e.Y8G("show",L.initializing),e.R7$(),e.Y8G("ngIf",!L.initializing),e.R7$(),e.Y8G("title","#"+(null==L.currentHero?null:L.currentHero.id)+" "+(null==L.currentHero?null:L.currentHero.name))("progressShown",L.saving)("open",L.currentHero),e.R7$(3),e.Y8G("ngIf",L.currentHero),e.R7$(5),e.Y8G("ngClass",e.eq3(8,Je,L.saving))("disabled",L.saving))},dependencies:[Z.YU,Z.Sq,Z.bT,l.n3,l.Wk,_.qT,_.me,_.BC,_.cb,_.vS,_.cV,p.$z,p.iY,m.An,S.fg,w.rl,Ue.iy,i,Ge.$,Ye]})}}return E})();var se=K(467),st=K(8389),nt=K(3205),ot=K(8829),at=K(8069),le=function(E){return E[E.Open=0]="Open",E[E.Close=1]="Close",E[E.Error=2]="Error",E[E.Message=3]="Message",E}(le||{});class Me{constructor(){this.events={}}on(A,C){"object"!=typeof this.events[A]&&(this.events[A]=[]),this.events[A].push(C)}emit(A,C){if(!this.events.hasOwnProperty(A))return;const k=this.events[A];for(let L=0;L<k.length;L++)k[L].call(this,C)}}class ct extends Me{constructor(A){super(),this.promiseFn=A,this.connected=!0}sendCommand(A){return this.promiseFn(A).then(C=>(this.emit(le.Message,C),C),C=>{this.emit(le.Error,C)})}dispose(){}}class ht extends Me{constructor(A){super(),this.url=A,this.connected=!1,this.connectServer()}sendCommand(A){return this.connected||this.connectServer(),new Promise(C=>setTimeout(()=>{this.connected&&(this.socket.send(A),C(""))},100))}dispose(){this.socket.close()}connectServer(){this.socket=new WebSocket(this.url),this.socket.onopen=()=>{this.connected=!0,console.log("opened"),this.emit(le.Open,this.connected)},this.socket.onclose=()=>{console.log("onclose"),console.log(arguments),this.connected=!1,this.emit(le.Close,!this.connected)},this.socket.onerror=A=>{console.log("onerror"),console.log(A);let C=A;this.connected||(C="Not connected."),this.emit(le.Error,C)},this.socket.onmessage=A=>{console.log("onmessage"),console.log(A),this.emit(le.Message,A)}}}var Re=function(E){return E.Black="\x1b[30m",E.Red="\x1b[31m",E.Green="\x1b[32m",E.Yellow="\x1b[33m",E.Blue="\x1b[34m",E.Magenta="\x1b[35m",E.Cyan="\x1b[36m",E.White="\x1b[37m",E.Reset="\x1b[0m",E}(Re||{});function Ae(E,A){return`${A}${E}${Re.Reset}`}const dt={commandPrefix:"$ ",allowProposedApi:!0,serverDisconnectedMessage:"Server not connected, try later...",welcomeMessage:`Welcome to use this terminal, type ${function lt(E){return`\x1b[1m${E}\x1b[22m`}(Ae("help",Re.Yellow))} for more options...`,notConnectedMessage:"Not connected yet, try later",goodbyeMessage:"Bye bye...",cursorBlink:!0,cursorStyle:"block",fontSize:16,fontFamily:'"Source Code Pro", "Courier New", "Courier"',lineHeight:1.2,theme:{background:"black"}};class ut{constructor(A,C,k){this.options=dt,this.typingBlocked=!1,this.currentLine="",this.commandsBuffer={commands:[],pointer:-1},this.options={...this.options,...k},this.connection="string"==typeof C?new ht(C):new ct(C),this.terminal=new at.Terminal(this.options),window.terminal=this.terminal,this.fitAddon=new st.FitAddon,this.terminal.loadAddon(this.fitAddon),this.terminal.loadAddon(new ot.WebLinksAddon),this.terminal.loadAddon(new nt.Unicode11Addon),this.terminal.unicode.activeVersion="11",this.terminal.open(A),setTimeout(()=>{this.fitAddon.fit(),window.onresize=()=>this.fitAddon.fit()}),this.initTerminal().then(()=>{this.initListeners()}),this.initPrintableKeyListener(),this.initControlKeyListeners()}dispose(){this.connection.dispose(),this.terminal.dispose()}clear(){var A=this;return(0,se.A)(function*(){yield A.newLine(),yield A.printLineIntro(),A.terminal.clear(),A.terminal.focus()})()}commandReset(){var A=this;return(0,se.A)(function*(){A.terminal.reset(),A.terminal.focus(),A.typingBlocked=!0,yield A.printFancyText(A.options.welcomeMessage,!0),yield A.printLineIntro()})()}initTerminal(){var A=this;return(0,se.A)(function*(){yield A.commandReset()})()}initPrintableKeyListener(){var A=this;this.terminal.onData(function(){var C=(0,se.A)(function*(k){if(A.typingBlocked)return!1;k.length>0&&k.charCodeAt(0)>=32&&k.charCodeAt(0)<127&&(console.log(k.charCodeAt(0)),yield A.write(k),A.currentLine+=k)});return function(k){return C.apply(this,arguments)}}())}initControlKeyListeners(){var A=this;this.terminal.onKey(function(){var C=(0,se.A)(function*({key:k,domEvent:L}){if(A.typingBlocked)return!1;const W=L.key,J=k.charCodeAt(0);W.startsWith("Arrow")?"ArrowUp"===W?yield A.browseHistory(!0):"ArrowDown"===W&&(yield A.browseHistory(!1)):L.ctrlKey&&"c"===L.key?yield A.printLineIntro():13===J?yield A.processCurrentLine():127===J&&A.backspace()});return function(k){return C.apply(this,arguments)}}())}initListeners(){var A=this;this.connection.on(le.Open,function(){var C=(0,se.A)(function*(k){console.debug("Connection:Open"),k||(yield A.printText(A.options.notConnectedMessage,!0),yield A.printLineIntro())});return function(k){return C.apply(this,arguments)}}()),this.connection.on(le.Close,function(){var C=(0,se.A)(function*(k){console.debug("Connection:Close")});return function(k){return C.apply(this,arguments)}}()),this.connection.on(le.Error,function(){var C=(0,se.A)(function*(k){console.debug("Connection:Error"),console.debug(k),yield A.printText(Ae("string"!=typeof k?JSON.stringify(k):k,Re.Red),!0),yield A.printLineIntro()});return function(k){return C.apply(this,arguments)}}()),this.connection.on(le.Message,function(){var C=(0,se.A)(function*(k){let L;console.debug("Connection:Message"),L=k.data?k.data:k.filedata?`Download as ${k.filename}`:"string"!=typeof k?JSON.stringify(k):k,k.error&&(L=k.error),k.fancyTyping?yield A.printFancyText(L,L.split("\n").length>0):yield A.printText(L,!0),yield A.printLineIntro()});return function(k){return C.apply(this,arguments)}}())}browseHistory(A=!0){var C=this;return(0,se.A)(function*(){if(0===C.commandsBuffer.commands.length)return;-1===C.commandsBuffer.pointer?C.commandsBuffer.pointer=C.commandsBuffer.commands.length-1:A&&C.commandsBuffer.pointer>0?C.commandsBuffer.pointer--:!A&&C.commandsBuffer.pointer<C.commandsBuffer.commands.length-1&&C.commandsBuffer.pointer++;const k=C.commandsBuffer.commands[C.commandsBuffer.pointer];for(;C.currentLine.length>0;)yield C.backspace();C.currentLine=k,yield C.write(k)})()}write(A){var C=this;return(0,se.A)(function*(){return new Promise((k,L)=>{C.terminal.write(A,()=>k(A))})})()}writeln(A){var C=this;return(0,se.A)(function*(){return new Promise((k,L)=>{C.terminal.writeln(A,()=>k(A))})})()}printLineIntro(){var A=this;return(0,se.A)(function*(){A.currentLine="";const C=A.options.commandPrefix;yield A.printText(C,!1),A.terminal.focus()})()}printFancyText(A,C){var k=this;return(0,se.A)(function*(){k.typingBlocked=!0;const L=k;return new Promise(function(){var W=(0,se.A)(function*(J){let pe;const _e=A.split("\n");let Le=0,ye=0;function Ie(){return Te.apply(this,arguments)}function Te(){return(Te=(0,se.A)(function*(){const xe=_e[Le];if(xe.length>0&&ye<xe.length){const vt=xe[ye];yield L.write(vt),ye++}if(ye===xe.length&&1===_e.length?(C&&(yield L.write("\n\r")),Le++):ye===xe.length&&_e.length>1&&Le<_e.length&&(ye=0,Le++,yield L.write("\n\r")),!(Le<_e.length))return cancelAnimationFrame(pe),L.typingBlocked=!1,J(A);pe=requestAnimationFrame(Ie)})).apply(this,arguments)}return yield Ie()});return function(J){return W.apply(this,arguments)}}())})()}printText(A,C){var k=this;return(0,se.A)(function*(){if(k.typingBlocked=!0,C&&k.newLine(),A===k.options.commandPrefix)return yield k.write(A),void(k.typingBlocked=!1);A.split("\n").filter(W=>!!W.trim()).forEach((W,J)=>{k.writeln(W)}),C&&(yield k.newLine()),k.typingBlocked=!1})()}asyncCommand(A){var C=this;return(0,se.A)(function*(){return console.log("send cmd"),yield C.connection.sendCommand(A)})()}newLine(){var A=this;return(0,se.A)(function*(){yield A.writeln("")})()}processCurrentLine(){var A=this;return(0,se.A)(function*(){const C=A.currentLine.trim();if(""!==C&&(A.commandsBuffer.commands.push(C),A.commandsBuffer.pointer=-1),""===C)return yield A.newLine(),yield A.printLineIntro(),Promise.resolve();"clear"===C?yield A.clear():"reset"===C?yield A.commandReset():"history"===C?yield A.printHistory():yield A.asyncCommand(C)})()}printHistory(){var A=this;return(0,se.A)(function*(){yield A.newLine();const C=A.commandsBuffer.commands.reduce((k,L,W,J)=>(k+=W,k+="\t",k+=L.trim(),W<J.length-1&&(k+="\r\n"),k),"");yield A.printFancyText(C,1===C.split("\n").length),yield A.printLineIntro()})()}backspace(){this.currentLine.length>0&&(this.terminal.write("\b \b"),this.currentLine=this.currentLine.slice(0,-1))}}class _t{constructor(A,C){this.element=A,this.socketUrlOrAjaxFn=C,this.xterm=new ut(this.element,this.socketUrlOrAjaxFn)}dispose(){this.xterm.dispose()}}var Oe=K(5571);const ft=["terminalBox"],pt=[{path:"",component:H,children:[{path:"get-started",component:(()=>{class E{constructor(C){this.http=C}ngOnInit(){this.http.get("/assets/README.md",{responseType:"text"}).subscribe(C=>{const k=new showdown.Converter;this.readMe=k.makeHtml(C)})}static{this.\u0275fac=function(k){return new(k||E)(e.rXU(g.Qq))}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["app-get-started"]],decls:1,vars:1,consts:[[3,"innerHTML"]],template:function(k,L){1&k&&e.nrm(0,"div",0),2&k&&e.Y8G("innerHTML",L.readMe,e.npT)},styles:["[_nghost-%COMP%]     img{max-width:900px}"]})}}return E})()},{path:"examples/button",component:q},{path:"examples/card",component:P},{path:"examples/dynamic-form",component:de},{path:"examples/layout",component:We},{path:"examples/table",component:rt,children:[{path:":id",component:$e}]},{path:"examples/terminal",component:(()=>{class E{constructor(C){this.http=C,this.serverType="web-socket"}ngAfterViewInit(){this.initUI()}ngOnDestroy(){this.terminal?.dispose()}changeServer(C){this.serverType=C.value,this.initUI()}initUI(){let C;this.terminal&&this.terminal.dispose(),"web-socket"===this.serverType?C="ws://localhost:10000":"rest-api"===this.serverType&&(C=k=>this.http.get(`http://localhost:3000?cmd=${k}`).pipe((0,Be.T)(L=>L.text)).toPromise()),this.terminal=new _t(this.terminalDiv.nativeElement,C)}static{this.\u0275fac=function(k){return new(k||E)(e.rXU(g.Qq))}}static{this.\u0275cmp=e.VBU({type:E,selectors:[["app-examples-terminal"]],viewQuery:function(k,L){if(1&k&&e.GBs(ft,5),2&k){let W;e.mGM(W=e.lsd())&&(L.terminalDiv=W.first)}},decls:9,vars:1,consts:[["terminalBox",""],["id","terminalConntainer"],[2,"margin-top","2rem"],["name","server",3,"change","value"],["value","web-socket"],["value","rest-api"]],template:function(k,L){if(1&k){const W=e.RV6();e.j41(0,"div",1),e.nrm(1,"div",null,0),e.k0s(),e.j41(3,"div",2)(4,"mat-button-toggle-group",3),e.bIt("change",function(pe){return e.eBV(W),e.Njj(L.changeServer(pe))}),e.j41(5,"mat-button-toggle",4),e.EFF(6,"Web Socket"),e.k0s(),e.j41(7,"mat-button-toggle",5),e.EFF(8,"RESTful API"),e.k0s()()()}2&k&&(e.R7$(4),e.Y8G("value",L.serverType))},dependencies:[Oe.ec,Oe.pc],styles:['/**\n * Copyright (c) 2014 The xterm.js authors. All rights reserved.\n * Copyright (c) 2012-2013, Christopher Jeffrey (MIT License)\n * https://github.com/chjj/term.js\n * @license MIT\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the "Software"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n *\n * Originally forked from (with the author\'s permission):\n *   Fabrice Bellard\'s javascript vt100 for jslinux:\n *   http://bellard.org/jslinux/\n *   Copyright (c) 2011 Fabrice Bellard\n *   The original design remains. The terminal itself\n *   has been extended to include xterm CSI codes, among\n *   other features.\n */.xterm{cursor:text;position:relative;user-select:none;-ms-user-select:none;-webkit-user-select:none}.xterm.focus,.xterm:focus{outline:none}.xterm .xterm-helpers{position:absolute;top:0;z-index:5}.xterm .xterm-helper-textarea{padding:0;border:0;margin:0;position:absolute;opacity:0;left:-9999em;top:0;width:0;height:0;z-index:-5;white-space:nowrap;overflow:hidden;resize:none}.xterm .composition-view{background:#000;color:#fff;display:none;position:absolute;white-space:nowrap;z-index:1}.xterm .composition-view.active{display:block}.xterm .xterm-viewport{background-color:#000;overflow-y:scroll;cursor:default;position:absolute;inset:0}.xterm .xterm-screen{position:relative}.xterm .xterm-screen canvas{position:absolute;left:0;top:0}.xterm .xterm-scroll-area{visibility:hidden}.xterm-char-measure-element{display:inline-block;visibility:hidden;position:absolute;top:0;left:-9999em;line-height:normal}.xterm.enable-mouse-events{cursor:default}.xterm.xterm-cursor-pointer,.xterm .xterm-cursor-pointer{cursor:pointer}.xterm.column-select.focus{cursor:crosshair}.xterm .xterm-accessibility:not(.debug),.xterm .xterm-message{position:absolute;inset:0;z-index:10;color:transparent;pointer-events:none}.xterm .xterm-accessibility-tree:not(.debug) *::selection{color:transparent}.xterm .xterm-accessibility-tree{-webkit-user-select:text;user-select:text;white-space:pre}.xterm .live-region{position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden}.xterm-dim{opacity:1!important}.xterm-underline-1{text-decoration:underline}.xterm-underline-2{-webkit-text-decoration:double underline;text-decoration:double underline}.xterm-underline-3{-webkit-text-decoration:wavy underline;text-decoration:wavy underline}.xterm-underline-4{-webkit-text-decoration:dotted underline;text-decoration:dotted underline}.xterm-underline-5{-webkit-text-decoration:dashed underline;text-decoration:dashed underline}.xterm-overline{text-decoration:overline}.xterm-overline.xterm-underline-1{text-decoration:overline underline}.xterm-overline.xterm-underline-2{-webkit-text-decoration:overline double underline;text-decoration:overline double underline}.xterm-overline.xterm-underline-3{-webkit-text-decoration:overline wavy underline;text-decoration:overline wavy underline}.xterm-overline.xterm-underline-4{-webkit-text-decoration:overline dotted underline;text-decoration:overline dotted underline}.xterm-overline.xterm-underline-5{-webkit-text-decoration:overline dashed underline;text-decoration:overline dashed underline}.xterm-strikethrough{text-decoration:line-through}.xterm-screen .xterm-decoration-container .xterm-decoration{z-index:6;position:absolute}.xterm-screen .xterm-decoration-container .xterm-decoration.xterm-decoration-top-layer{z-index:7}.xterm-decoration-overview-ruler{z-index:8;position:absolute;top:0;right:0;pointer-events:none}.xterm-decoration-top{z-index:2;position:relative}#terminalConntainer{margin:-1rem -2rem}.xterm{padding:.5rem;font-family:Source Code Pro,Courier New,Courier}.xterm .xterm-cursor{height:18px!important;transform:translateY(2px)}\n'],encapsulation:2})}}return E})()}]}];let gt=(()=>{class E{static{this.\u0275fac=function(k){return new(k||E)}}static{this.\u0275mod=e.$C({type:E})}static{this.\u0275inj=e.G2t({imports:[l.iI.forChild(pt),l.iI]})}}return E})(),mt=(()=>{class E{static{this.\u0275fac=function(k){return new(k||E)}}static{this.\u0275mod=e.$C({type:E})}static{this.\u0275inj=e.G2t({imports:[Z.MD,ee.ad,gt,n.t,I.g,a.Gg]})}}return E})()},8389:fe=>{self,fe.exports=(()=>{"use strict";var K,oe={};return K=oe,Object.defineProperty(K,"__esModule",{value:!0}),K.FitAddon=void 0,K.FitAddon=class{activate(ee){this._terminal=ee}dispose(){}fit(){const ee=this.proposeDimensions();ee&&this._terminal&&!isNaN(ee.cols)&&!isNaN(ee.rows)&&(this._terminal.rows===ee.rows&&this._terminal.cols===ee.cols||(this._terminal._core._renderService.clear(),this._terminal.resize(ee.cols,ee.rows)))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const ee=this._terminal._core,Z=ee._renderService.dimensions;if(0===Z.css.cell.width||0===Z.css.cell.height)return;const I=0===this._terminal.options.scrollback?0:ee.viewport.scrollBarWidth,n=window.getComputedStyle(this._terminal.element.parentElement),a=parseInt(n.getPropertyValue("height")),l=Math.max(0,parseInt(n.getPropertyValue("width"))),f=window.getComputedStyle(this._terminal.element),o=a-(parseInt(f.getPropertyValue("padding-top"))+parseInt(f.getPropertyValue("padding-bottom"))),d=l-(parseInt(f.getPropertyValue("padding-right"))+parseInt(f.getPropertyValue("padding-left")))-I;return{cols:Math.max(2,Math.floor(d/Z.css.cell.width)),rows:Math.max(1,Math.floor(o/Z.css.cell.height))}}},oe})()},3205:function(fe){fe.exports=(()=>{"use strict";var oe={433:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeV11=void 0;const l=a(938),f=[[768,879],[1155,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1541],[1552,1562],[1564,1564],[1611,1631],[1648,1648],[1750,1757],[1759,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2045,2045],[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2259,2306],[2362,2362],[2364,2364],[2369,2376],[2381,2381],[2385,2391],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2558,2558],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2641,2641],[2672,2673],[2677,2677],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2810,2815],[2817,2817],[2876,2876],[2879,2879],[2881,2884],[2893,2893],[2902,2902],[2914,2915],[2946,2946],[3008,3008],[3021,3021],[3072,3072],[3076,3076],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],[3201,3201],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],[3405,3405],[3426,3427],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],[4226,4226],[4229,4230],[4237,4237],[4253,4253],[4448,4607],[4957,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6158],[6277,6278],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6683,6683],[6742,6742],[6744,6750],[6752,6752],[6754,6754],[6757,6764],[6771,6780],[6783,6783],[6832,6846],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],[7142,7142],[7144,7145],[7149,7149],[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],[7405,7405],[7412,7412],[7416,7417],[7616,7673],[7675,7679],[8203,8207],[8234,8238],[8288,8292],[8294,8303],[8400,8432],[11503,11505],[11647,11647],[11744,11775],[12330,12333],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],[43010,43010],[43014,43014],[43019,43019],[43045,43046],[43204,43205],[43232,43249],[43263,43263],[43302,43309],[43335,43345],[43392,43394],[43443,43443],[43446,43449],[43452,43453],[43493,43493],[43561,43566],[43569,43570],[43573,43574],[43587,43587],[43596,43596],[43644,43644],[43696,43696],[43698,43700],[43703,43704],[43710,43711],[43713,43713],[43756,43757],[43766,43766],[44005,44005],[44008,44008],[44013,44013],[64286,64286],[65024,65039],[65056,65071],[65279,65279],[65529,65531]],o=[[66045,66045],[66272,66272],[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[68325,68326],[68900,68903],[69446,69456],[69633,69633],[69688,69702],[69759,69761],[69811,69814],[69817,69818],[69821,69821],[69837,69837],[69888,69890],[69927,69931],[69933,69940],[70003,70003],[70016,70017],[70070,70078],[70089,70092],[70191,70193],[70196,70196],[70198,70199],[70206,70206],[70367,70367],[70371,70378],[70400,70401],[70459,70460],[70464,70464],[70502,70508],[70512,70516],[70712,70719],[70722,70724],[70726,70726],[70750,70750],[70835,70840],[70842,70842],[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],[71229,71229],[71231,71232],[71339,71339],[71341,71341],[71344,71349],[71351,71351],[71453,71455],[71458,71461],[71463,71467],[71727,71735],[71737,71738],[72148,72151],[72154,72155],[72160,72160],[72193,72202],[72243,72248],[72251,72254],[72263,72263],[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],[72767,72767],[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],[73018,73018],[73020,73021],[73023,73029],[73031,73031],[73104,73105],[73109,73109],[73111,73111],[73459,73460],[78896,78904],[92912,92916],[92976,92982],[94031,94031],[94095,94098],[113821,113822],[113824,113827],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],[121461,121461],[121476,121476],[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[123184,123190],[123628,123631],[125136,125142],[125252,125258],[917505,917505],[917536,917631],[917760,917999]],d=[[4352,4447],[8986,8987],[9001,9002],[9193,9196],[9200,9200],[9203,9203],[9725,9726],[9748,9749],[9800,9811],[9855,9855],[9875,9875],[9889,9889],[9898,9899],[9917,9918],[9924,9925],[9934,9934],[9940,9940],[9962,9962],[9970,9971],[9973,9973],[9978,9978],[9981,9981],[9989,9989],[9994,9995],[10024,10024],[10060,10060],[10062,10062],[10067,10069],[10071,10071],[10133,10135],[10160,10160],[10175,10175],[11035,11036],[11088,11088],[11093,11093],[11904,11929],[11931,12019],[12032,12245],[12272,12283],[12288,12329],[12334,12350],[12353,12438],[12443,12543],[12549,12591],[12593,12686],[12688,12730],[12736,12771],[12784,12830],[12832,12871],[12880,19903],[19968,42124],[42128,42182],[43360,43388],[44032,55203],[63744,64255],[65040,65049],[65072,65106],[65108,65126],[65128,65131],[65281,65376],[65504,65510]],e=[[94176,94179],[94208,100343],[100352,101106],[110592,110878],[110928,110930],[110948,110951],[110960,111355],[126980,126980],[127183,127183],[127374,127374],[127377,127386],[127488,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,127776],[127789,127797],[127799,127868],[127870,127891],[127904,127946],[127951,127955],[127968,127984],[127988,127988],[127992,128062],[128064,128064],[128066,128252],[128255,128317],[128331,128334],[128336,128359],[128378,128378],[128405,128406],[128420,128420],[128507,128591],[128640,128709],[128716,128716],[128720,128722],[128725,128725],[128747,128748],[128756,128762],[128992,129003],[129293,129393],[129395,129398],[129402,129442],[129445,129450],[129454,129482],[129485,129535],[129648,129651],[129656,129658],[129664,129666],[129680,129685],[131072,196605],[196608,262141]];let g;function h(i,s){let t,r=0,c=s.length-1;if(i<s[0][0]||i>s[c][1])return!1;for(;c>=r;)if(t=r+c>>1,i>s[t][1])r=t+1;else{if(!(i<s[t][0]))return!0;c=t-1}return!1}n.UnicodeV11=class{constructor(){if(this.version="11",!g){g=new Uint8Array(65536),g.fill(1),g[0]=0,g.fill(0,1,32),g.fill(0,127,160);for(let i=0;i<f.length;++i)g.fill(0,f[i][0],f[i][1]+1);for(let i=0;i<d.length;++i)g.fill(2,d[i][0],d[i][1]+1)}}wcwidth(i){return i<32?0:i<127?1:i<65536?g[i]:h(i,o)?0:h(i,e)?2:1}charProperties(i,s){let t=this.wcwidth(i),r=0===t&&0!==s;if(r){const c=l.UnicodeService.extractWidth(s);0===c?r=!1:c>t&&(t=c)}return l.UnicodeService.createPropertyValue(0,t,r)}}},345:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.runAndSubscribe=n.forwardEvent=n.EventEmitter=void 0,n.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=a=>(this._listeners.push(a),{dispose:()=>{if(!this._disposed)for(let l=0;l<this._listeners.length;l++)if(this._listeners[l]===a)return void this._listeners.splice(l,1)}})),this._event}fire(a,l){const f=[];for(let o=0;o<this._listeners.length;o++)f.push(this._listeners[o]);for(let o=0;o<f.length;o++)f[o].call(void 0,a,l)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},n.forwardEvent=function(a,l){return a(f=>l.fire(f))},n.runAndSubscribe=function(a,l){return l(void 0),a(f=>l(f))}},490:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeV6=void 0;const l=a(938),f=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],o=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let d;n.UnicodeV6=class{constructor(){if(this.version="6",!d){d=new Uint8Array(65536),d.fill(1),d[0]=0,d.fill(0,1,32),d.fill(0,127,160),d.fill(2,4352,4448),d[9001]=2,d[9002]=2,d.fill(2,11904,42192),d[12351]=1,d.fill(2,44032,55204),d.fill(2,63744,64256),d.fill(2,65040,65050),d.fill(2,65072,65136),d.fill(2,65280,65377),d.fill(2,65504,65511);for(let e=0;e<f.length;++e)d.fill(0,f[e][0],f[e][1]+1)}}wcwidth(e){return e<32?0:e<127?1:e<65536?d[e]:function(g,h){let i,s=0,t=h.length-1;if(g<h[0][0]||g>h[t][1])return!1;for(;t>=s;)if(i=s+t>>1,g>h[i][1])s=i+1;else{if(!(g<h[i][0]))return!0;t=i-1}return!1}(e,o)?0:e>=131072&&e<=196605||e>=196608&&e<=262141?2:1}charProperties(e,g){let h=this.wcwidth(e),i=0===h&&0!==g;if(i){const s=l.UnicodeService.extractWidth(g);0===s?i=!1:s>h&&(h=s)}return l.UnicodeService.createPropertyValue(0,h,i)}}},938:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeService=void 0;const l=a(345),f=a(490);class o{static extractShouldJoin(e){return!!(1&e)}static extractWidth(e){return e>>1&3}static extractCharKind(e){return e>>3}static createPropertyValue(e,g,h=!1){return(16777215&e)<<3|(3&g)<<1|(h?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new l.EventEmitter,this.onChange=this._onChange.event;const e=new f.UnicodeV6;this.register(e),this._active=e.version,this._activeProvider=e}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(e){if(!this._providers[e])throw new Error(`unknown Unicode version "${e}"`);this._active=e,this._activeProvider=this._providers[e],this._onChange.fire(e)}register(e){this._providers[e.version]=e}wcwidth(e){return this._activeProvider.wcwidth(e)}getStringCellWidth(e){let g=0,h=0;const i=e.length;for(let s=0;s<i;++s){let t=e.charCodeAt(s);if(55296<=t&&t<=56319){if(++s>=i)return g+this.wcwidth(t);const _=e.charCodeAt(s);56320<=_&&_<=57343?t=1024*(t-55296)+_-56320+65536:g+=this.wcwidth(_)}const r=this.charProperties(t,h);let c=o.extractWidth(r);o.extractShouldJoin(r)&&(c-=o.extractWidth(h)),g+=c,h=r}return g}charProperties(e,g){return this._activeProvider.charProperties(e,g)}}n.UnicodeService=o}},K={};function ee(I){var n=K[I];if(void 0!==n)return n.exports;var a=K[I]={exports:{}};return oe[I](a,a.exports,ee),a.exports}var Z={};return(()=>{var I=Z;Object.defineProperty(I,"__esModule",{value:!0}),I.Unicode11Addon=void 0;const n=ee(433);I.Unicode11Addon=class{activate(a){a.unicode.register(new n.UnicodeV11)}dispose(){}}})(),Z})()},8829:fe=>{self,fe.exports=(()=>{"use strict";var oe={6:(I,n)=>{function a(f){try{const o=new URL(f),d=o.password&&o.username?`${o.protocol}//${o.username}:${o.password}@${o.host}`:o.username?`${o.protocol}//${o.username}@${o.host}`:`${o.protocol}//${o.host}`;return f.toLocaleLowerCase().startsWith(d.toLocaleLowerCase())}catch{return!1}}Object.defineProperty(n,"__esModule",{value:!0}),n.LinkComputer=n.WebLinkProvider=void 0,n.WebLinkProvider=class{constructor(f,o,d,e={}){this._terminal=f,this._regex=o,this._handler=d,this._options=e}provideLinks(f,o){const d=l.computeLink(f,this._regex,this._terminal,this._handler);o(this._addCallbacks(d))}_addCallbacks(f){return f.map(o=>(o.leave=this._options.leave,o.hover=(d,e)=>{if(this._options.hover){const{range:g}=o;this._options.hover(d,e,g)}},o))}};class l{static computeLink(o,d,e,g){const h=new RegExp(d.source,(d.flags||"")+"g"),[i,s]=l._getWindowedLineStrings(o-1,e),t=i.join("");let r;const c=[];for(;r=h.exec(t);){const _=r[0];if(!a(_))continue;const[p,m]=l._mapStrIdx(e,s,0,r.index),[u,v]=l._mapStrIdx(e,p,m,_.length);-1!==p&&-1!==m&&-1!==u&&-1!==v&&c.push({range:{start:{x:m+1,y:p+1},end:{x:v,y:u+1}},text:_,activate:g})}return c}static _getWindowedLineStrings(o,d){let e,g=o,h=o,i=0,s="";const t=[];if(e=d.buffer.active.getLine(o)){const r=e.translateToString(!0);if(e.isWrapped&&" "!==r[0]){for(i=0;(e=d.buffer.active.getLine(--g))&&i<2048&&(s=e.translateToString(!0),i+=s.length,t.push(s),e.isWrapped&&-1===s.indexOf(" ")););t.reverse()}for(t.push(r),i=0;(e=d.buffer.active.getLine(++h))&&e.isWrapped&&i<2048&&(s=e.translateToString(!0),i+=s.length,t.push(s),-1===s.indexOf(" ")););}return[t,g]}static _mapStrIdx(o,d,e,g){const h=o.buffer.active,i=h.getNullCell();let s=e;for(;g;){const t=h.getLine(d);if(!t)return[-1,-1];for(let r=s;r<t.length;++r){t.getCell(r,i);const c=i.getChars();if(i.getWidth()&&(g-=c.length||1,r===t.length-1&&""===c)){const _=h.getLine(d+1);_&&_.isWrapped&&(_.getCell(0,i),2===i.getWidth()&&(g+=1))}if(g<0)return[d,r]}d++,s=0}return[d,s]}}n.LinkComputer=l}},K={};function ee(I){var n=K[I];if(void 0!==n)return n.exports;var a=K[I]={exports:{}};return oe[I](a,a.exports,ee),a.exports}var Z={};return(()=>{var I=Z;Object.defineProperty(I,"__esModule",{value:!0}),I.WebLinksAddon=void 0;const n=ee(6),a=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function l(f,o){const d=window.open();if(d){try{d.opener=null}catch{}d.location.href=o}else console.warn("Opening link blocked as opener could not be cleared")}I.WebLinksAddon=class{constructor(f=l,o={}){this._handler=f,this._options=o}activate(f){this._terminal=f;const o=this._options;this._linkProvider=this._terminal.registerLinkProvider(new n.WebLinkProvider(this._terminal,o.urlRegex||a,this._handler,o))}dispose(){this._linkProvider?.dispose()}}})(),Z})()},8069:fe=>{globalThis,fe.exports=(()=>{"use strict";var oe={4567:function(I,n,a){var l=this&&this.__decorate||function(t,r,c,_){var p,m=arguments.length,u=m<3?r:null===_?_=Object.getOwnPropertyDescriptor(r,c):_;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,c,_);else for(var v=t.length-1;v>=0;v--)(p=t[v])&&(u=(m<3?p(u):m>3?p(r,c,u):p(r,c))||u);return m>3&&u&&Object.defineProperty(r,c,u),u},f=this&&this.__param||function(t,r){return function(c,_){r(c,_,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.AccessibilityManager=void 0;const o=a(9042),d=a(9924),e=a(844),g=a(4725),h=a(2585),i=a(3656);let s=n.AccessibilityManager=class extends e.Disposable{constructor(t,r,c,_){super(),this._terminal=t,this._coreBrowserService=c,this._renderService=_,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let p=0;p<this._terminal.rows;p++)this._rowElements[p]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[p]);if(this._topBoundaryFocusListener=p=>this._handleBoundaryFocus(p,0),this._bottomBoundaryFocusListener=p=>this._handleBoundaryFocus(p,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new d.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(p=>this._handleResize(p.rows))),this.register(this._terminal.onRender(p=>this._refreshRows(p.start,p.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(p=>this._handleChar(p))),this.register(this._terminal.onLineFeed(()=>this._handleChar("\n"))),this.register(this._terminal.onA11yTab(p=>this._handleTab(p))),this.register(this._terminal.onKey(p=>this._handleKey(p.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,i.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,e.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(t){for(let r=0;r<t;r++)this._handleChar(" ")}_handleChar(t){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==t&&(this._charsToAnnounce+=t):this._charsToAnnounce+=t,"\n"===t&&(this._liveRegionLineCount++,21===this._liveRegionLineCount&&(this._liveRegion.textContent+=o.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(t){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(t)||this._charsToConsume.push(t)}_refreshRows(t,r){this._liveRegionDebouncer.refresh(t,r,this._terminal.rows)}_renderRows(t,r){const c=this._terminal.buffer,_=c.lines.length.toString();for(let p=t;p<=r;p++){const m=c.lines.get(c.ydisp+p),u=[],v=m?.translateToString(!0,void 0,void 0,u)||"",R=(c.ydisp+p+1).toString(),D=this._rowElements[p];D&&(0===v.length?(D.innerText="\xa0",this._rowColumns.set(D,[0,1])):(D.textContent=v,this._rowColumns.set(D,u)),D.setAttribute("aria-posinset",R),D.setAttribute("aria-setsize",_))}this._announceCharacters()}_announceCharacters(){0!==this._charsToAnnounce.length&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(t,r){const c=t.target,_=this._rowElements[0===r?1:this._rowElements.length-2];if(c.getAttribute("aria-posinset")===(0===r?"1":`${this._terminal.buffer.lines.length}`)||t.relatedTarget!==_)return;let p,m;if(0===r?(p=c,m=this._rowElements.pop(),this._rowContainer.removeChild(m)):(p=this._rowElements.shift(),m=c,this._rowContainer.removeChild(p)),p.removeEventListener("focus",this._topBoundaryFocusListener),m.removeEventListener("focus",this._bottomBoundaryFocusListener),0===r){const u=this._createAccessibilityTreeNode();this._rowElements.unshift(u),this._rowContainer.insertAdjacentElement("afterbegin",u)}else{const u=this._createAccessibilityTreeNode();this._rowElements.push(u),this._rowContainer.appendChild(u)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(0===r?-1:1),this._rowElements[0===r?1:this._rowElements.length-2].focus(),t.preventDefault(),t.stopImmediatePropagation()}_handleSelectionChange(){if(0===this._rowElements.length)return;const t=document.getSelection();if(!t)return;if(t.isCollapsed)return void(this._rowContainer.contains(t.anchorNode)&&this._terminal.clearSelection());if(!t.anchorNode||!t.focusNode)return void console.error("anchorNode and/or focusNode are null");let r={node:t.anchorNode,offset:t.anchorOffset},c={node:t.focusNode,offset:t.focusOffset};if((r.node.compareDocumentPosition(c.node)&Node.DOCUMENT_POSITION_PRECEDING||r.node===c.node&&r.offset>c.offset)&&([r,c]=[c,r]),r.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(r={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(r.node))return;const _=this._rowElements.slice(-1)[0];if(c.node.compareDocumentPosition(_)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(c={node:_,offset:_.textContent?.length??0}),!this._rowContainer.contains(c.node))return;const p=({node:v,offset:R})=>{const D=v instanceof Text?v.parentNode:v;let B=parseInt(D?.getAttribute("aria-posinset"),10)-1;if(isNaN(B))return console.warn("row is invalid. Race condition?"),null;const y=this._rowColumns.get(D);if(!y)return console.warn("columns is null. Race condition?"),null;let O=R<y.length?y[R]:y.slice(-1)[0]+1;return O>=this._terminal.cols&&(++B,O=0),{row:B,column:O}},m=p(r),u=p(c);if(m&&u){if(m.row>u.row||m.row===u.row&&m.column>=u.column)throw new Error("invalid range");this._terminal.select(m.column,m.row,(u.row-m.row)*this._terminal.cols-m.column+u.column)}}_handleResize(t){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let r=this._rowContainer.children.length;r<this._terminal.rows;r++)this._rowElements[r]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[r]);for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const t=this._coreBrowserService.mainDocument.createElement("div");return t.setAttribute("role","listitem"),t.tabIndex=-1,this._refreshRowDimensions(t),t}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let t=0;t<this._terminal.rows;t++)this._refreshRowDimensions(this._rowElements[t])}}_refreshRowDimensions(t){t.style.height=`${this._renderService.dimensions.css.cell.height}px`}};n.AccessibilityManager=s=l([f(1,h.IInstantiationService),f(2,g.ICoreBrowserService),f(3,g.IRenderService)],s)},3614:(I,n)=>{function a(d){return d.replace(/\r?\n/g,"\r")}function l(d,e){return e?"\x1b[200~"+d+"\x1b[201~":d}function f(d,e,g,h){d=l(d=a(d),g.decPrivateModes.bracketedPasteMode&&!0!==h.rawOptions.ignoreBracketedPasteMode),g.triggerDataEvent(d,!0),e.value=""}function o(d,e,g){const h=g.getBoundingClientRect(),i=d.clientX-h.left-10,s=d.clientY-h.top-10;e.style.width="20px",e.style.height="20px",e.style.left=`${i}px`,e.style.top=`${s}px`,e.style.zIndex="1000",e.focus()}Object.defineProperty(n,"__esModule",{value:!0}),n.rightClickHandler=n.moveTextAreaUnderMouseCursor=n.paste=n.handlePasteEvent=n.copyHandler=n.bracketTextForPaste=n.prepareTextForTerminal=void 0,n.prepareTextForTerminal=a,n.bracketTextForPaste=l,n.copyHandler=function(d,e){d.clipboardData&&d.clipboardData.setData("text/plain",e.selectionText),d.preventDefault()},n.handlePasteEvent=function(d,e,g,h){d.stopPropagation(),d.clipboardData&&f(d.clipboardData.getData("text/plain"),e,g,h)},n.paste=f,n.moveTextAreaUnderMouseCursor=o,n.rightClickHandler=function(d,e,g,h,i){o(d,e,g),i&&h.rightClickSelect(d),e.value=h.selectionText,e.select()}},7239:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorContrastCache=void 0;const l=a(1505);n.ColorContrastCache=class{constructor(){this._color=new l.TwoKeyMap,this._css=new l.TwoKeyMap}setCss(f,o,d){this._css.set(f,o,d)}getCss(f,o){return this._css.get(f,o)}setColor(f,o,d){this._color.set(f,o,d)}getColor(f,o){return this._color.get(f,o)}clear(){this._color.clear(),this._css.clear()}}},3656:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.addDisposableDomListener=void 0,n.addDisposableDomListener=function(a,l,f,o){a.addEventListener(l,f,o);let d=!1;return{dispose:()=>{d||(d=!0,a.removeEventListener(l,f,o))}}}},3551:function(I,n,a){var l=this&&this.__decorate||function(s,t,r,c){var _,p=arguments.length,m=p<3?t:null===c?c=Object.getOwnPropertyDescriptor(t,r):c;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(s,t,r,c);else for(var u=s.length-1;u>=0;u--)(_=s[u])&&(m=(p<3?_(m):p>3?_(t,r,m):_(t,r))||m);return p>3&&m&&Object.defineProperty(t,r,m),m},f=this&&this.__param||function(s,t){return function(r,c){t(r,c,s)}};Object.defineProperty(n,"__esModule",{value:!0}),n.Linkifier=void 0;const o=a(3656),d=a(8460),e=a(844),g=a(2585),h=a(4725);let i=n.Linkifier=class extends e.Disposable{get currentLink(){return this._currentLink}constructor(s,t,r,c,_){super(),this._element=s,this._mouseService=t,this._renderService=r,this._bufferService=c,this._linkProviderService=_,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new d.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new d.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,e.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,e.toDisposable)(()=>{this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,o.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,o.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,o.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,o.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(s){this._lastMouseEvent=s;const t=this._positionFromMouseEvent(s,this._element,this._mouseService);if(!t)return;this._isMouseOut=!1;const r=s.composedPath();for(let c=0;c<r.length;c++){const _=r[c];if(_.classList.contains("xterm"))break;if(_.classList.contains("xterm-hover"))return}this._lastBufferCell&&t.x===this._lastBufferCell.x&&t.y===this._lastBufferCell.y||(this._handleHover(t),this._lastBufferCell=t)}_handleHover(s){if(this._activeLine!==s.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(s,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,s)||(this._clearCurrentLink(),this._askForLink(s,!0))}_askForLink(s,t){this._activeProviderReplies&&t||(this._activeProviderReplies?.forEach(c=>{c?.forEach(_=>{_.link.dispose&&_.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=s.y);let r=!1;for(const[c,_]of this._linkProviderService.linkProviders.entries())t?this._activeProviderReplies?.get(c)&&(r=this._checkLinkProviderResult(c,s,r)):_.provideLinks(s.y,p=>{if(this._isMouseOut)return;const m=p?.map(u=>({link:u}));this._activeProviderReplies?.set(c,m),r=this._checkLinkProviderResult(c,s,r),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(s.y,this._activeProviderReplies)})}_removeIntersectingLinks(s,t){const r=new Set;for(let c=0;c<t.size;c++){const _=t.get(c);if(_)for(let p=0;p<_.length;p++){const m=_[p],v=m.link.range.end.y>s?this._bufferService.cols:m.link.range.end.x;for(let R=m.link.range.start.y<s?0:m.link.range.start.x;R<=v;R++){if(r.has(R)){_.splice(p--,1);break}r.add(R)}}}}_checkLinkProviderResult(s,t,r){if(!this._activeProviderReplies)return r;const c=this._activeProviderReplies.get(s);let _=!1;for(let p=0;p<s;p++)this._activeProviderReplies.has(p)&&!this._activeProviderReplies.get(p)||(_=!0);if(!_&&c){const p=c.find(m=>this._linkAtPosition(m.link,t));p&&(r=!0,this._handleNewLink(p))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!r)for(let p=0;p<this._activeProviderReplies.size;p++){const m=this._activeProviderReplies.get(p)?.find(u=>this._linkAtPosition(u.link,t));if(m){r=!0,this._handleNewLink(m);break}}return r}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(s){if(!this._currentLink)return;const t=this._positionFromMouseEvent(s,this._element,this._mouseService);t&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,t)&&this._currentLink.link.activate(s,this._currentLink.link.text)}_clearCurrentLink(s,t){this._currentLink&&this._lastMouseEvent&&(!s||!t||this._currentLink.link.range.start.y>=s&&this._currentLink.link.range.end.y<=t)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,e.disposeArray)(this._linkCacheDisposables))}_handleNewLink(s){if(!this._lastMouseEvent)return;const t=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);t&&this._linkAtPosition(s.link,t)&&(this._currentLink=s,this._currentLink.state={decorations:{underline:void 0===s.link.decorations||s.link.decorations.underline,pointerCursor:void 0===s.link.decorations||s.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,s.link,this._lastMouseEvent),s.link.decorations={},Object.defineProperties(s.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:r=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==r&&(this._currentLink.state.decorations.pointerCursor=r,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",r))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:r=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==r&&(this._currentLink.state.decorations.underline=r,this._currentLink.state.isHovered&&this._fireUnderlineEvent(s.link,r))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(r=>{if(!this._currentLink)return;const c=0===r.start?0:r.start+1+this._bufferService.buffer.ydisp,_=this._bufferService.buffer.ydisp+1+r.end;if(this._currentLink.link.range.start.y>=c&&this._currentLink.link.range.end.y<=_&&(this._clearCurrentLink(c,_),this._lastMouseEvent)){const p=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);p&&this._askForLink(p,!1)}})))}_linkHover(s,t,r){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!0),this._currentLink.state.decorations.pointerCursor&&s.classList.add("xterm-cursor-pointer")),t.hover&&t.hover(r,t.text)}_fireUnderlineEvent(s,t){const r=s.range,c=this._bufferService.buffer.ydisp,_=this._createLinkUnderlineEvent(r.start.x-1,r.start.y-c-1,r.end.x,r.end.y-c-1,void 0);(t?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(_)}_linkLeave(s,t,r){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!1),this._currentLink.state.decorations.pointerCursor&&s.classList.remove("xterm-cursor-pointer")),t.leave&&t.leave(r,t.text)}_linkAtPosition(s,t){const _=t.y*this._bufferService.cols+t.x;return s.range.start.y*this._bufferService.cols+s.range.start.x<=_&&_<=s.range.end.y*this._bufferService.cols+s.range.end.x}_positionFromMouseEvent(s,t,r){const c=r.getCoords(s,t,this._bufferService.cols,this._bufferService.rows);if(c)return{x:c[0],y:c[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(s,t,r,c,_){return{x1:s,y1:t,x2:r,y2:c,cols:this._bufferService.cols,fg:_}}};n.Linkifier=i=l([f(1,h.IMouseService),f(2,h.IRenderService),f(3,g.IBufferService),f(4,h.ILinkProviderService)],i)},9042:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.tooMuchOutput=n.promptLabel=void 0,n.promptLabel="Terminal input",n.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(I,n,a){var l=this&&this.__decorate||function(h,i,s,t){var r,c=arguments.length,_=c<3?i:null===t?t=Object.getOwnPropertyDescriptor(i,s):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(h,i,s,t);else for(var p=h.length-1;p>=0;p--)(r=h[p])&&(_=(c<3?r(_):c>3?r(i,s,_):r(i,s))||_);return c>3&&_&&Object.defineProperty(i,s,_),_},f=this&&this.__param||function(h,i){return function(s,t){i(s,t,h)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OscLinkProvider=void 0;const o=a(511),d=a(2585);let e=n.OscLinkProvider=class{constructor(h,i,s){this._bufferService=h,this._optionsService=i,this._oscLinkService=s}provideLinks(h,i){const s=this._bufferService.buffer.lines.get(h-1);if(!s)return void i(void 0);const t=[],r=this._optionsService.rawOptions.linkHandler,c=new o.CellData,_=s.getTrimmedLength();let p=-1,m=-1,u=!1;for(let v=0;v<_;v++)if(-1!==m||s.hasContent(v)){if(s.loadCell(v,c),c.hasExtendedAttrs()&&c.extended.urlId){if(-1===m){m=v,p=c.extended.urlId;continue}u=c.extended.urlId!==p}else-1!==m&&(u=!0);if(u||-1!==m&&v===_-1){const R=this._oscLinkService.getLinkData(p)?.uri;if(R){const D={start:{x:m+1,y:h},end:{x:v+(u||v!==_-1?0:1),y:h}};let B=!1;if(!r?.allowNonHttpProtocols)try{const y=new URL(R);["http:","https:"].includes(y.protocol)||(B=!0)}catch{B=!0}B||t.push({text:R,range:D,activate:(y,O)=>r?r.activate(y,O,D):g(0,O),hover:(y,O)=>r?.hover?.(y,O,D),leave:(y,O)=>r?.leave?.(y,O,D)})}u=!1,c.hasExtendedAttrs()&&c.extended.urlId?(m=v,p=c.extended.urlId):(m=-1,p=-1)}}i(t)}};function g(h,i){if(confirm(`Do you want to navigate to ${i}?\n\nWARNING: This link could potentially be dangerous`)){const s=window.open();if(s){try{s.opener=null}catch{}s.location.href=i}else console.warn("Opening link blocked as opener could not be cleared")}}n.OscLinkProvider=e=l([f(0,d.IBufferService),f(1,d.IOptionsService),f(2,d.IOscLinkService)],e)},6193:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.RenderDebouncer=void 0,n.RenderDebouncer=class{constructor(a,l){this._renderCallback=a,this._coreBrowserService=l,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(a){return this._refreshCallbacks.push(a),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(a,l,f){this._rowCount=f,a=void 0!==a?a:0,l=void 0!==l?l:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,a):a,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,l):l,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,void 0===this._rowStart||void 0===this._rowEnd||void 0===this._rowCount)return void this._runRefreshCallbacks();const a=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,l),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const a of this._refreshCallbacks)a(0);this._refreshCallbacks=[]}}},3236:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Terminal=void 0;const l=a(3614),f=a(3656),o=a(3551),d=a(9042),e=a(3730),g=a(1680),h=a(3107),i=a(5744),s=a(2950),t=a(1296),r=a(428),c=a(4269),_=a(5114),p=a(8934),m=a(3230),u=a(9312),v=a(4725),R=a(6731),D=a(8055),B=a(8969),y=a(8460),O=a(844),H=a(6114),U=a(8437),z=a(2584),$=a(7399),S=a(5941),w=a(9074),x=a(2585),T=a(5435),F=a(4567),j=a(779);n.Terminal=class q extends B.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(M={}){super(M),this.browser=H,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new O.MutableDisposable),this._onCursorMove=this.register(new y.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new y.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new y.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new y.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new y.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new y.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new y.EventEmitter),this._onBlur=this.register(new y.EventEmitter),this._onA11yCharEmitter=this.register(new y.EventEmitter),this._onA11yTabEmitter=this.register(new y.EventEmitter),this._onWillOpen=this.register(new y.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(w.DecorationService),this._instantiationService.setService(x.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(j.LinkProviderService),this._instantiationService.setService(v.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(e.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((b,P)=>this.refresh(b,P))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(b=>this._reportWindowsOptions(b))),this.register(this._inputHandler.onColor(b=>this._handleColorEvent(b))),this.register((0,y.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,y.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,y.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,y.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(b=>this._afterResize(b.cols,b.rows))),this.register((0,O.toDisposable)(()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)}))}_handleColorEvent(M){if(this._themeService)for(const b of M){let P,N="";switch(b.index){case 256:P="foreground",N="10";break;case 257:P="background",N="11";break;case 258:P="cursor",N="12";break;default:P="ansi",N="4;"+b.index}switch(b.type){case 0:const V=D.color.toColorRGB("ansi"===P?this._themeService.colors.ansi[b.index]:this._themeService.colors[P]);this.coreService.triggerDataEvent(`${z.C0.ESC}]${N};${(0,S.toRgbString)(V)}${z.C1_ESCAPED.ST}`);break;case 1:if("ansi"===P)this._themeService.modifyColors(G=>G.ansi[b.index]=D.channels.toColor(...b.color));else{const G=P;this._themeService.modifyColors(Q=>Q[G]=D.channels.toColor(...b.color))}break;case 2:this._themeService.restoreColor(b.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(M){M?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(F.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(M){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(z.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(z.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const b=this.buffer.lines.get(this.buffer.ybase+this.buffer.y);if(!b)return;const P=Math.min(this.buffer.x,this.cols-1),N=this._renderService.dimensions.css.cell.height,V=b.getWidth(P),G=this._renderService.dimensions.css.cell.width*V,Q=this.buffer.y*this._renderService.dimensions.css.cell.height;this.textarea.style.left=P*this._renderService.dimensions.css.cell.width+"px",this.textarea.style.top=Q+"px",this.textarea.style.width=G+"px",this.textarea.style.height=N+"px",this.textarea.style.lineHeight=N+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,f.addDisposableDomListener)(this.element,"copy",b=>{this.hasSelection()&&(0,l.copyHandler)(b,this._selectionService)}));const M=b=>(0,l.handlePasteEvent)(b,this.textarea,this.coreService,this.optionsService);this.register((0,f.addDisposableDomListener)(this.textarea,"paste",M)),this.register((0,f.addDisposableDomListener)(this.element,"paste",M)),this.register(H.isFirefox?(0,f.addDisposableDomListener)(this.element,"mousedown",b=>{2===b.button&&(0,l.rightClickHandler)(b,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)}):(0,f.addDisposableDomListener)(this.element,"contextmenu",b=>{(0,l.rightClickHandler)(b,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),H.isLinux&&this.register((0,f.addDisposableDomListener)(this.element,"auxclick",b=>{1===b.button&&(0,l.moveTextAreaUnderMouseCursor)(b,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,f.addDisposableDomListener)(this.textarea,"keyup",M=>this._keyUp(M),!0)),this.register((0,f.addDisposableDomListener)(this.textarea,"keydown",M=>this._keyDown(M),!0)),this.register((0,f.addDisposableDomListener)(this.textarea,"keypress",M=>this._keyPress(M),!0)),this.register((0,f.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,f.addDisposableDomListener)(this.textarea,"compositionupdate",M=>this._compositionHelper.compositionupdate(M))),this.register((0,f.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,f.addDisposableDomListener)(this.textarea,"input",M=>this._inputEvent(M),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(M){if(!M)throw new Error("Terminal requires a parent element.");if(M.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=M.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),M.appendChild(this.element);const b=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),b.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,f.addDisposableDomListener)(this.screenElement,"mousemove",P=>this.updateCursorStyle(P))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),b.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",d.promptLabel),H.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(_.CoreBrowserService,this.textarea,M.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(v.ICoreBrowserService,this._coreBrowserService),this.register((0,f.addDisposableDomListener)(this.textarea,"focus",P=>this._handleTextAreaFocus(P))),this.register((0,f.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(r.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(v.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(R.ThemeService),this._instantiationService.setService(v.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(c.CharacterJoinerService),this._instantiationService.setService(v.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(m.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(v.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(P=>this._onRender.fire(P))),this.onResize(P=>this._renderService.resize(P.cols,P.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(s.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(p.MouseService),this._instantiationService.setService(v.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(o.Linkifier,this.screenElement)),this.element.appendChild(b);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(g.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(P=>this.scrollLines(P.amount,P.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(u.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(v.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(P=>this.scrollLines(P.amount,P.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(P=>this._renderService.handleSelectionChanged(P.start,P.end,P.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(P=>{this.textarea.value=P,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(P=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,f.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(h.BufferDecorationRenderer,this.screenElement)),this.register((0,f.addDisposableDomListener)(this.element,"mousedown",P=>this._selectionService.handleMouseDown(P))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(F.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",P=>this._handleScreenReaderModeOptionChange(P))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(i.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",P=>{!this._overviewRulerRenderer&&P&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(i.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(t.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const M=this,b=this.element;function P(G){const Q=M._mouseService.getMouseReportCoords(G,M.screenElement);if(!Q)return!1;let ie,re;switch(G.overrideType||G.type){case"mousemove":re=32,void 0===G.buttons?(ie=3,void 0!==G.button&&(ie=G.button<3?G.button:3)):ie=1&G.buttons?0:4&G.buttons?1:2&G.buttons?2:3;break;case"mouseup":re=0,ie=G.button<3?G.button:3;break;case"mousedown":re=1,ie=G.button<3?G.button:3;break;case"wheel":if(M._customWheelEventHandler&&!1===M._customWheelEventHandler(G)||0===M.viewport.getLinesScrolled(G))return!1;re=G.deltaY<0?0:1,ie=4;break;default:return!1}return!(void 0===re||void 0===ie||ie>4)&&M.coreMouseService.triggerMouseEvent({col:Q.col,row:Q.row,x:Q.x,y:Q.y,button:ie,action:re,ctrl:G.ctrlKey,alt:G.altKey,shift:G.shiftKey})}const N={mouseup:null,wheel:null,mousedrag:null,mousemove:null},V={mouseup:G=>(P(G),G.buttons||(this._document.removeEventListener("mouseup",N.mouseup),N.mousedrag&&this._document.removeEventListener("mousemove",N.mousedrag)),this.cancel(G)),wheel:G=>(P(G),this.cancel(G,!0)),mousedrag:G=>{G.buttons&&P(G)},mousemove:G=>{G.buttons||P(G)}};this.register(this.coreMouseService.onProtocolChange(G=>{G?("debug"===this.optionsService.rawOptions.logLevel&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(G)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&G?N.mousemove||(b.addEventListener("mousemove",V.mousemove),N.mousemove=V.mousemove):(b.removeEventListener("mousemove",N.mousemove),N.mousemove=null),16&G?N.wheel||(b.addEventListener("wheel",V.wheel,{passive:!1}),N.wheel=V.wheel):(b.removeEventListener("wheel",N.wheel),N.wheel=null),2&G?N.mouseup||(N.mouseup=V.mouseup):(this._document.removeEventListener("mouseup",N.mouseup),N.mouseup=null),4&G?N.mousedrag||(N.mousedrag=V.mousedrag):(this._document.removeEventListener("mousemove",N.mousedrag),N.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,f.addDisposableDomListener)(b,"mousedown",G=>{if(G.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(G))return P(G),N.mouseup&&this._document.addEventListener("mouseup",N.mouseup),N.mousedrag&&this._document.addEventListener("mousemove",N.mousedrag),this.cancel(G)})),this.register((0,f.addDisposableDomListener)(b,"wheel",G=>{if(!N.wheel){if(this._customWheelEventHandler&&!1===this._customWheelEventHandler(G))return!1;if(!this.buffer.hasScrollback){const Q=this.viewport.getLinesScrolled(G);if(0===Q)return;const ie=z.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(G.deltaY<0?"A":"B");let re="";for(let ne=0;ne<Math.abs(Q);ne++)re+=ie;return this.coreService.triggerDataEvent(re,!0),this.cancel(G,!0)}return this.viewport.handleWheel(G)?this.cancel(G):void 0}},{passive:!1})),this.register((0,f.addDisposableDomListener)(b,"touchstart",G=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(G),this.cancel(G)},{passive:!0})),this.register((0,f.addDisposableDomListener)(b,"touchmove",G=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(G)?void 0:this.cancel(G)},{passive:!1}))}refresh(M,b){this._renderService?.refreshRows(M,b)}updateCursorStyle(M){this._selectionService?.shouldColumnSelect(M)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(M,b,P=0){1===P?(super.scrollLines(M,b,P),this.refresh(0,this.rows-1)):this.viewport?.scrollLines(M)}paste(M){(0,l.paste)(M,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(M){this._customKeyEventHandler=M}attachCustomWheelEventHandler(M){this._customWheelEventHandler=M}registerLinkProvider(M){return this._linkProviderService.registerLinkProvider(M)}registerCharacterJoiner(M){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const b=this._characterJoinerService.register(M);return this.refresh(0,this.rows-1),b}deregisterCharacterJoiner(M){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(M)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(M){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+M)}registerDecoration(M){return this._decorationService.registerDecoration(M)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(M,b,P){this._selectionService.setSelection(M,b,P)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(M,b){this._selectionService?.selectLines(M,b)}_keyDown(M){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&!1===this._customKeyEventHandler(M))return!1;const b=this.browser.isMac&&this.options.macOptionIsMeta&&M.altKey;if(!b&&!this._compositionHelper.keydown(M))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;b||"Dead"!==M.key&&"AltGraph"!==M.key||(this._unprocessedDeadKey=!0);const P=(0,$.evaluateKeyboardEvent)(M,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(M),3===P.type||2===P.type){const N=this.rows-1;return this.scrollLines(2===P.type?-N:N),this.cancel(M,!0)}return 1===P.type&&this.selectAll(),!!this._isThirdLevelShift(this.browser,M)||(P.cancel&&this.cancel(M,!0),!P.key||!!(M.key&&!M.ctrlKey&&!M.altKey&&!M.metaKey&&1===M.key.length&&M.key.charCodeAt(0)>=65&&M.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(P.key!==z.C0.ETX&&P.key!==z.C0.CR||(this.textarea.value=""),this._onKey.fire({key:P.key,domEvent:M}),this._showCursor(),this.coreService.triggerDataEvent(P.key,!0),!this.optionsService.rawOptions.screenReaderMode||M.altKey||M.ctrlKey?this.cancel(M,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(M,b){const P=M.isMac&&!this.options.macOptionIsMeta&&b.altKey&&!b.ctrlKey&&!b.metaKey||M.isWindows&&b.altKey&&b.ctrlKey&&!b.metaKey||M.isWindows&&b.getModifierState("AltGraph");return"keypress"===b.type?P:P&&(!b.keyCode||b.keyCode>47)}_keyUp(M){var b;this._keyDownSeen=!1,this._customKeyEventHandler&&!1===this._customKeyEventHandler(M)||(16===(b=M).keyCode||17===b.keyCode||18===b.keyCode||this.focus(),this.updateCursorStyle(M),this._keyPressHandled=!1)}_keyPress(M){let b;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&!1===this._customKeyEventHandler(M))return!1;if(this.cancel(M),M.charCode)b=M.charCode;else if(null==M.which)b=M.keyCode;else{if(0===M.which||0===M.charCode)return!1;b=M.which}return!(!b||(M.altKey||M.ctrlKey||M.metaKey)&&!this._isThirdLevelShift(this.browser,M)||(b=String.fromCharCode(b),this._onKey.fire({key:b,domEvent:M}),this._showCursor(),this.coreService.triggerDataEvent(b,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(M){return!(!M.data||"insertText"!==M.inputType||M.composed&&this._keyDownSeen||this.optionsService.rawOptions.screenReaderMode||this._keyPressHandled||(this._unprocessedDeadKey=!1,this.coreService.triggerDataEvent(M.data,!0),this.cancel(M),0))}resize(M,b){M!==this.cols||b!==this.rows?super.resize(M,b):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(M,b){this._charSizeService?.measure(),this.viewport?.syncScrollArea(!0)}clear(){if(0!==this.buffer.ybase||0!==this.buffer.y){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let M=1;M<this.rows;M++)this.buffer.lines.push(this.buffer.getBlankLine(U.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),this.viewport?.reset(),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;const M=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this.viewport?.reset(),this._customKeyEventHandler=M,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(z.C0.ESC+"[I"):this.coreService.triggerDataEvent(z.C0.ESC+"[O")}_reportWindowsOptions(M){if(this._renderService)switch(M){case T.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const b=this._renderService.dimensions.css.canvas.width.toFixed(0),P=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${z.C0.ESC}[4;${P};${b}t`);break;case T.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const N=this._renderService.dimensions.css.cell.width.toFixed(0),V=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${z.C0.ESC}[6;${V};${N}t`)}}cancel(M,b){if(this.options.cancelEvents||b)return M.preventDefault(),M.stopPropagation(),!1}}},9924:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TimeBasedDebouncer=void 0,n.TimeBasedDebouncer=class{constructor(a,l=1e3){this._renderCallback=a,this._debounceThresholdMS=l,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(a,l,f){this._rowCount=f,a=void 0!==a?a:0,l=void 0!==l?l:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,a):a,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,l):l;const o=Date.now();if(o-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=o,this._innerRefresh();else if(!this._additionalRefreshRequested){const e=this._debounceThresholdMS-(o-this._lastRefreshMs);this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},e)}}_innerRefresh(){if(void 0===this._rowStart||void 0===this._rowEnd||void 0===this._rowCount)return;const a=Math.max(this._rowStart,0),l=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(a,l)}}},1680:function(I,n,a){var l=this&&this.__decorate||function(s,t,r,c){var _,p=arguments.length,m=p<3?t:null===c?c=Object.getOwnPropertyDescriptor(t,r):c;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(s,t,r,c);else for(var u=s.length-1;u>=0;u--)(_=s[u])&&(m=(p<3?_(m):p>3?_(t,r,m):_(t,r))||m);return p>3&&m&&Object.defineProperty(t,r,m),m},f=this&&this.__param||function(s,t){return function(r,c){t(r,c,s)}};Object.defineProperty(n,"__esModule",{value:!0}),n.Viewport=void 0;const o=a(3656),d=a(4725),e=a(8460),g=a(844),h=a(2585);let i=n.Viewport=class extends g.Disposable{constructor(s,t,r,c,_,p,m,u){super(),this._viewportElement=s,this._scrollArea=t,this._bufferService=r,this._optionsService=c,this._charSizeService=_,this._renderService=p,this._coreBrowserService=m,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new e.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,o.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(v=>this._activeBuffer=v.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(v=>this._renderDimensions=v)),this._handleThemeChange(u.colors),this.register(u.onChangeColors(v=>this._handleThemeChange(v))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(s){this._viewportElement.style.backgroundColor=s.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(s){if(s)return this._innerRefresh(),void(null!==this._refreshAnimationFrame&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));null===this._refreshAnimationFrame&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const t=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==t&&(this._lastRecordedBufferHeight=t,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const s=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==s&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=s),this._refreshAnimationFrame=null}syncScrollArea(s=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(s);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(s)}_handleScroll(s){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const t=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:t,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||-1===this._smoothScrollState.origin||-1===this._smoothScrollState.target)return;const s=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(s*(this._smoothScrollState.target-this._smoothScrollState.origin)),s<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(s,t){return!(t<0&&0!==this._viewportElement.scrollTop||t>0&&this._viewportElement.scrollTop+this._lastRecordedViewportHeight<this._lastRecordedBufferHeight)||(s.cancelable&&s.preventDefault(),!1)}handleWheel(s){const t=this._getPixelsScrolled(s);return 0!==t&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,-1===this._smoothScrollState.target?this._smoothScrollState.target=this._viewportElement.scrollTop+t:this._smoothScrollState.target+=t,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=t,this._bubbleScroll(s,t))}scrollLines(s){if(0!==s)if(this._optionsService.rawOptions.smoothScrollDuration){const t=s*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+t,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:s,suppressScrollEvent:!1})}_getPixelsScrolled(s){if(0===s.deltaY||s.shiftKey)return 0;let t=this._applyScrollModifier(s.deltaY,s);return s.deltaMode===WheelEvent.DOM_DELTA_LINE?t*=this._currentRowHeight:s.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._currentRowHeight*this._bufferService.rows),t}getBufferElements(s,t){let r,c="";const _=[],p=t??this._bufferService.buffer.lines.length,m=this._bufferService.buffer.lines;for(let u=s;u<p;u++){const v=m.get(u);if(!v)continue;const R=m.get(u+1)?.isWrapped;if(c+=v.translateToString(!R),!R||u===m.length-1){const D=document.createElement("div");D.textContent=c,_.push(D),c.length>0&&(r=D),c=""}}return{bufferElements:_,cursorElement:r}}getLinesScrolled(s){if(0===s.deltaY||s.shiftKey)return 0;let t=this._applyScrollModifier(s.deltaY,s);return s.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(t/=this._currentRowHeight+0,this._wheelPartialScroll+=t,t=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):s.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._bufferService.rows),t}_applyScrollModifier(s,t){const r=this._optionsService.rawOptions.fastScrollModifier;return"alt"===r&&t.altKey||"ctrl"===r&&t.ctrlKey||"shift"===r&&t.shiftKey?s*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:s*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(s){this._lastTouchY=s.touches[0].pageY}handleTouchMove(s){const t=this._lastTouchY-s.touches[0].pageY;return this._lastTouchY=s.touches[0].pageY,0!==t&&(this._viewportElement.scrollTop+=t,this._bubbleScroll(s,t))}};n.Viewport=i=l([f(2,h.IBufferService),f(3,h.IOptionsService),f(4,d.ICharSizeService),f(5,d.IRenderService),f(6,d.ICoreBrowserService),f(7,d.IThemeService)],i)},3107:function(I,n,a){var l=this&&this.__decorate||function(h,i,s,t){var r,c=arguments.length,_=c<3?i:null===t?t=Object.getOwnPropertyDescriptor(i,s):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(h,i,s,t);else for(var p=h.length-1;p>=0;p--)(r=h[p])&&(_=(c<3?r(_):c>3?r(i,s,_):r(i,s))||_);return c>3&&_&&Object.defineProperty(i,s,_),_},f=this&&this.__param||function(h,i){return function(s,t){i(s,t,h)}};Object.defineProperty(n,"__esModule",{value:!0}),n.BufferDecorationRenderer=void 0;const o=a(4725),d=a(844),e=a(2585);let g=n.BufferDecorationRenderer=class extends d.Disposable{constructor(h,i,s,t,r){super(),this._screenElement=h,this._bufferService=i,this._coreBrowserService=s,this._decorationService=t,this._renderService=r,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(c=>this._removeDecoration(c))),this.register((0,d.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){void 0===this._animationFrame&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const h of this._decorationService.decorations)this._renderDecoration(h);this._dimensionsChanged=!1}_renderDecoration(h){this._refreshStyle(h),this._dimensionsChanged&&this._refreshXPosition(h)}_createElement(h){const i=this._coreBrowserService.mainDocument.createElement("div");i.classList.add("xterm-decoration"),i.classList.toggle("xterm-decoration-top-layer","top"===h?.options?.layer),i.style.width=`${Math.round((h.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,i.style.height=(h.options.height||1)*this._renderService.dimensions.css.cell.height+"px",i.style.top=(h.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",i.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const s=h.options.x??0;return s&&s>this._bufferService.cols&&(i.style.display="none"),this._refreshXPosition(h,i),i}_refreshStyle(h){const i=h.marker.line-this._bufferService.buffers.active.ydisp;if(i<0||i>=this._bufferService.rows)h.element&&(h.element.style.display="none",h.onRenderEmitter.fire(h.element));else{let s=this._decorationElements.get(h);s||(s=this._createElement(h),h.element=s,this._decorationElements.set(h,s),this._container.appendChild(s),h.onDispose(()=>{this._decorationElements.delete(h),s.remove()})),s.style.top=i*this._renderService.dimensions.css.cell.height+"px",s.style.display=this._altBufferIsActive?"none":"block",h.onRenderEmitter.fire(s)}}_refreshXPosition(h,i=h.element){if(!i)return;const s=h.options.x??0;"right"===(h.options.anchor||"left")?i.style.right=s?s*this._renderService.dimensions.css.cell.width+"px":"":i.style.left=s?s*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(h){this._decorationElements.get(h)?.remove(),this._decorationElements.delete(h),h.dispose()}};n.BufferDecorationRenderer=g=l([f(1,e.IBufferService),f(2,o.ICoreBrowserService),f(3,e.IDecorationService),f(4,o.IRenderService)],g)},5871:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorZoneStore=void 0,n.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(a){if(a.options.overviewRulerOptions){for(const l of this._zones)if(l.color===a.options.overviewRulerOptions.color&&l.position===a.options.overviewRulerOptions.position){if(this._lineIntersectsZone(l,a.marker.line))return;if(this._lineAdjacentToZone(l,a.marker.line,a.options.overviewRulerOptions.position))return void this._addLineToZone(l,a.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=a.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=a.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=a.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=a.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:a.options.overviewRulerOptions.color,position:a.options.overviewRulerOptions.position,startBufferLine:a.marker.line,endBufferLine:a.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(a){this._linePadding=a}_lineIntersectsZone(a,l){return l>=a.startBufferLine&&l<=a.endBufferLine}_lineAdjacentToZone(a,l,f){return l>=a.startBufferLine-this._linePadding[f||"full"]&&l<=a.endBufferLine+this._linePadding[f||"full"]}_addLineToZone(a,l){a.startBufferLine=Math.min(a.startBufferLine,l),a.endBufferLine=Math.max(a.endBufferLine,l)}}},5744:function(I,n,a){var l=this&&this.__decorate||function(r,c,_,p){var m,u=arguments.length,v=u<3?c:null===p?p=Object.getOwnPropertyDescriptor(c,_):p;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)v=Reflect.decorate(r,c,_,p);else for(var R=r.length-1;R>=0;R--)(m=r[R])&&(v=(u<3?m(v):u>3?m(c,_,v):m(c,_))||v);return u>3&&v&&Object.defineProperty(c,_,v),v},f=this&&this.__param||function(r,c){return function(_,p){c(_,p,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OverviewRulerRenderer=void 0;const o=a(5871),d=a(4725),e=a(844),g=a(2585),h={full:0,left:0,center:0,right:0},i={full:0,left:0,center:0,right:0},s={full:0,left:0,center:0,right:0};let t=n.OverviewRulerRenderer=class extends e.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(r,c,_,p,m,u,v){super(),this._viewportElement=r,this._screenElement=c,this._bufferService=_,this._decorationService=p,this._renderService=m,this._optionsService=u,this._coreBrowserService=v,this._colorZoneStore=new o.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement);const R=this._canvas.getContext("2d");if(!R)throw new Error("Ctx cannot be null");this._ctx=R,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,e.toDisposable)(()=>{this._canvas?.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const r=Math.floor(this._canvas.width/3),c=Math.ceil(this._canvas.width/3);i.full=this._canvas.width,i.left=r,i.center=c,i.right=r,this._refreshDrawHeightConstants(),s.full=0,s.left=0,s.center=i.left,s.right=i.left+i.center}_refreshDrawHeightConstants(){h.full=Math.round(2*this._coreBrowserService.dpr);const c=Math.round(Math.max(Math.min(this._canvas.height/this._bufferService.buffer.lines.length,12),6)*this._coreBrowserService.dpr);h.left=c,h.center=c,h.right=c}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*h.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const c of this._decorationService.decorations)this._colorZoneStore.addDecoration(c);this._ctx.lineWidth=1;const r=this._colorZoneStore.zones;for(const c of r)"full"!==c.position&&this._renderColorZone(c);for(const c of r)"full"===c.position&&this._renderColorZone(c);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(r){this._ctx.fillStyle=r.color,this._ctx.fillRect(s[r.position||"full"],Math.round(r.startBufferLine/this._bufferService.buffers.active.lines.length*(this._canvas.height-1)-h[r.position||"full"]/2),i[r.position||"full"],Math.round((r.endBufferLine-r.startBufferLine)/this._bufferService.buffers.active.lines.length*(this._canvas.height-1)+h[r.position||"full"]))}_queueRefresh(r,c){this._shouldUpdateDimensions=r||this._shouldUpdateDimensions,this._shouldUpdateAnchor=c||this._shouldUpdateAnchor,void 0===this._animationFrame&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};n.OverviewRulerRenderer=t=l([f(2,g.IBufferService),f(3,g.IDecorationService),f(4,d.IRenderService),f(5,g.IOptionsService),f(6,d.ICoreBrowserService)],t)},2950:function(I,n,a){var l=this&&this.__decorate||function(h,i,s,t){var r,c=arguments.length,_=c<3?i:null===t?t=Object.getOwnPropertyDescriptor(i,s):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)_=Reflect.decorate(h,i,s,t);else for(var p=h.length-1;p>=0;p--)(r=h[p])&&(_=(c<3?r(_):c>3?r(i,s,_):r(i,s))||_);return c>3&&_&&Object.defineProperty(i,s,_),_},f=this&&this.__param||function(h,i){return function(s,t){i(s,t,h)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CompositionHelper=void 0;const o=a(4725),d=a(2585),e=a(2584);let g=n.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(h,i,s,t,r,c){this._textarea=h,this._compositionView=i,this._bufferService=s,this._optionsService=t,this._coreService=r,this._renderService=c,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(h){this._compositionView.textContent=h.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(h){if(this._isComposing||this._isSendingComposition){if(229===h.keyCode||16===h.keyCode||17===h.keyCode||18===h.keyCode)return!1;this._finalizeComposition(!1)}return 229!==h.keyCode||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(h){if(this._compositionView.classList.remove("active"),this._isComposing=!1,h){const i={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let s;this._isSendingComposition=!1,i.start+=this._dataAlreadySent.length,s=this._isComposing?this._textarea.value.substring(i.start,i.end):this._textarea.value.substring(i.start),s.length>0&&this._coreService.triggerDataEvent(s,!0)}},0)}else{this._isSendingComposition=!1;const i=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(i,!0)}}_handleAnyTextareaChanges(){const h=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const i=this._textarea.value,s=i.replace(h,"");this._dataAlreadySent=s,i.length>h.length?this._coreService.triggerDataEvent(s,!0):i.length<h.length?this._coreService.triggerDataEvent(`${e.C0.DEL}`,!0):i.length===h.length&&i!==h&&this._coreService.triggerDataEvent(i,!0)}},0)}updateCompositionElements(h){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const i=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),s=this._renderService.dimensions.css.cell.height,t=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,r=i*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=r+"px",this._compositionView.style.top=t+"px",this._compositionView.style.height=s+"px",this._compositionView.style.lineHeight=s+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const c=this._compositionView.getBoundingClientRect();this._textarea.style.left=r+"px",this._textarea.style.top=t+"px",this._textarea.style.width=Math.max(c.width,1)+"px",this._textarea.style.height=Math.max(c.height,1)+"px",this._textarea.style.lineHeight=c.height+"px"}h||setTimeout(()=>this.updateCompositionElements(!0),0)}}};n.CompositionHelper=g=l([f(2,d.IBufferService),f(3,d.IOptionsService),f(4,d.ICoreService),f(5,o.IRenderService)],g)},9806:(I,n)=>{function a(l,f,o){const d=o.getBoundingClientRect(),e=l.getComputedStyle(o),g=parseInt(e.getPropertyValue("padding-left")),h=parseInt(e.getPropertyValue("padding-top"));return[f.clientX-d.left-g,f.clientY-d.top-h]}Object.defineProperty(n,"__esModule",{value:!0}),n.getCoords=n.getCoordsRelativeToElement=void 0,n.getCoordsRelativeToElement=a,n.getCoords=function(l,f,o,d,e,g,h,i,s){if(!g)return;const t=a(l,f,o);return t?(t[0]=Math.ceil((t[0]+(s?h/2:0))/h),t[1]=Math.ceil(t[1]/i),t[0]=Math.min(Math.max(t[0],1),d+(s?1:0)),t[1]=Math.min(Math.max(t[1],1),e),t):void 0}},9504:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.moveToCellSequence=void 0;const l=a(2584);function f(i,s,t,r){const c=i-o(i,t),_=s-o(s,t);return h(Math.abs(c-_)-function(m,u,v){let R=0;const D=m-o(m,v),B=u-o(u,v);for(let y=0;y<Math.abs(D-B);y++){const O="A"===d(m,u)?-1:1;v.buffer.lines.get(D+O*y)?.isWrapped&&R++}return R}(i,s,t),g(d(i,s),r))}function o(i,s){let t=0,r=s.buffer.lines.get(i),c=r?.isWrapped;for(;c&&i>=0&&i<s.rows;)t++,r=s.buffer.lines.get(--i),c=r?.isWrapped;return t}function d(i,s){return i>s?"A":"B"}function e(i,s,t,r,c,_){let p=i,m=s,u="";for(;p!==t||m!==r;)p+=c?1:-1,c&&p>_.cols-1?(u+=_.buffer.translateBufferLineToString(m,!1,i,p),p=0,i=0,m++):!c&&p<0&&(u+=_.buffer.translateBufferLineToString(m,!1,0,i+1),p=_.cols-1,i=p,m--);return u+_.buffer.translateBufferLineToString(m,!1,i,p)}function g(i,s){return l.C0.ESC+(s?"O":"[")+i}function h(i,s){i=Math.floor(i);let t="";for(let r=0;r<i;r++)t+=s;return t}n.moveToCellSequence=function(i,s,t,r){const c=t.buffer.x,_=t.buffer.y;if(!t.buffer.hasScrollback)return u=c,(0===f(v=_,s,B=t,y=r).length?"":h(e(u,v,u,v-o(v,B),!1,B).length,g("D",y)))+f(_,s,t,r)+function(u,v,R,D,B,y){let O;O=f(v,D,B,y).length>0?D-o(D,B):v;const H=D,U=function(z,$,S,w,x,T){let F;return F=f(S,w,x,T).length>0?w-o(w,x):$,z<S&&F<=w||z>=S&&F<w?"C":"D"}(u,v,R,D,B,y);return h(e(u,O,R,H,"C"===U,B).length,g(U,y))}(c,_,i,s,t,r);var u,v,B,y;let p;if(_===s)return p=c>i?"D":"C",h(Math.abs(c-i),g(p,r));p=_>s?"D":"C";const m=Math.abs(_-s);return h(function(u,v){return v.cols-u}(_>s?i:c,t)+(m-1)*t.cols+1+((_>s?c:i)-1),g(p,r))}},1296:function(I,n,a){var l=this&&this.__decorate||function(y,O,H,U){var z,$=arguments.length,S=$<3?O:null===U?U=Object.getOwnPropertyDescriptor(O,H):U;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)S=Reflect.decorate(y,O,H,U);else for(var w=y.length-1;w>=0;w--)(z=y[w])&&(S=($<3?z(S):$>3?z(O,H,S):z(O,H))||S);return $>3&&S&&Object.defineProperty(O,H,S),S},f=this&&this.__param||function(y,O){return function(H,U){O(H,U,y)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomRenderer=void 0;const o=a(3787),d=a(2550),e=a(2223),g=a(6171),h=a(6052),i=a(4725),s=a(8055),t=a(8460),r=a(844),c=a(2585),_="xterm-dom-renderer-owner-",p="xterm-rows",m="xterm-fg-",u="xterm-bg-",v="xterm-focus",R="xterm-selection";let D=1,B=n.DomRenderer=class extends r.Disposable{constructor(y,O,H,U,z,$,S,w,x,T,F,j,q){super(),this._terminal=y,this._document=O,this._element=H,this._screenElement=U,this._viewportElement=z,this._helperContainer=$,this._linkifier2=S,this._charSizeService=x,this._optionsService=T,this._bufferService=F,this._coreBrowserService=j,this._themeService=q,this._terminalClass=D++,this._rowElements=[],this._selectionRenderModel=(0,h.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new t.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(p),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(R),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,g.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(Y=>this._injectCss(Y))),this._injectCss(this._themeService.colors),this._rowFactory=w.createInstance(o.DomRendererRowFactory,document),this._element.classList.add(_+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(Y=>this._handleLinkHover(Y))),this.register(this._linkifier2.onHideLinkUnderline(Y=>this._handleLinkLeave(Y))),this.register((0,r.toDisposable)(()=>{this._element.classList.remove(_+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new d.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const y=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*y,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*y),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/y),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/y),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const H of this._rowElements)H.style.width=`${this.dimensions.css.canvas.width}px`,H.style.height=`${this.dimensions.css.cell.height}px`,H.style.lineHeight=`${this.dimensions.css.cell.height}px`,H.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement)),this._dimensionsStyleElement.textContent=`${this._terminalSelector} .${p} span { display: inline-block; height: 100%; vertical-align: top;}`,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(y){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let O=`${this._terminalSelector} .${p} { color: ${y.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;O+=`${this._terminalSelector} .${p} .xterm-dim { color: ${s.color.multiplyOpacity(y.foreground,.5).css};}`,O+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const H=`blink_underline_${this._terminalClass}`,U=`blink_bar_${this._terminalClass}`,z=`blink_block_${this._terminalClass}`;O+=`@keyframes ${H} { 50% {  border-bottom-style: hidden; }}`,O+=`@keyframes ${U} { 50% {  box-shadow: none; }}`,O+=`@keyframes ${z} { 0% {  background-color: ${y.cursor.css};  color: ${y.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${y.cursor.css}; }}`,O+=`${this._terminalSelector} .${p}.${v} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${H} 1s step-end infinite;}${this._terminalSelector} .${p}.${v} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${U} 1s step-end infinite;}${this._terminalSelector} .${p}.${v} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${z} 1s step-end infinite;}${this._terminalSelector} .${p} .xterm-cursor.xterm-cursor-block { background-color: ${y.cursor.css}; color: ${y.cursorAccent.css};}${this._terminalSelector} .${p} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${y.cursor.css} !important; color: ${y.cursorAccent.css} !important;}${this._terminalSelector} .${p} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${y.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${p} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${y.cursor.css} inset;}${this._terminalSelector} .${p} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${y.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,O+=`${this._terminalSelector} .${R} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${R} div { position: absolute; background-color: ${y.selectionBackgroundOpaque.css};}${this._terminalSelector} .${R} div { position: absolute; background-color: ${y.selectionInactiveBackgroundOpaque.css};}`;for(const[$,S]of y.ansi.entries())O+=`${this._terminalSelector} .${m}${$} { color: ${S.css}; }${this._terminalSelector} .${m}${$}.xterm-dim { color: ${s.color.multiplyOpacity(S,.5).css}; }${this._terminalSelector} .${u}${$} { background-color: ${S.css}; }`;O+=`${this._terminalSelector} .${m}${e.INVERTED_DEFAULT_COLOR} { color: ${s.color.opaque(y.background).css}; }${this._terminalSelector} .${m}${e.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${s.color.multiplyOpacity(s.color.opaque(y.background),.5).css}; }${this._terminalSelector} .${u}${e.INVERTED_DEFAULT_COLOR} { background-color: ${y.foreground.css}; }`,this._themeStyleElement.textContent=O}_setDefaultSpacing(){const y=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${y}px`,this._rowFactory.defaultSpacing=y}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(y,O){for(let H=this._rowElements.length;H<=O;H++){const U=this._document.createElement("div");this._rowContainer.appendChild(U),this._rowElements.push(U)}for(;this._rowElements.length>O;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(y,O){this._refreshRowElements(y,O),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(v),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(v),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(y,O,H){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(y,O,H),this.renderRows(0,this._bufferService.rows-1),!y||!O)return;this._selectionRenderModel.update(this._terminal,y,O,H);const U=this._selectionRenderModel.viewportStartRow,z=this._selectionRenderModel.viewportEndRow,$=this._selectionRenderModel.viewportCappedStartRow,S=this._selectionRenderModel.viewportCappedEndRow;if($>=this._bufferService.rows||S<0)return;const w=this._document.createDocumentFragment();if(H){const x=y[0]>O[0];w.appendChild(this._createSelectionElement($,x?O[0]:y[0],x?y[0]:O[0],S-$+1))}else w.appendChild(this._createSelectionElement($,U===$?y[0]:0,$===z?O[0]:this._bufferService.cols)),w.appendChild(this._createSelectionElement($+1,0,this._bufferService.cols,S-$-1)),$!==S&&w.appendChild(this._createSelectionElement(S,0,z===S?O[0]:this._bufferService.cols));this._selectionContainer.appendChild(w)}_createSelectionElement(y,O,H,U=1){const z=this._document.createElement("div"),$=O*this.dimensions.css.cell.width;let S=this.dimensions.css.cell.width*(H-O);return $+S>this.dimensions.css.canvas.width&&(S=this.dimensions.css.canvas.width-$),z.style.height=U*this.dimensions.css.cell.height+"px",z.style.top=y*this.dimensions.css.cell.height+"px",z.style.left=`${$}px`,z.style.width=`${S}px`,z}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const y of this._rowElements)y.replaceChildren()}renderRows(y,O){const H=this._bufferService.buffer,U=H.ybase+H.y,z=Math.min(H.x,this._bufferService.cols-1),$=this._optionsService.rawOptions.cursorBlink,S=this._optionsService.rawOptions.cursorStyle,w=this._optionsService.rawOptions.cursorInactiveStyle;for(let x=y;x<=O;x++){const T=x+H.ydisp,F=this._rowElements[x],j=H.lines.get(T);if(!F||!j)break;F.replaceChildren(...this._rowFactory.createRow(j,T,T===U,S,w,z,$,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${_}${this._terminalClass}`}_handleLinkHover(y){this._setCellUnderline(y.x1,y.x2,y.y1,y.y2,y.cols,!0)}_handleLinkLeave(y){this._setCellUnderline(y.x1,y.x2,y.y1,y.y2,y.cols,!1)}_setCellUnderline(y,O,H,U,z,$){H<0&&(y=0),U<0&&(O=0);const S=this._bufferService.rows-1;H=Math.max(Math.min(H,S),0),U=Math.max(Math.min(U,S),0),z=Math.min(z,this._bufferService.cols);const w=this._bufferService.buffer,x=w.ybase+w.y,T=Math.min(w.x,z-1),F=this._optionsService.rawOptions.cursorBlink,j=this._optionsService.rawOptions.cursorStyle,q=this._optionsService.rawOptions.cursorInactiveStyle;for(let Y=H;Y<=U;++Y){const M=Y+w.ydisp,b=this._rowElements[Y],P=w.lines.get(M);if(!b||!P)break;b.replaceChildren(...this._rowFactory.createRow(P,M,M===x,j,q,T,F,this.dimensions.css.cell.width,this._widthCache,$?Y===H?y:0:-1,$?(Y===U?O:z)-1:-1))}}};n.DomRenderer=B=l([f(7,c.IInstantiationService),f(8,i.ICharSizeService),f(9,c.IOptionsService),f(10,c.IBufferService),f(11,i.ICoreBrowserService),f(12,i.IThemeService)],B)},3787:function(I,n,a){var l=this&&this.__decorate||function(p,m,u,v){var R,D=arguments.length,B=D<3?m:null===v?v=Object.getOwnPropertyDescriptor(m,u):v;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)B=Reflect.decorate(p,m,u,v);else for(var y=p.length-1;y>=0;y--)(R=p[y])&&(B=(D<3?R(B):D>3?R(m,u,B):R(m,u))||B);return D>3&&B&&Object.defineProperty(m,u,B),B},f=this&&this.__param||function(p,m){return function(u,v){m(u,v,p)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DomRendererRowFactory=void 0;const o=a(2223),d=a(643),e=a(511),g=a(2585),h=a(8055),i=a(4725),s=a(4269),t=a(6171),r=a(3734);let c=n.DomRendererRowFactory=class{constructor(p,m,u,v,R,D,B){this._document=p,this._characterJoinerService=m,this._optionsService=u,this._coreBrowserService=v,this._coreService=R,this._decorationService=D,this._themeService=B,this._workCell=new e.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(p,m,u){this._selectionStart=p,this._selectionEnd=m,this._columnSelectMode=u}createRow(p,m,u,v,R,D,B,y,O,H,U){const z=[],$=this._characterJoinerService.getJoinedCharacters(m),S=this._themeService.colors;let w,x=p.getNoBgTrimmedLength();u&&x<D+1&&(x=D+1);let T=0,F="",j=0,q=0,Y=0,M=!1,b=0,P=!1,N=0;const V=[],G=-1!==H&&-1!==U;for(let Q=0;Q<x;Q++){p.loadCell(Q,this._workCell);let ie=this._workCell.getWidth();if(0===ie)continue;let re=!1,ne=Q,X=this._workCell;if($.length>0&&Q===$[0][0]){re=!0;const te=$.shift();X=new s.JoinedCellData(this._workCell,p.translateToString(!0,te[0],te[1]),te[1]-te[0]),ne=te[1]-1,ie=X.getWidth()}const ge=this._isCellInSelection(Q,m),we=u&&Q===D,Ee=G&&Q>=H&&Q<=U;let ke=!1;this._decorationService.forEachDecorationAtCell(Q,m,void 0,te=>{ke=!0});let Ce=X.getChars()||d.WHITESPACE_CELL_CHAR;if(" "===Ce&&(X.isUnderline()||X.isOverline())&&(Ce="\xa0"),N=ie*y-O.get(Ce,X.isBold(),X.isItalic()),w){if(T&&(ge&&P||!ge&&!P&&X.bg===j)&&(ge&&P&&S.selectionForeground||X.fg===q)&&X.extended.ext===Y&&Ee===M&&N===b&&!we&&!re&&!ke){X.isInvisible()?F+=d.WHITESPACE_CELL_CHAR:F+=Ce,T++;continue}T&&(w.textContent=F),w=this._document.createElement("span"),T=0,F=""}else w=this._document.createElement("span");if(j=X.bg,q=X.fg,Y=X.extended.ext,M=Ee,b=N,P=ge,re&&D>=Q&&D<=ne&&(D=Q),!this._coreService.isCursorHidden&&we&&this._coreService.isCursorInitialized)if(V.push("xterm-cursor"),this._coreBrowserService.isFocused)B&&V.push("xterm-cursor-blink"),V.push("bar"===v?"xterm-cursor-bar":"underline"===v?"xterm-cursor-underline":"xterm-cursor-block");else if(R)switch(R){case"outline":V.push("xterm-cursor-outline");break;case"block":V.push("xterm-cursor-block");break;case"bar":V.push("xterm-cursor-bar");break;case"underline":V.push("xterm-cursor-underline")}if(X.isBold()&&V.push("xterm-bold"),X.isItalic()&&V.push("xterm-italic"),X.isDim()&&V.push("xterm-dim"),F=X.isInvisible()?d.WHITESPACE_CELL_CHAR:X.getChars()||d.WHITESPACE_CELL_CHAR,X.isUnderline()&&(V.push(`xterm-underline-${X.extended.underlineStyle}`)," "===F&&(F="\xa0"),!X.isUnderlineColorDefault()))if(X.isUnderlineColorRGB())w.style.textDecorationColor=`rgb(${r.AttributeData.toColorRGB(X.getUnderlineColor()).join(",")})`;else{let te=X.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&X.isBold()&&te<8&&(te+=8),w.style.textDecorationColor=S.ansi[te].css}X.isOverline()&&(V.push("xterm-overline")," "===F&&(F="\xa0")),X.isStrikethrough()&&V.push("xterm-strikethrough"),Ee&&(w.style.textDecoration="underline");let ae=X.getFgColor(),me=X.getFgColorMode(),he=X.getBgColor(),ve=X.getBgColorMode();const be=!!X.isInverse();if(be){const te=ae;ae=he,he=te;const De=me;me=ve,ve=De}let de,ce,ue,Se=!1;switch(this._decorationService.forEachDecorationAtCell(Q,m,void 0,te=>{"top"!==te.options.layer&&Se||(te.backgroundColorRGB&&(ve=50331648,he=te.backgroundColorRGB.rgba>>8&16777215,de=te.backgroundColorRGB),te.foregroundColorRGB&&(me=50331648,ae=te.foregroundColorRGB.rgba>>8&16777215,ce=te.foregroundColorRGB),Se="top"===te.options.layer)}),!Se&&ge&&(de=this._coreBrowserService.isFocused?S.selectionBackgroundOpaque:S.selectionInactiveBackgroundOpaque,he=de.rgba>>8&16777215,ve=50331648,Se=!0,S.selectionForeground&&(me=50331648,ae=S.selectionForeground.rgba>>8&16777215,ce=S.selectionForeground)),Se&&V.push("xterm-decoration-top"),ve){case 16777216:case 33554432:ue=S.ansi[he],V.push(`xterm-bg-${he}`);break;case 50331648:ue=h.channels.toColor(he>>16,he>>8&255,255&he),this._addStyle(w,`background-color:#${_((he>>>0).toString(16),"0",6)}`);break;default:be?(ue=S.foreground,V.push(`xterm-bg-${o.INVERTED_DEFAULT_COLOR}`)):ue=S.background}switch(de||X.isDim()&&(de=h.color.multiplyOpacity(ue,.5)),me){case 16777216:case 33554432:X.isBold()&&ae<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(ae+=8),this._applyMinimumContrast(w,ue,S.ansi[ae],X,de,void 0)||V.push(`xterm-fg-${ae}`);break;case 50331648:const te=h.channels.toColor(ae>>16&255,ae>>8&255,255&ae);this._applyMinimumContrast(w,ue,te,X,de,ce)||this._addStyle(w,`color:#${_(ae.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(w,ue,S.foreground,X,de,ce)||be&&V.push(`xterm-fg-${o.INVERTED_DEFAULT_COLOR}`)}V.length&&(w.className=V.join(" "),V.length=0),we||re||ke?w.textContent=F:T++,N!==this.defaultSpacing&&(w.style.letterSpacing=`${N}px`),z.push(w),Q=ne}return w&&T&&(w.textContent=F),z}_applyMinimumContrast(p,m,u,v,R,D){if(1===this._optionsService.rawOptions.minimumContrastRatio||(0,t.treatGlyphAsBackgroundColor)(v.getCode()))return!1;const B=this._getContrastCache(v);let y;if(R||D||(y=B.getColor(m.rgba,u.rgba)),void 0===y){const O=this._optionsService.rawOptions.minimumContrastRatio/(v.isDim()?2:1);y=h.color.ensureContrastRatio(R||m,D||u,O),B.setColor((R||m).rgba,(D||u).rgba,y??null)}return!!y&&(this._addStyle(p,`color:${y.css}`),!0)}_getContrastCache(p){return p.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(p,m){p.setAttribute("style",`${p.getAttribute("style")||""}${m};`)}_isCellInSelection(p,m){const u=this._selectionStart,v=this._selectionEnd;return!(!u||!v)&&(this._columnSelectMode?u[0]<=v[0]?p>=u[0]&&m>=u[1]&&p<v[0]&&m<=v[1]:p<u[0]&&m>=u[1]&&p>=v[0]&&m<=v[1]:m>u[1]&&m<v[1]||u[1]===v[1]&&m===u[1]&&p>=u[0]&&p<v[0]||u[1]<v[1]&&m===v[1]&&p<v[0]||u[1]<v[1]&&m===u[1]&&p>=u[0])}};function _(p,m,u){for(;p.length<u;)p=m+p;return p}n.DomRendererRowFactory=c=l([f(1,i.ICharacterJoinerService),f(2,g.IOptionsService),f(3,i.ICoreBrowserService),f(4,g.ICoreService),f(5,g.IDecorationService),f(6,i.IThemeService)],c)},2550:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WidthCache=void 0,n.WidthCache=class{constructor(a,l){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=a.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const f=a.createElement("span");f.classList.add("xterm-char-measure-element");const o=a.createElement("span");o.classList.add("xterm-char-measure-element"),o.style.fontWeight="bold";const d=a.createElement("span");d.classList.add("xterm-char-measure-element"),d.style.fontStyle="italic";const e=a.createElement("span");e.classList.add("xterm-char-measure-element"),e.style.fontWeight="bold",e.style.fontStyle="italic",this._measureElements=[f,o,d,e],this._container.appendChild(f),this._container.appendChild(o),this._container.appendChild(d),this._container.appendChild(e),l.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(a,l,f,o){a===this._font&&l===this._fontSize&&f===this._weight&&o===this._weightBold||(this._font=a,this._fontSize=l,this._weight=f,this._weightBold=o,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${f}`,this._measureElements[1].style.fontWeight=`${o}`,this._measureElements[2].style.fontWeight=`${f}`,this._measureElements[3].style.fontWeight=`${o}`,this.clear())}get(a,l,f){let o=0;if(!l&&!f&&1===a.length&&(o=a.charCodeAt(0))<256){if(-9999!==this._flat[o])return this._flat[o];const g=this._measure(a,0);return g>0&&(this._flat[o]=g),g}let d=a;l&&(d+="B"),f&&(d+="I");let e=this._holey.get(d);if(void 0===e){let g=0;l&&(g|=1),f&&(g|=2),e=this._measure(a,g),e>0&&this._holey.set(d,e)}return e}_measure(a,l){const f=this._measureElements[l];return f.textContent=a.repeat(32),f.offsetWidth/32}}},2223:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TEXT_BASELINE=n.DIM_OPACITY=n.INVERTED_DEFAULT_COLOR=void 0;const l=a(6114);n.INVERTED_DEFAULT_COLOR=257,n.DIM_OPACITY=.5,n.TEXT_BASELINE=l.isFirefox||l.isLegacyEdge?"bottom":"ideographic"},6171:(I,n)=>{function a(f){return 57508<=f&&f<=57558}function l(f){return f>=128512&&f<=128591||f>=127744&&f<=128511||f>=128640&&f<=128767||f>=9728&&f<=9983||f>=9984&&f<=10175||f>=65024&&f<=65039||f>=129280&&f<=129535||f>=127462&&f<=127487}Object.defineProperty(n,"__esModule",{value:!0}),n.computeNextVariantOffset=n.createRenderDimensions=n.treatGlyphAsBackgroundColor=n.allowRescaling=n.isEmoji=n.isRestrictedPowerlineGlyph=n.isPowerlineGlyph=n.throwIfFalsy=void 0,n.throwIfFalsy=function(f){if(!f)throw new Error("value must not be falsy");return f},n.isPowerlineGlyph=a,n.isRestrictedPowerlineGlyph=function(f){return 57520<=f&&f<=57527},n.isEmoji=l,n.allowRescaling=function(f,o,d,e){return 1===o&&d>Math.ceil(1.5*e)&&void 0!==f&&f>255&&!l(f)&&!a(f)&&!(57344<=(g=f)&&g<=63743);var g},n.treatGlyphAsBackgroundColor=function(f){return a(f)||9472<=(o=f)&&o<=9631;var o},n.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},n.computeNextVariantOffset=function(f,o,d=0){return(f-(2*Math.round(o)-d))%(2*Math.round(o))}},6052:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createSelectionRenderModel=void 0;class a{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(f,o,d,e=!1){if(this.selectionStart=o,this.selectionEnd=d,!o||!d||o[0]===d[0]&&o[1]===d[1])return void this.clear();const g=f.buffers.active.ydisp,h=o[1]-g,i=d[1]-g,s=Math.max(h,0),t=Math.min(i,f.rows-1);s>=f.rows||t<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=e,this.viewportStartRow=h,this.viewportEndRow=i,this.viewportCappedStartRow=s,this.viewportCappedEndRow=t,this.startCol=o[0],this.endCol=d[0])}isCellSelected(f,o,d){return!!this.hasSelection&&(d-=f.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?o>=this.startCol&&d>=this.viewportCappedStartRow&&o<this.endCol&&d<=this.viewportCappedEndRow:o<this.startCol&&d>=this.viewportCappedStartRow&&o>=this.endCol&&d<=this.viewportCappedEndRow:d>this.viewportStartRow&&d<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&d===this.viewportStartRow&&o>=this.startCol&&o<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportEndRow&&o<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportStartRow&&o>=this.startCol)}}n.createSelectionRenderModel=function(){return new a}},456:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionModel=void 0,n.SelectionModel=class{constructor(a){this._bufferService=a,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?a%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)-1]:[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[a,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const a=this.selectionStart[0]+this.selectionStartLength;return a>this._bufferService.cols?[a%this._bufferService.cols,this.selectionStart[1]+Math.floor(a/this._bufferService.cols)]:[Math.max(a,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const a=this.selectionStart,l=this.selectionEnd;return!(!a||!l)&&(a[1]>l[1]||a[1]===l[1]&&a[0]>l[0])}handleTrim(a){return this.selectionStart&&(this.selectionStart[1]-=a),this.selectionEnd&&(this.selectionEnd[1]-=a),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(I,n,a){var l=this&&this.__decorate||function(t,r,c,_){var p,m=arguments.length,u=m<3?r:null===_?_=Object.getOwnPropertyDescriptor(r,c):_;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,c,_);else for(var v=t.length-1;v>=0;v--)(p=t[v])&&(u=(m<3?p(u):m>3?p(r,c,u):p(r,c))||u);return m>3&&u&&Object.defineProperty(r,c,u),u},f=this&&this.__param||function(t,r){return function(c,_){r(c,_,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CharSizeService=void 0;const o=a(2585),d=a(8460),e=a(844);let g=n.CharSizeService=class extends e.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(t,r,c){super(),this._optionsService=c,this.width=0,this.height=0,this._onCharSizeChange=this.register(new d.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new s(this._optionsService))}catch{this._measureStrategy=this.register(new i(t,r,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const t=this._measureStrategy.measure();t.width===this.width&&t.height===this.height||(this.width=t.width,this.height=t.height,this._onCharSizeChange.fire())}};n.CharSizeService=g=l([f(2,o.IOptionsService)],g);class h extends e.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(r,c){void 0!==r&&r>0&&void 0!==c&&c>0&&(this._result.width=r,this._result.height=c)}}class i extends h{constructor(r,c,_){super(),this._document=r,this._parentElement=c,this._optionsService=_,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class s extends h{constructor(r){super(),this._optionsService=r,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const c=this._ctx.measureText("W");if(!("width"in c&&"fontBoundingBoxAscent"in c&&"fontBoundingBoxDescent"in c))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const r=this._ctx.measureText("W");return this._validateAndSet(r.width,r.fontBoundingBoxAscent+r.fontBoundingBoxDescent),this._result}}},4269:function(I,n,a){var l=this&&this.__decorate||function(s,t,r,c){var _,p=arguments.length,m=p<3?t:null===c?c=Object.getOwnPropertyDescriptor(t,r):c;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)m=Reflect.decorate(s,t,r,c);else for(var u=s.length-1;u>=0;u--)(_=s[u])&&(m=(p<3?_(m):p>3?_(t,r,m):_(t,r))||m);return p>3&&m&&Object.defineProperty(t,r,m),m},f=this&&this.__param||function(s,t){return function(r,c){t(r,c,s)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CharacterJoinerService=n.JoinedCellData=void 0;const o=a(3734),d=a(643),e=a(511),g=a(2585);n.JoinedCellData=class h extends o.AttributeData{constructor(t,r,c){super(),this.content=0,this.combinedData="",this.fg=t.fg,this.bg=t.bg,this.combinedData=r,this._width=c}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(t){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}};let i=n.CharacterJoinerService=class Pe{constructor(t){this._bufferService=t,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new e.CellData}register(t){const r={id:this._nextCharacterJoinerId++,handler:t};return this._characterJoiners.push(r),r.id}deregister(t){for(let r=0;r<this._characterJoiners.length;r++)if(this._characterJoiners[r].id===t)return this._characterJoiners.splice(r,1),!0;return!1}getJoinedCharacters(t){if(0===this._characterJoiners.length)return[];const r=this._bufferService.buffer.lines.get(t);if(!r||0===r.length)return[];const c=[],_=r.translateToString(!0);let p=0,m=0,u=0,v=r.getFg(0),R=r.getBg(0);for(let D=0;D<r.getTrimmedLength();D++)if(r.loadCell(D,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==v||this._workCell.bg!==R){if(D-p>1){const B=this._getJoinedRanges(_,u,m,r,p);for(let y=0;y<B.length;y++)c.push(B[y])}p=D,u=m,v=this._workCell.fg,R=this._workCell.bg}m+=this._workCell.getChars().length||d.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-p>1){const D=this._getJoinedRanges(_,u,m,r,p);for(let B=0;B<D.length;B++)c.push(D[B])}return c}_getJoinedRanges(t,r,c,_,p){const m=t.substring(r,c);let u=[];try{u=this._characterJoiners[0].handler(m)}catch(v){console.error(v)}for(let v=1;v<this._characterJoiners.length;v++)try{const R=this._characterJoiners[v].handler(m);for(let D=0;D<R.length;D++)Pe._mergeRanges(u,R[D])}catch(R){console.error(R)}return this._stringRangesToCellRanges(u,_,p),u}_stringRangesToCellRanges(t,r,c){let _=0,p=!1,m=0,u=t[_];if(u){for(let v=c;v<this._bufferService.cols;v++){const R=r.getWidth(v),D=r.getString(v).length||d.WHITESPACE_CELL_CHAR.length;if(0!==R){if(!p&&u[0]<=m&&(u[0]=v,p=!0),u[1]<=m){if(u[1]=v,u=t[++_],!u)break;u[0]<=m?(u[0]=v,p=!0):p=!1}m+=D}}u&&(u[1]=this._bufferService.cols)}}static _mergeRanges(t,r){let c=!1;for(let _=0;_<t.length;_++){const p=t[_];if(c){if(r[1]<=p[0])return t[_-1][1]=r[1],t;if(r[1]<=p[1])return t[_-1][1]=Math.max(r[1],p[1]),t.splice(_,1),t;t.splice(_,1),_--}else{if(r[1]<=p[0])return t.splice(_,0,r),t;if(r[1]<=p[1])return p[0]=Math.min(r[0],p[0]),t;r[0]<p[1]&&(p[0]=Math.min(r[0],p[0]),c=!0)}}return c?t[t.length-1][1]=r[1]:t.push(r),t}};n.CharacterJoinerService=i=l([f(0,g.IBufferService)],i)},5114:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CoreBrowserService=void 0;const l=a(844),f=a(8460),o=a(3656);n.CoreBrowserService=class d extends l.Disposable{constructor(h,i,s){super(),this._textarea=h,this._window=i,this.mainDocument=s,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new e(this._window),this._onDprChange=this.register(new f.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new f.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(t=>this._screenDprMonitor.setWindow(t))),this.register((0,f.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(h){this._window!==h&&(this._window=h,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return void 0===this._cachedIsFocused&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}};class e extends l.Disposable{constructor(h){super(),this._parentWindow=h,this._windowResizeListener=this.register(new l.MutableDisposable),this._onDprChange=this.register(new f.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,l.toDisposable)(()=>this.clearListener()))}setWindow(h){this._parentWindow=h,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,o.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.LinkProviderService=void 0;const l=a(844);n.LinkProviderService=class f extends l.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,l.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(d){return this.linkProviders.push(d),{dispose:()=>{const e=this.linkProviders.indexOf(d);-1!==e&&this.linkProviders.splice(e,1)}}}}},8934:function(I,n,a){var l=this&&this.__decorate||function(g,h,i,s){var t,r=arguments.length,c=r<3?h:null===s?s=Object.getOwnPropertyDescriptor(h,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(g,h,i,s);else for(var _=g.length-1;_>=0;_--)(t=g[_])&&(c=(r<3?t(c):r>3?t(h,i,c):t(h,i))||c);return r>3&&c&&Object.defineProperty(h,i,c),c},f=this&&this.__param||function(g,h){return function(i,s){h(i,s,g)}};Object.defineProperty(n,"__esModule",{value:!0}),n.MouseService=void 0;const o=a(4725),d=a(9806);let e=n.MouseService=class{constructor(g,h){this._renderService=g,this._charSizeService=h}getCoords(g,h,i,s,t){return(0,d.getCoords)(window,g,h,i,s,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,t)}getMouseReportCoords(g,h){const i=(0,d.getCoordsRelativeToElement)(window,g,h);if(this._charSizeService.hasValidSize)return i[0]=Math.min(Math.max(i[0],0),this._renderService.dimensions.css.canvas.width-1),i[1]=Math.min(Math.max(i[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(i[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(i[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(i[0]),y:Math.floor(i[1])}}};n.MouseService=e=l([f(0,o.IRenderService),f(1,o.ICharSizeService)],e)},3230:function(I,n,a){var l=this&&this.__decorate||function(t,r,c,_){var p,m=arguments.length,u=m<3?r:null===_?_=Object.getOwnPropertyDescriptor(r,c):_;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,c,_);else for(var v=t.length-1;v>=0;v--)(p=t[v])&&(u=(m<3?p(u):m>3?p(r,c,u):p(r,c))||u);return m>3&&u&&Object.defineProperty(r,c,u),u},f=this&&this.__param||function(t,r){return function(c,_){r(c,_,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.RenderService=void 0;const o=a(6193),d=a(4725),e=a(8460),g=a(844),h=a(7226),i=a(2585);let s=n.RenderService=class extends g.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(t,r,c,_,p,m,u,v){super(),this._rowCount=t,this._charSizeService=_,this._renderer=this.register(new g.MutableDisposable),this._pausedResizeTask=new h.DebouncedIdleTask,this._observerDisposable=this.register(new g.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new e.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new e.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new e.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new e.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new o.RenderDebouncer((R,D)=>this._renderRows(R,D),u),this.register(this._renderDebouncer),this.register(u.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(m.onResize(()=>this._fullRefresh())),this.register(m.buffers.onBufferActivate(()=>this._renderer.value?.clear())),this.register(c.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(p.onDecorationRegistered(()=>this._fullRefresh())),this.register(p.onDecorationRemoved(()=>this._fullRefresh())),this.register(c.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(m.cols,m.rows),this._fullRefresh()})),this.register(c.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(m.buffer.y,m.buffer.y,!0))),this.register(v.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(u.window,r),this.register(u.onWindowChange(R=>this._registerIntersectionObserver(R,r)))}_registerIntersectionObserver(t,r){if("IntersectionObserver"in t){const c=new t.IntersectionObserver(_=>this._handleIntersectionChange(_[_.length-1]),{threshold:0});c.observe(r),this._observerDisposable.value=(0,g.toDisposable)(()=>c.disconnect())}}_handleIntersectionChange(t){this._isPaused=void 0===t.isIntersecting?0===t.intersectionRatio:!t.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(t,r,c=!1){this._isPaused?this._needsFullRefresh=!0:(c||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(t,r,this._rowCount))}_renderRows(t,r){this._renderer.value&&(t=Math.min(t,this._rowCount-1),r=Math.min(r,this._rowCount-1),this._renderer.value.renderRows(t,r),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:t,end:r}),this._onRender.fire({start:t,end:r}),this._isNextRenderRedrawOnly=!0)}resize(t,r){this._rowCount=r,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(t){this._renderer.value=t,this._renderer.value&&(this._renderer.value.onRequestRedraw(r=>this.refreshRows(r.start,r.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(t){return this._renderDebouncer.addRefreshCallback(t)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(t,r){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value?.handleResize(t,r)):this._renderer.value.handleResize(t,r),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(t,r,c){this._selectionState.start=t,this._selectionState.end=r,this._selectionState.columnSelectMode=c,this._renderer.value?.handleSelectionChanged(t,r,c)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};n.RenderService=s=l([f(2,i.IOptionsService),f(3,d.ICharSizeService),f(4,i.IDecorationService),f(5,i.IBufferService),f(6,d.ICoreBrowserService),f(7,d.IThemeService)],s)},9312:function(I,n,a){var l=this&&this.__decorate||function(u,v,R,D){var B,y=arguments.length,O=y<3?v:null===D?D=Object.getOwnPropertyDescriptor(v,R):D;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)O=Reflect.decorate(u,v,R,D);else for(var H=u.length-1;H>=0;H--)(B=u[H])&&(O=(y<3?B(O):y>3?B(v,R,O):B(v,R))||O);return y>3&&O&&Object.defineProperty(v,R,O),O},f=this&&this.__param||function(u,v){return function(R,D){v(R,D,u)}};Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionService=void 0;const o=a(9806),d=a(9504),e=a(456),g=a(4725),h=a(8460),i=a(844),s=a(6114),t=a(4841),r=a(511),c=a(2585),p=new RegExp("\xa0","g");let m=n.SelectionService=class extends i.Disposable{constructor(u,v,R,D,B,y,O,H,U){super(),this._element=u,this._screenElement=v,this._linkifier=R,this._bufferService=D,this._coreService=B,this._mouseService=y,this._optionsService=O,this._renderService=H,this._coreBrowserService=U,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new r.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new h.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new h.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new h.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new h.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=z=>this._handleMouseMove(z),this._mouseUpListener=z=>this._handleMouseUp(z),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(z=>this._handleTrim(z)),this.register(this._bufferService.buffers.onBufferActivate(z=>this._handleBufferActivate(z))),this.enable(),this._model=new e.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,i.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const u=this._model.finalSelectionStart,v=this._model.finalSelectionEnd;return!(!u||!v||u[0]===v[0]&&u[1]===v[1])}get selectionText(){const u=this._model.finalSelectionStart,v=this._model.finalSelectionEnd;if(!u||!v)return"";const R=this._bufferService.buffer,D=[];if(3===this._activeSelectionMode){if(u[0]===v[0])return"";const B=u[0]<v[0]?u[0]:v[0],y=u[0]<v[0]?v[0]:u[0];for(let O=u[1];O<=v[1];O++){const H=R.translateBufferLineToString(O,!0,B,y);D.push(H)}}else{D.push(R.translateBufferLineToString(u[1],!0,u[0],u[1]===v[1]?v[0]:void 0));for(let y=u[1]+1;y<=v[1]-1;y++){const O=R.lines.get(y),H=R.translateBufferLineToString(y,!0);O?.isWrapped?D[D.length-1]+=H:D.push(H)}if(u[1]!==v[1]){const y=R.lines.get(v[1]),O=R.translateBufferLineToString(v[1],!0,0,v[0]);y&&y.isWrapped?D[D.length-1]+=O:D.push(O)}}return D.map(B=>B.replace(p," ")).join(s.isWindows?"\r\n":"\n")}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(u){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),s.isLinux&&u&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:3===this._activeSelectionMode})}_isClickInSelection(u){const v=this._getMouseBufferCoords(u),R=this._model.finalSelectionStart,D=this._model.finalSelectionEnd;return!!(R&&D&&v)&&this._areCoordsInSelection(v,R,D)}isCellInSelection(u,v){const R=this._model.finalSelectionStart,D=this._model.finalSelectionEnd;return!(!R||!D)&&this._areCoordsInSelection([u,v],R,D)}_areCoordsInSelection(u,v,R){return u[1]>v[1]&&u[1]<R[1]||v[1]===R[1]&&u[1]===v[1]&&u[0]>=v[0]&&u[0]<R[0]||v[1]<R[1]&&u[1]===R[1]&&u[0]<R[0]||v[1]<R[1]&&u[1]===v[1]&&u[0]>=v[0]}_selectWordAtCursor(u,v){const R=this._linkifier.currentLink?.link?.range;if(R)return this._model.selectionStart=[R.start.x-1,R.start.y-1],this._model.selectionStartLength=(0,t.getRangeLength)(R,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const D=this._getMouseBufferCoords(u);return!!D&&(this._selectWordAt(D,v),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(u,v){this._model.clearSelection(),u=Math.max(u,0),v=Math.min(v,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,u],this._model.selectionEnd=[this._bufferService.cols,v],this.refresh(),this._onSelectionChange.fire()}_handleTrim(u){this._model.handleTrim(u)&&this.refresh()}_getMouseBufferCoords(u){const v=this._mouseService.getCoords(u,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(v)return v[0]--,v[1]--,v[1]+=this._bufferService.buffer.ydisp,v}_getMouseEventScrollAmount(u){let v=(0,o.getCoordsRelativeToElement)(this._coreBrowserService.window,u,this._screenElement)[1];const R=this._renderService.dimensions.css.canvas.height;return v>=0&&v<=R?0:(v>R&&(v-=R),v=Math.min(Math.max(v,-50),50),v/=50,v/Math.abs(v)+Math.round(14*v))}shouldForceSelection(u){return s.isMac?u.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:u.shiftKey}handleMouseDown(u){if(this._mouseDownTimeStamp=u.timeStamp,(2!==u.button||!this.hasSelection)&&0===u.button){if(!this._enabled){if(!this.shouldForceSelection(u))return;u.stopPropagation()}u.preventDefault(),this._dragScrollAmount=0,this._enabled&&u.shiftKey?this._handleIncrementalClick(u):1===u.detail?this._handleSingleClick(u):2===u.detail?this._handleDoubleClick(u):3===u.detail&&this._handleTripleClick(u),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(u){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(u))}_handleSingleClick(u){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(u)?3:0,this._model.selectionStart=this._getMouseBufferCoords(u),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const v=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);v&&v.length!==this._model.selectionStart[0]&&0===v.hasWidth(this._model.selectionStart[0])&&this._model.selectionStart[0]++}_handleDoubleClick(u){this._selectWordAtCursor(u,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(u){const v=this._getMouseBufferCoords(u);v&&(this._activeSelectionMode=2,this._selectLineAt(v[1]))}shouldColumnSelect(u){return u.altKey&&!(s.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(u){if(u.stopImmediatePropagation(),!this._model.selectionStart)return;const v=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(u),!this._model.selectionEnd)return void this.refresh(!0);2===this._activeSelectionMode?this._model.selectionEnd[0]=this._model.selectionEnd[1]<this._model.selectionStart[1]?0:this._bufferService.cols:1===this._activeSelectionMode&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(u),3!==this._activeSelectionMode&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const R=this._bufferService.buffer;if(this._model.selectionEnd[1]<R.lines.length){const D=R.lines.get(this._model.selectionEnd[1]);D&&0===D.hasWidth(this._model.selectionEnd[0])&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}v&&v[0]===this._model.selectionEnd[0]&&v[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const u=this._bufferService.buffer;this._dragScrollAmount>0?(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(u.ydisp+this._bufferService.rows,u.lines.length-1)):(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=u.ydisp),this.refresh()}}_handleMouseUp(u){const v=u.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&v<500&&u.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const R=this._mouseService.getCoords(u,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(R&&void 0!==R[0]&&void 0!==R[1]){const D=(0,d.moveToCellSequence)(R[0]-1,R[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(D,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const u=this._model.finalSelectionStart,v=this._model.finalSelectionEnd,R=!(!u||!v||u[0]===v[0]&&u[1]===v[1]);R?u&&v&&(this._oldSelectionStart&&this._oldSelectionEnd&&u[0]===this._oldSelectionStart[0]&&u[1]===this._oldSelectionStart[1]&&v[0]===this._oldSelectionEnd[0]&&v[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(u,v,R)):this._oldHasSelection&&this._fireOnSelectionChange(u,v,R)}_fireOnSelectionChange(u,v,R){this._oldSelectionStart=u,this._oldSelectionEnd=v,this._oldHasSelection=R,this._onSelectionChange.fire()}_handleBufferActivate(u){this.clearSelection(),this._trimListener.dispose(),this._trimListener=u.activeBuffer.lines.onTrim(v=>this._handleTrim(v))}_convertViewportColToCharacterIndex(u,v){let R=v;for(let D=0;v>=D;D++){const B=u.loadCell(D,this._workCell).getChars().length;0===this._workCell.getWidth()?R--:B>1&&v!==D&&(R+=B-1)}return R}setSelection(u,v,R){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[u,v],this._model.selectionStartLength=R,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(u){this._isClickInSelection(u)||(this._selectWordAtCursor(u,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(u,v,R=!0,D=!0){if(u[0]>=this._bufferService.cols)return;const B=this._bufferService.buffer,y=B.lines.get(u[1]);if(!y)return;const O=B.translateBufferLineToString(u[1],!1);let H=this._convertViewportColToCharacterIndex(y,u[0]),U=H;const z=u[0]-H;let $=0,S=0,w=0,x=0;if(" "===O.charAt(H)){for(;H>0&&" "===O.charAt(H-1);)H--;for(;U<O.length&&" "===O.charAt(U+1);)U++}else{let j=u[0],q=u[0];0===y.getWidth(j)&&($++,j--),2===y.getWidth(q)&&(S++,q++);const Y=y.getString(q).length;for(Y>1&&(x+=Y-1,U+=Y-1);j>0&&H>0&&!this._isCharWordSeparator(y.loadCell(j-1,this._workCell));){y.loadCell(j-1,this._workCell);const M=this._workCell.getChars().length;0===this._workCell.getWidth()?($++,j--):M>1&&(w+=M-1,H-=M-1),H--,j--}for(;q<y.length&&U+1<O.length&&!this._isCharWordSeparator(y.loadCell(q+1,this._workCell));){y.loadCell(q+1,this._workCell);const M=this._workCell.getChars().length;2===this._workCell.getWidth()?(S++,q++):M>1&&(x+=M-1,U+=M-1),U++,q++}}U++;let T=H+z-$+w,F=Math.min(this._bufferService.cols,U-H+$+S-w-x);if(v||""!==O.slice(H,U).trim()){if(R&&0===T&&32!==y.getCodePoint(0)){const j=B.lines.get(u[1]-1);if(j&&y.isWrapped&&32!==j.getCodePoint(this._bufferService.cols-1)){const q=this._getWordAt([this._bufferService.cols-1,u[1]-1],!1,!0,!1);if(q){const Y=this._bufferService.cols-q.start;T-=Y,F+=Y}}}if(D&&T+F===this._bufferService.cols&&32!==y.getCodePoint(this._bufferService.cols-1)){const j=B.lines.get(u[1]+1);if(j?.isWrapped&&32!==j.getCodePoint(0)){const q=this._getWordAt([0,u[1]+1],!1,!1,!0);q&&(F+=q.length)}}return{start:T,length:F}}}_selectWordAt(u,v){const R=this._getWordAt(u,v);if(R){for(;R.start<0;)R.start+=this._bufferService.cols,u[1]--;this._model.selectionStart=[R.start,u[1]],this._model.selectionStartLength=R.length}}_selectToWordAt(u){const v=this._getWordAt(u,!0);if(v){let R=u[1];for(;v.start<0;)v.start+=this._bufferService.cols,R--;if(!this._model.areSelectionValuesReversed())for(;v.start+v.length>this._bufferService.cols;)v.length-=this._bufferService.cols,R++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?v.start:v.start+v.length,R]}}_isCharWordSeparator(u){return 0!==u.getWidth()&&this._optionsService.rawOptions.wordSeparator.indexOf(u.getChars())>=0}_selectLineAt(u){const v=this._bufferService.buffer.getWrappedRangeForLine(u),R={start:{x:0,y:v.first},end:{x:this._bufferService.cols-1,y:v.last}};this._model.selectionStart=[0,v.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,t.getRangeLength)(R,this._bufferService.cols)}};n.SelectionService=m=l([f(3,c.IBufferService),f(4,c.ICoreService),f(5,g.IMouseService),f(6,c.IOptionsService),f(7,g.IRenderService),f(8,g.ICoreBrowserService)],m)},4725:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ILinkProviderService=n.IThemeService=n.ICharacterJoinerService=n.ISelectionService=n.IRenderService=n.IMouseService=n.ICoreBrowserService=n.ICharSizeService=void 0;const l=a(8343);n.ICharSizeService=(0,l.createDecorator)("CharSizeService"),n.ICoreBrowserService=(0,l.createDecorator)("CoreBrowserService"),n.IMouseService=(0,l.createDecorator)("MouseService"),n.IRenderService=(0,l.createDecorator)("RenderService"),n.ISelectionService=(0,l.createDecorator)("SelectionService"),n.ICharacterJoinerService=(0,l.createDecorator)("CharacterJoinerService"),n.IThemeService=(0,l.createDecorator)("ThemeService"),n.ILinkProviderService=(0,l.createDecorator)("LinkProviderService")},6731:function(I,n,a){var l=this&&this.__decorate||function(m,u,v,R){var D,B=arguments.length,y=B<3?u:null===R?R=Object.getOwnPropertyDescriptor(u,v):R;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)y=Reflect.decorate(m,u,v,R);else for(var O=m.length-1;O>=0;O--)(D=m[O])&&(y=(B<3?D(y):B>3?D(u,v,y):D(u,v))||y);return B>3&&y&&Object.defineProperty(u,v,y),y},f=this&&this.__param||function(m,u){return function(v,R){u(v,R,m)}};Object.defineProperty(n,"__esModule",{value:!0}),n.ThemeService=n.DEFAULT_ANSI_COLORS=void 0;const o=a(7239),d=a(8055),e=a(8460),g=a(844),h=a(2585),i=d.css.toColor("#ffffff"),s=d.css.toColor("#000000"),t=d.css.toColor("#ffffff"),r=d.css.toColor("#000000"),c={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};n.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const m=[d.css.toColor("#2e3436"),d.css.toColor("#cc0000"),d.css.toColor("#4e9a06"),d.css.toColor("#c4a000"),d.css.toColor("#3465a4"),d.css.toColor("#75507b"),d.css.toColor("#06989a"),d.css.toColor("#d3d7cf"),d.css.toColor("#555753"),d.css.toColor("#ef2929"),d.css.toColor("#8ae234"),d.css.toColor("#fce94f"),d.css.toColor("#729fcf"),d.css.toColor("#ad7fa8"),d.css.toColor("#34e2e2"),d.css.toColor("#eeeeec")],u=[0,95,135,175,215,255];for(let v=0;v<216;v++){const R=u[v/36%6|0],D=u[v/6%6|0],B=u[v%6];m.push({css:d.channels.toCss(R,D,B),rgba:d.channels.toRgba(R,D,B)})}for(let v=0;v<24;v++){const R=8+10*v;m.push({css:d.channels.toCss(R,R,R),rgba:d.channels.toRgba(R,R,R)})}return m})());let _=n.ThemeService=class extends g.Disposable{get colors(){return this._colors}constructor(m){super(),this._optionsService=m,this._contrastCache=new o.ColorContrastCache,this._halfContrastCache=new o.ColorContrastCache,this._onChangeColors=this.register(new e.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:i,background:s,cursor:t,cursorAccent:r,selectionForeground:void 0,selectionBackgroundTransparent:c,selectionBackgroundOpaque:d.color.blend(s,c),selectionInactiveBackgroundTransparent:c,selectionInactiveBackgroundOpaque:d.color.blend(s,c),ansi:n.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(m={}){const u=this._colors;if(u.foreground=p(m.foreground,i),u.background=p(m.background,s),u.cursor=p(m.cursor,t),u.cursorAccent=p(m.cursorAccent,r),u.selectionBackgroundTransparent=p(m.selectionBackground,c),u.selectionBackgroundOpaque=d.color.blend(u.background,u.selectionBackgroundTransparent),u.selectionInactiveBackgroundTransparent=p(m.selectionInactiveBackground,u.selectionBackgroundTransparent),u.selectionInactiveBackgroundOpaque=d.color.blend(u.background,u.selectionInactiveBackgroundTransparent),u.selectionForeground=m.selectionForeground?p(m.selectionForeground,d.NULL_COLOR):void 0,u.selectionForeground===d.NULL_COLOR&&(u.selectionForeground=void 0),d.color.isOpaque(u.selectionBackgroundTransparent)&&(u.selectionBackgroundTransparent=d.color.opacity(u.selectionBackgroundTransparent,.3)),d.color.isOpaque(u.selectionInactiveBackgroundTransparent)&&(u.selectionInactiveBackgroundTransparent=d.color.opacity(u.selectionInactiveBackgroundTransparent,.3)),u.ansi=n.DEFAULT_ANSI_COLORS.slice(),u.ansi[0]=p(m.black,n.DEFAULT_ANSI_COLORS[0]),u.ansi[1]=p(m.red,n.DEFAULT_ANSI_COLORS[1]),u.ansi[2]=p(m.green,n.DEFAULT_ANSI_COLORS[2]),u.ansi[3]=p(m.yellow,n.DEFAULT_ANSI_COLORS[3]),u.ansi[4]=p(m.blue,n.DEFAULT_ANSI_COLORS[4]),u.ansi[5]=p(m.magenta,n.DEFAULT_ANSI_COLORS[5]),u.ansi[6]=p(m.cyan,n.DEFAULT_ANSI_COLORS[6]),u.ansi[7]=p(m.white,n.DEFAULT_ANSI_COLORS[7]),u.ansi[8]=p(m.brightBlack,n.DEFAULT_ANSI_COLORS[8]),u.ansi[9]=p(m.brightRed,n.DEFAULT_ANSI_COLORS[9]),u.ansi[10]=p(m.brightGreen,n.DEFAULT_ANSI_COLORS[10]),u.ansi[11]=p(m.brightYellow,n.DEFAULT_ANSI_COLORS[11]),u.ansi[12]=p(m.brightBlue,n.DEFAULT_ANSI_COLORS[12]),u.ansi[13]=p(m.brightMagenta,n.DEFAULT_ANSI_COLORS[13]),u.ansi[14]=p(m.brightCyan,n.DEFAULT_ANSI_COLORS[14]),u.ansi[15]=p(m.brightWhite,n.DEFAULT_ANSI_COLORS[15]),m.extendedAnsi){const v=Math.min(u.ansi.length-16,m.extendedAnsi.length);for(let R=0;R<v;R++)u.ansi[R+16]=p(m.extendedAnsi[R],n.DEFAULT_ANSI_COLORS[R+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(m){this._restoreColor(m),this._onChangeColors.fire(this.colors)}_restoreColor(m){if(void 0!==m)switch(m){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[m]=this._restoreColors.ansi[m]}else for(let u=0;u<this._restoreColors.ansi.length;++u)this._colors.ansi[u]=this._restoreColors.ansi[u]}modifyColors(m){m(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function p(m,u){if(void 0!==m)try{return d.css.toColor(m)}catch{}return u}n.ThemeService=_=l([f(0,h.IOptionsService)],_)},6349:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CircularList=void 0;const l=a(8460),f=a(844);n.CircularList=class o extends f.Disposable{constructor(e){super(),this._maxLength=e,this.onDeleteEmitter=this.register(new l.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new l.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new l.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(e){if(this._maxLength===e)return;const g=new Array(e);for(let h=0;h<Math.min(e,this.length);h++)g[h]=this._array[this._getCyclicIndex(h)];this._array=g,this._maxLength=e,this._startIndex=0}get length(){return this._length}set length(e){if(e>this._length)for(let g=this._length;g<e;g++)this._array[g]=void 0;this._length=e}get(e){return this._array[this._getCyclicIndex(e)]}set(e,g){this._array[this._getCyclicIndex(e)]=g}push(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(e,g,...h){if(g){for(let i=e;i<this._length-g;i++)this._array[this._getCyclicIndex(i)]=this._array[this._getCyclicIndex(i+g)];this._length-=g,this.onDeleteEmitter.fire({index:e,amount:g})}for(let i=this._length-1;i>=e;i--)this._array[this._getCyclicIndex(i+h.length)]=this._array[this._getCyclicIndex(i)];for(let i=0;i<h.length;i++)this._array[this._getCyclicIndex(e+i)]=h[i];if(h.length&&this.onInsertEmitter.fire({index:e,amount:h.length}),this._length+h.length>this._maxLength){const i=this._length+h.length-this._maxLength;this._startIndex+=i,this._length=this._maxLength,this.onTrimEmitter.fire(i)}else this._length+=h.length}trimStart(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)}shiftElements(e,g,h){if(!(g<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+h<0)throw new Error("Cannot shift elements in list beyond index 0");if(h>0){for(let s=g-1;s>=0;s--)this.set(e+s+h,this.get(e+s));const i=e+g+h-this._length;if(i>0)for(this._length+=i;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let i=0;i<g;i++)this.set(e+i+h,this.get(e+i))}}_getCyclicIndex(e){return(this._startIndex+e)%this._maxLength}}},1439:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.clone=void 0,n.clone=function a(l,f=5){if("object"!=typeof l)return l;const o=Array.isArray(l)?[]:{};for(const d in l)o[d]=f<=1?l[d]:l[d]&&a(l[d],f-1);return o}},8055:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.contrastRatio=n.toPaddedHex=n.rgba=n.rgb=n.css=n.color=n.channels=n.NULL_COLOR=void 0;let a=0,l=0,f=0,o=0;var d,e,g,h,i,r;function s(r){const c=r.toString(16);return c.length<2?"0"+c:c}function t(r,c){return r<c?(c+.05)/(r+.05):(r+.05)/(c+.05)}n.NULL_COLOR={css:"#00000000",rgba:0},(r=d||(n.channels=d={})).toCss=function(c,_,p,m){return void 0!==m?`#${s(c)}${s(_)}${s(p)}${s(m)}`:`#${s(c)}${s(_)}${s(p)}`},r.toRgba=function(c,_,p,m=255){return(c<<24|_<<16|p<<8|m)>>>0},r.toColor=function(c,_,p,m){return{css:r.toCss(c,_,p,m),rgba:r.toRgba(c,_,p,m)}},function(r){function c(_,p){return o=Math.round(255*p),[a,l,f]=i.toChannels(_.rgba),{css:d.toCss(a,l,f,o),rgba:d.toRgba(a,l,f,o)}}r.blend=function(_,p){if(o=(255&p.rgba)/255,1===o)return{css:p.css,rgba:p.rgba};const u=p.rgba>>16&255,v=p.rgba>>8&255,R=_.rgba>>24&255,D=_.rgba>>16&255,B=_.rgba>>8&255;return a=R+Math.round(((p.rgba>>24&255)-R)*o),l=D+Math.round((u-D)*o),f=B+Math.round((v-B)*o),{css:d.toCss(a,l,f),rgba:d.toRgba(a,l,f)}},r.isOpaque=function(_){return!(255&~_.rgba)},r.ensureContrastRatio=function(_,p,m){const u=i.ensureContrastRatio(_.rgba,p.rgba,m);if(u)return d.toColor(u>>24&255,u>>16&255,u>>8&255)},r.opaque=function(_){const p=(255|_.rgba)>>>0;return[a,l,f]=i.toChannels(p),{css:d.toCss(a,l,f),rgba:p}},r.opacity=c,r.multiplyOpacity=function(_,p){return o=255&_.rgba,c(_,o*p/255)},r.toColorRGB=function(_){return[_.rgba>>24&255,_.rgba>>16&255,_.rgba>>8&255]}}(e||(n.color=e={})),function(r){let c,_;try{const p=document.createElement("canvas");p.width=1,p.height=1;const m=p.getContext("2d",{willReadFrequently:!0});m&&(c=m,c.globalCompositeOperation="copy",_=c.createLinearGradient(0,0,1,1))}catch{}r.toColor=function(p){if(p.match(/#[\da-f]{3,8}/i))switch(p.length){case 4:return a=parseInt(p.slice(1,2).repeat(2),16),l=parseInt(p.slice(2,3).repeat(2),16),f=parseInt(p.slice(3,4).repeat(2),16),d.toColor(a,l,f);case 5:return a=parseInt(p.slice(1,2).repeat(2),16),l=parseInt(p.slice(2,3).repeat(2),16),f=parseInt(p.slice(3,4).repeat(2),16),o=parseInt(p.slice(4,5).repeat(2),16),d.toColor(a,l,f,o);case 7:return{css:p,rgba:(parseInt(p.slice(1),16)<<8|255)>>>0};case 9:return{css:p,rgba:parseInt(p.slice(1),16)>>>0}}const m=p.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(m)return a=parseInt(m[1]),l=parseInt(m[2]),f=parseInt(m[3]),o=Math.round(255*(void 0===m[5]?1:parseFloat(m[5]))),d.toColor(a,l,f,o);if(!c||!_)throw new Error("css.toColor: Unsupported css format");if(c.fillStyle=_,c.fillStyle=p,"string"!=typeof c.fillStyle)throw new Error("css.toColor: Unsupported css format");if(c.fillRect(0,0,1,1),[a,l,f,o]=c.getImageData(0,0,1,1).data,255!==o)throw new Error("css.toColor: Unsupported css format");return{rgba:d.toRgba(a,l,f,o),css:p}}}(g||(n.css=g={})),function(r){function c(_,p,m){const u=_/255,v=p/255,R=m/255;return.2126*(u<=.03928?u/12.92:Math.pow((u+.055)/1.055,2.4))+.7152*(v<=.03928?v/12.92:Math.pow((v+.055)/1.055,2.4))+.0722*(R<=.03928?R/12.92:Math.pow((R+.055)/1.055,2.4))}r.relativeLuminance=function(_){return c(_>>16&255,_>>8&255,255&_)},r.relativeLuminance2=c}(h||(n.rgb=h={})),function(r){function c(p,m,u){const v=p>>24&255,R=p>>16&255,D=p>>8&255;let B=m>>24&255,y=m>>16&255,O=m>>8&255,H=t(h.relativeLuminance2(B,y,O),h.relativeLuminance2(v,R,D));for(;H<u&&(B>0||y>0||O>0);)B-=Math.max(0,Math.ceil(.1*B)),y-=Math.max(0,Math.ceil(.1*y)),O-=Math.max(0,Math.ceil(.1*O)),H=t(h.relativeLuminance2(B,y,O),h.relativeLuminance2(v,R,D));return(B<<24|y<<16|O<<8|255)>>>0}function _(p,m,u){const v=p>>24&255,R=p>>16&255,D=p>>8&255;let B=m>>24&255,y=m>>16&255,O=m>>8&255,H=t(h.relativeLuminance2(B,y,O),h.relativeLuminance2(v,R,D));for(;H<u&&(B<255||y<255||O<255);)B=Math.min(255,B+Math.ceil(.1*(255-B))),y=Math.min(255,y+Math.ceil(.1*(255-y))),O=Math.min(255,O+Math.ceil(.1*(255-O))),H=t(h.relativeLuminance2(B,y,O),h.relativeLuminance2(v,R,D));return(B<<24|y<<16|O<<8|255)>>>0}r.blend=function(p,m){if(o=(255&m)/255,1===o)return m;const v=m>>16&255,R=m>>8&255,D=p>>24&255,B=p>>16&255,y=p>>8&255;return a=D+Math.round(((m>>24&255)-D)*o),l=B+Math.round((v-B)*o),f=y+Math.round((R-y)*o),d.toRgba(a,l,f)},r.ensureContrastRatio=function(p,m,u){const v=h.relativeLuminance(p>>8),R=h.relativeLuminance(m>>8);if(t(v,R)<u){if(R<v){const y=c(p,m,u),O=t(v,h.relativeLuminance(y>>8));if(O<u){const H=_(p,m,u);return O>t(v,h.relativeLuminance(H>>8))?y:H}return y}const D=_(p,m,u),B=t(v,h.relativeLuminance(D>>8));if(B<u){const y=c(p,m,u);return B>t(v,h.relativeLuminance(y>>8))?D:y}return D}},r.reduceLuminance=c,r.increaseLuminance=_,r.toChannels=function(p){return[p>>24&255,p>>16&255,p>>8&255,255&p]}}(i||(n.rgba=i={})),n.toPaddedHex=s,n.contrastRatio=t},8969:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CoreTerminal=void 0;const l=a(844),f=a(2585),o=a(4348),d=a(7866),e=a(744),g=a(7302),h=a(6975),i=a(8460),s=a(1753),t=a(1480),r=a(7994),c=a(9282),_=a(5435),p=a(5981),m=a(2660);let u=!1;n.CoreTerminal=class v extends l.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new i.EventEmitter),this._onScroll.event(D=>{this._onScrollApi?.fire(D.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(D){for(const B in D)this.optionsService.options[B]=D[B]}constructor(D){super(),this._windowsWrappingHeuristics=this.register(new l.MutableDisposable),this._onBinary=this.register(new i.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new i.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new i.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new i.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new i.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new i.EventEmitter),this._instantiationService=new o.InstantiationService,this.optionsService=this.register(new g.OptionsService(D)),this._instantiationService.setService(f.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(e.BufferService)),this._instantiationService.setService(f.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(d.LogService)),this._instantiationService.setService(f.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(h.CoreService)),this._instantiationService.setService(f.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(s.CoreMouseService)),this._instantiationService.setService(f.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(t.UnicodeService)),this._instantiationService.setService(f.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(r.CharsetService),this._instantiationService.setService(f.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(m.OscLinkService),this._instantiationService.setService(f.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new _.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,i.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,i.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,i.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,i.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(B=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(B=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new p.WriteBuffer((B,y)=>this._inputHandler.parse(B,y))),this.register((0,i.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(D,B){this._writeBuffer.write(D,B)}writeSync(D,B){this._logService.logLevel<=f.LogLevelEnum.WARN&&!u&&(this._logService.warn("writeSync is unreliable and will be removed soon."),u=!0),this._writeBuffer.writeSync(D,B)}input(D,B=!0){this.coreService.triggerDataEvent(D,B)}resize(D,B){isNaN(D)||isNaN(B)||(D=Math.max(D,e.MINIMUM_COLS),B=Math.max(B,e.MINIMUM_ROWS),this._bufferService.resize(D,B))}scroll(D,B=!1){this._bufferService.scroll(D,B)}scrollLines(D,B,y){this._bufferService.scrollLines(D,B,y)}scrollPages(D){this.scrollLines(D*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(D){const B=D-this._bufferService.buffer.ydisp;0!==B&&this.scrollLines(B)}registerEscHandler(D,B){return this._inputHandler.registerEscHandler(D,B)}registerDcsHandler(D,B){return this._inputHandler.registerDcsHandler(D,B)}registerCsiHandler(D,B){return this._inputHandler.registerCsiHandler(D,B)}registerOscHandler(D,B){return this._inputHandler.registerOscHandler(D,B)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let D=!1;const B=this.optionsService.rawOptions.windowsPty;B&&void 0!==B.buildNumber&&void 0!==B.buildNumber?D="conpty"===B.backend&&B.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(D=!0),D?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const D=[];D.push(this.onLineFeed(c.updateWindowsModeWrappedState.bind(null,this._bufferService))),D.push(this.registerCsiHandler({final:"H"},()=>((0,c.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,l.toDisposable)(()=>{for(const B of D)B.dispose()})}}}},8460:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.runAndSubscribe=n.forwardEvent=n.EventEmitter=void 0,n.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=a=>(this._listeners.push(a),{dispose:()=>{if(!this._disposed)for(let l=0;l<this._listeners.length;l++)if(this._listeners[l]===a)return void this._listeners.splice(l,1)}})),this._event}fire(a,l){const f=[];for(let o=0;o<this._listeners.length;o++)f.push(this._listeners[o]);for(let o=0;o<f.length;o++)f[o].call(void 0,a,l)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},n.forwardEvent=function(a,l){return a(f=>l.fire(f))},n.runAndSubscribe=function(a,l){return l(void 0),a(f=>l(f))}},5435:function(I,n,a){var l=this&&this.__decorate||function($,S,w,x){var T,F=arguments.length,j=F<3?S:null===x?x=Object.getOwnPropertyDescriptor(S,w):x;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)j=Reflect.decorate($,S,w,x);else for(var q=$.length-1;q>=0;q--)(T=$[q])&&(j=(F<3?T(j):F>3?T(S,w,j):T(S,w))||j);return F>3&&j&&Object.defineProperty(S,w,j),j},f=this&&this.__param||function($,S){return function(w,x){S(w,x,$)}};Object.defineProperty(n,"__esModule",{value:!0}),n.InputHandler=n.WindowsOptionsReportType=void 0;const o=a(2584),d=a(7116),e=a(2015),g=a(844),h=a(482),i=a(8437),s=a(8460),t=a(643),r=a(511),c=a(3734),_=a(2585),p=a(1480),m=a(6242),u=a(6351),v=a(5941),R={"(":0,")":1,"*":2,"+":3,"-":1,".":2},D=131072;function B($,S){if($>24)return S.setWinLines||!1;switch($){case 1:return!!S.restoreWin;case 2:return!!S.minimizeWin;case 3:return!!S.setWinPosition;case 4:return!!S.setWinSizePixels;case 5:return!!S.raiseWin;case 6:return!!S.lowerWin;case 7:return!!S.refreshWin;case 8:return!!S.setWinSizeChars;case 9:return!!S.maximizeWin;case 10:return!!S.fullscreenWin;case 11:return!!S.getWinState;case 13:return!!S.getWinPosition;case 14:return!!S.getWinSizePixels;case 15:return!!S.getScreenSizePixels;case 16:return!!S.getCellSizePixels;case 18:return!!S.getWinSizeChars;case 19:return!!S.getScreenSizeChars;case 20:return!!S.getIconTitle;case 21:return!!S.getWinTitle;case 22:return!!S.pushTitle;case 23:return!!S.popTitle;case 24:return!!S.setWinLines}return!1}var y,$;($=y||(n.WindowsOptionsReportType=y={}))[$.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",$[$.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS";let O=0;n.InputHandler=class H extends g.Disposable{getAttrData(){return this._curAttrData}constructor(S,w,x,T,F,j,q,Y,M=new e.EscapeSequenceParser){super(),this._bufferService=S,this._charsetService=w,this._coreService=x,this._logService=T,this._optionsService=F,this._oscLinkService=j,this._coreMouseService=q,this._unicodeService=Y,this._parser=M,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new h.StringToUtf32,this._utf8Decoder=new h.Utf8ToUtf32,this._workCell=new r.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=i.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new s.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new s.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new s.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new s.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new s.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new s.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new s.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new s.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new s.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new s.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new s.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new s.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new s.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new U(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(b=>this._activeBuffer=b.activeBuffer)),this._parser.setCsiHandlerFallback((b,P)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(b),params:P.toArray()})}),this._parser.setEscHandlerFallback(b=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(b)})}),this._parser.setExecuteHandlerFallback(b=>{this._logService.debug("Unknown EXECUTE code: ",{code:b})}),this._parser.setOscHandlerFallback((b,P,N)=>{this._logService.debug("Unknown OSC code: ",{identifier:b,action:P,data:N})}),this._parser.setDcsHandlerFallback((b,P,N)=>{"HOOK"===P&&(N=N.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(b),action:P,payload:N})}),this._parser.setPrintHandler((b,P,N)=>this.print(b,P,N)),this._parser.registerCsiHandler({final:"@"},b=>this.insertChars(b)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},b=>this.scrollLeft(b)),this._parser.registerCsiHandler({final:"A"},b=>this.cursorUp(b)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},b=>this.scrollRight(b)),this._parser.registerCsiHandler({final:"B"},b=>this.cursorDown(b)),this._parser.registerCsiHandler({final:"C"},b=>this.cursorForward(b)),this._parser.registerCsiHandler({final:"D"},b=>this.cursorBackward(b)),this._parser.registerCsiHandler({final:"E"},b=>this.cursorNextLine(b)),this._parser.registerCsiHandler({final:"F"},b=>this.cursorPrecedingLine(b)),this._parser.registerCsiHandler({final:"G"},b=>this.cursorCharAbsolute(b)),this._parser.registerCsiHandler({final:"H"},b=>this.cursorPosition(b)),this._parser.registerCsiHandler({final:"I"},b=>this.cursorForwardTab(b)),this._parser.registerCsiHandler({final:"J"},b=>this.eraseInDisplay(b,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},b=>this.eraseInDisplay(b,!0)),this._parser.registerCsiHandler({final:"K"},b=>this.eraseInLine(b,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},b=>this.eraseInLine(b,!0)),this._parser.registerCsiHandler({final:"L"},b=>this.insertLines(b)),this._parser.registerCsiHandler({final:"M"},b=>this.deleteLines(b)),this._parser.registerCsiHandler({final:"P"},b=>this.deleteChars(b)),this._parser.registerCsiHandler({final:"S"},b=>this.scrollUp(b)),this._parser.registerCsiHandler({final:"T"},b=>this.scrollDown(b)),this._parser.registerCsiHandler({final:"X"},b=>this.eraseChars(b)),this._parser.registerCsiHandler({final:"Z"},b=>this.cursorBackwardTab(b)),this._parser.registerCsiHandler({final:"`"},b=>this.charPosAbsolute(b)),this._parser.registerCsiHandler({final:"a"},b=>this.hPositionRelative(b)),this._parser.registerCsiHandler({final:"b"},b=>this.repeatPrecedingCharacter(b)),this._parser.registerCsiHandler({final:"c"},b=>this.sendDeviceAttributesPrimary(b)),this._parser.registerCsiHandler({prefix:">",final:"c"},b=>this.sendDeviceAttributesSecondary(b)),this._parser.registerCsiHandler({final:"d"},b=>this.linePosAbsolute(b)),this._parser.registerCsiHandler({final:"e"},b=>this.vPositionRelative(b)),this._parser.registerCsiHandler({final:"f"},b=>this.hVPosition(b)),this._parser.registerCsiHandler({final:"g"},b=>this.tabClear(b)),this._parser.registerCsiHandler({final:"h"},b=>this.setMode(b)),this._parser.registerCsiHandler({prefix:"?",final:"h"},b=>this.setModePrivate(b)),this._parser.registerCsiHandler({final:"l"},b=>this.resetMode(b)),this._parser.registerCsiHandler({prefix:"?",final:"l"},b=>this.resetModePrivate(b)),this._parser.registerCsiHandler({final:"m"},b=>this.charAttributes(b)),this._parser.registerCsiHandler({final:"n"},b=>this.deviceStatus(b)),this._parser.registerCsiHandler({prefix:"?",final:"n"},b=>this.deviceStatusPrivate(b)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},b=>this.softReset(b)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},b=>this.setCursorStyle(b)),this._parser.registerCsiHandler({final:"r"},b=>this.setScrollRegion(b)),this._parser.registerCsiHandler({final:"s"},b=>this.saveCursor(b)),this._parser.registerCsiHandler({final:"t"},b=>this.windowOptions(b)),this._parser.registerCsiHandler({final:"u"},b=>this.restoreCursor(b)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},b=>this.insertColumns(b)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},b=>this.deleteColumns(b)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},b=>this.selectProtected(b)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},b=>this.requestMode(b,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},b=>this.requestMode(b,!1)),this._parser.setExecuteHandler(o.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(o.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(o.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(o.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(o.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(o.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(o.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(o.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(o.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(o.C1.IND,()=>this.index()),this._parser.setExecuteHandler(o.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(o.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new m.OscHandler(b=>(this.setTitle(b),this.setIconName(b),!0))),this._parser.registerOscHandler(1,new m.OscHandler(b=>this.setIconName(b))),this._parser.registerOscHandler(2,new m.OscHandler(b=>this.setTitle(b))),this._parser.registerOscHandler(4,new m.OscHandler(b=>this.setOrReportIndexedColor(b))),this._parser.registerOscHandler(8,new m.OscHandler(b=>this.setHyperlink(b))),this._parser.registerOscHandler(10,new m.OscHandler(b=>this.setOrReportFgColor(b))),this._parser.registerOscHandler(11,new m.OscHandler(b=>this.setOrReportBgColor(b))),this._parser.registerOscHandler(12,new m.OscHandler(b=>this.setOrReportCursorColor(b))),this._parser.registerOscHandler(104,new m.OscHandler(b=>this.restoreIndexedColor(b))),this._parser.registerOscHandler(110,new m.OscHandler(b=>this.restoreFgColor(b))),this._parser.registerOscHandler(111,new m.OscHandler(b=>this.restoreBgColor(b))),this._parser.registerOscHandler(112,new m.OscHandler(b=>this.restoreCursorColor(b))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const b in d.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:b},()=>this.selectCharset("("+b)),this._parser.registerEscHandler({intermediates:")",final:b},()=>this.selectCharset(")"+b)),this._parser.registerEscHandler({intermediates:"*",final:b},()=>this.selectCharset("*"+b)),this._parser.registerEscHandler({intermediates:"+",final:b},()=>this.selectCharset("+"+b)),this._parser.registerEscHandler({intermediates:"-",final:b},()=>this.selectCharset("-"+b)),this._parser.registerEscHandler({intermediates:".",final:b},()=>this.selectCharset("."+b)),this._parser.registerEscHandler({intermediates:"/",final:b},()=>this.selectCharset("/"+b));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(b=>(this._logService.error("Parsing error: ",b),b)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new u.DcsHandler((b,P)=>this.requestStatusString(b,P)))}_preserveStack(S,w,x,T){this._parseStack.paused=!0,this._parseStack.cursorStartX=S,this._parseStack.cursorStartY=w,this._parseStack.decodedLength=x,this._parseStack.position=T}_logSlowResolvingAsync(S){this._logService.logLevel<=_.LogLevelEnum.WARN&&Promise.race([S,new Promise((w,x)=>setTimeout(()=>x("#SLOW_TIMEOUT"),5e3))]).catch(w=>{if("#SLOW_TIMEOUT"!==w)throw w;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(S,w){let x,T=this._activeBuffer.x,F=this._activeBuffer.y,j=0;const q=this._parseStack.paused;if(q){if(x=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,w))return this._logSlowResolvingAsync(x),x;T=this._parseStack.cursorStartX,F=this._parseStack.cursorStartY,this._parseStack.paused=!1,S.length>D&&(j=this._parseStack.position+D)}if(this._logService.logLevel<=_.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+("string"==typeof S?` "${S}"`:` "${Array.prototype.map.call(S,b=>String.fromCharCode(b)).join("")}"`),"string"==typeof S?S.split("").map(b=>b.charCodeAt(0)):S),this._parseBuffer.length<S.length&&this._parseBuffer.length<D&&(this._parseBuffer=new Uint32Array(Math.min(S.length,D))),q||this._dirtyRowTracker.clearRange(),S.length>D)for(let b=j;b<S.length;b+=D){const P=b+D<S.length?b+D:S.length,N="string"==typeof S?this._stringDecoder.decode(S.substring(b,P),this._parseBuffer):this._utf8Decoder.decode(S.subarray(b,P),this._parseBuffer);if(x=this._parser.parse(this._parseBuffer,N))return this._preserveStack(T,F,N,b),this._logSlowResolvingAsync(x),x}else if(!q){const b="string"==typeof S?this._stringDecoder.decode(S,this._parseBuffer):this._utf8Decoder.decode(S,this._parseBuffer);if(x=this._parser.parse(this._parseBuffer,b))return this._preserveStack(T,F,b,0),this._logSlowResolvingAsync(x),x}this._activeBuffer.x===T&&this._activeBuffer.y===F||this._onCursorMove.fire();const Y=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),M=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);M<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(M,this._bufferService.rows-1),Math.min(Y,this._bufferService.rows-1))}print(S,w,x){let T,F;const j=this._charsetService.charset,q=this._optionsService.rawOptions.screenReaderMode,Y=this._bufferService.cols,M=this._coreService.decPrivateModes.wraparound,b=this._coreService.modes.insertMode,P=this._curAttrData;let N=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&x-w>0&&2===N.getWidth(this._activeBuffer.x-1)&&N.setCellFromCodepoint(this._activeBuffer.x-1,0,1,P);let V=this._parser.precedingJoinState;for(let G=w;G<x;++G){if(T=S[G],T<127&&j){const ne=j[String.fromCharCode(T)];ne&&(T=ne.charCodeAt(0))}const Q=this._unicodeService.charProperties(T,V);F=p.UnicodeService.extractWidth(Q);const ie=p.UnicodeService.extractShouldJoin(Q),re=ie?p.UnicodeService.extractWidth(V):0;if(V=Q,q&&this._onA11yChar.fire((0,h.stringFromCodePoint)(T)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+F-re>Y)if(M){const ne=N;let X=this._activeBuffer.x-re;for(this._activeBuffer.x=re,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),N=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),re>0&&N instanceof i.BufferLine&&N.copyCellsFrom(ne,X,0,re,!1);X<Y;)ne.setCellFromCodepoint(X++,0,1,P)}else if(this._activeBuffer.x=Y-1,2===F)continue;if(ie&&this._activeBuffer.x){const ne=N.getWidth(this._activeBuffer.x-1)?1:2;N.addCodepointToCell(this._activeBuffer.x-ne,T,F);for(let X=F-re;--X>=0;)N.setCellFromCodepoint(this._activeBuffer.x++,0,0,P)}else if(b&&(N.insertCells(this._activeBuffer.x,F-re,this._activeBuffer.getNullCell(P)),2===N.getWidth(Y-1)&&N.setCellFromCodepoint(Y-1,t.NULL_CELL_CODE,t.NULL_CELL_WIDTH,P)),N.setCellFromCodepoint(this._activeBuffer.x++,T,F,P),F>0)for(;--F;)N.setCellFromCodepoint(this._activeBuffer.x++,0,0,P)}this._parser.precedingJoinState=V,this._activeBuffer.x<Y&&x-w>0&&0===N.getWidth(this._activeBuffer.x)&&!N.hasContent(this._activeBuffer.x)&&N.setCellFromCodepoint(this._activeBuffer.x,0,1,P),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(S,w){return this._parser.registerCsiHandler(S,"t"!==S.final||S.prefix||S.intermediates?w:x=>!B(x.params[0],this._optionsService.rawOptions.windowOptions)||w(x))}registerDcsHandler(S,w){return this._parser.registerDcsHandler(S,new u.DcsHandler(w))}registerEscHandler(S,w){return this._parser.registerEscHandler(S,w)}registerOscHandler(S,w){return this._parser.registerOscHandler(S,new m.OscHandler(w))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(0===this._activeBuffer.x&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const S=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);S.hasWidth(this._activeBuffer.x)&&!S.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const S=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-S),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(S=this._bufferService.cols-1){this._activeBuffer.x=Math.min(S,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(S,w){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=S,this._activeBuffer.y=this._activeBuffer.scrollTop+w):(this._activeBuffer.x=S,this._activeBuffer.y=w),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(S,w){this._restrictCursor(),this._setCursor(this._activeBuffer.x+S,this._activeBuffer.y+w)}cursorUp(S){const w=this._activeBuffer.y-this._activeBuffer.scrollTop;return this._moveCursor(0,w>=0?-Math.min(w,S.params[0]||1):-(S.params[0]||1)),!0}cursorDown(S){const w=this._activeBuffer.scrollBottom-this._activeBuffer.y;return this._moveCursor(0,w>=0?Math.min(w,S.params[0]||1):S.params[0]||1),!0}cursorForward(S){return this._moveCursor(S.params[0]||1,0),!0}cursorBackward(S){return this._moveCursor(-(S.params[0]||1),0),!0}cursorNextLine(S){return this.cursorDown(S),this._activeBuffer.x=0,!0}cursorPrecedingLine(S){return this.cursorUp(S),this._activeBuffer.x=0,!0}cursorCharAbsolute(S){return this._setCursor((S.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(S){return this._setCursor(S.length>=2?(S.params[1]||1)-1:0,(S.params[0]||1)-1),!0}charPosAbsolute(S){return this._setCursor((S.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(S){return this._moveCursor(S.params[0]||1,0),!0}linePosAbsolute(S){return this._setCursor(this._activeBuffer.x,(S.params[0]||1)-1),!0}vPositionRelative(S){return this._moveCursor(0,S.params[0]||1),!0}hVPosition(S){return this.cursorPosition(S),!0}tabClear(S){const w=S.params[0];return 0===w?delete this._activeBuffer.tabs[this._activeBuffer.x]:3===w&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(S){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let w=S.params[0]||1;for(;w--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(S){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let w=S.params[0]||1;for(;w--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(S){const w=S.params[0];return 1===w&&(this._curAttrData.bg|=536870912),2!==w&&0!==w||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(S,w,x,T=!1,F=!1){const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+S);j.replaceCells(w,x,this._activeBuffer.getNullCell(this._eraseAttrData()),F),T&&(j.isWrapped=!1)}_resetBufferLine(S,w=!1){const x=this._activeBuffer.lines.get(this._activeBuffer.ybase+S);x&&(x.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),w),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+S),x.isWrapped=!1)}eraseInDisplay(S,w=!1){let x;switch(this._restrictCursor(this._bufferService.cols),S.params[0]){case 0:for(x=this._activeBuffer.y,this._dirtyRowTracker.markDirty(x),this._eraseInBufferLine(x++,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,w);x<this._bufferService.rows;x++)this._resetBufferLine(x,w);this._dirtyRowTracker.markDirty(x);break;case 1:for(x=this._activeBuffer.y,this._dirtyRowTracker.markDirty(x),this._eraseInBufferLine(x,0,this._activeBuffer.x+1,!0,w),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(x+1).isWrapped=!1);x--;)this._resetBufferLine(x,w);this._dirtyRowTracker.markDirty(0);break;case 2:for(x=this._bufferService.rows,this._dirtyRowTracker.markDirty(x-1);x--;)this._resetBufferLine(x,w);this._dirtyRowTracker.markDirty(0);break;case 3:const T=this._activeBuffer.lines.length-this._bufferService.rows;T>0&&(this._activeBuffer.lines.trimStart(T),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-T,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-T,0),this._onScroll.fire(0))}return!0}eraseInLine(S,w=!1){switch(this._restrictCursor(this._bufferService.cols),S.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x,w);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,w);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,w)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(S){this._restrictCursor();let w=S.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const x=this._activeBuffer.ybase+this._activeBuffer.y,F=this._bufferService.rows-1+this._activeBuffer.ybase-(this._bufferService.rows-1-this._activeBuffer.scrollBottom)+1;for(;w--;)this._activeBuffer.lines.splice(F-1,1),this._activeBuffer.lines.splice(x,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(S){this._restrictCursor();let w=S.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const x=this._activeBuffer.ybase+this._activeBuffer.y;let T;for(T=this._bufferService.rows-1-this._activeBuffer.scrollBottom,T=this._bufferService.rows-1+this._activeBuffer.ybase-T;w--;)this._activeBuffer.lines.splice(x,1),this._activeBuffer.lines.splice(T,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(S){this._restrictCursor();const w=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return w&&(w.insertCells(this._activeBuffer.x,S.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(S){this._restrictCursor();const w=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return w&&(w.deleteCells(this._activeBuffer.x,S.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(S){let w=S.params[0]||1;for(;w--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(S){let w=S.params[0]||1;for(;w--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(i.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(S){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const w=S.params[0]||1;for(let x=this._activeBuffer.scrollTop;x<=this._activeBuffer.scrollBottom;++x){const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);T.deleteCells(0,w,this._activeBuffer.getNullCell(this._eraseAttrData())),T.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(S){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const w=S.params[0]||1;for(let x=this._activeBuffer.scrollTop;x<=this._activeBuffer.scrollBottom;++x){const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);T.insertCells(0,w,this._activeBuffer.getNullCell(this._eraseAttrData())),T.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(S){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const w=S.params[0]||1;for(let x=this._activeBuffer.scrollTop;x<=this._activeBuffer.scrollBottom;++x){const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);T.insertCells(this._activeBuffer.x,w,this._activeBuffer.getNullCell(this._eraseAttrData())),T.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(S){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const w=S.params[0]||1;for(let x=this._activeBuffer.scrollTop;x<=this._activeBuffer.scrollBottom;++x){const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+x);T.deleteCells(this._activeBuffer.x,w,this._activeBuffer.getNullCell(this._eraseAttrData())),T.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(S){this._restrictCursor();const w=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return w&&(w.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(S.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(S){const w=this._parser.precedingJoinState;if(!w)return!0;const x=S.params[0]||1,T=p.UnicodeService.extractWidth(w),F=this._activeBuffer.x-T,j=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(F),q=new Uint32Array(j.length*x);let Y=0;for(let b=0;b<j.length;){const P=j.codePointAt(b)||0;q[Y++]=P,b+=P>65535?2:1}let M=Y;for(let b=1;b<x;++b)q.copyWithin(M,0,Y),M+=Y;return this.print(q,0,M),!0}sendDeviceAttributesPrimary(S){return S.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(o.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(o.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(S){return S.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(o.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(o.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(S.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(o.C0.ESC+"[>83;40003;0c")),!0}_is(S){return 0===(this._optionsService.rawOptions.termName+"").indexOf(S)}setMode(S){for(let w=0;w<S.length;w++)switch(S.params[w]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(S){for(let w=0;w<S.length;w++)switch(S.params[w]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),this._charsetService.setgCharset(1,d.DEFAULT_CHARSET),this._charsetService.setgCharset(2,d.DEFAULT_CHARSET),this._charsetService.setgCharset(3,d.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(S){for(let w=0;w<S.length;w++)switch(S.params[w]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(S){for(let w=0;w<S.length;w++)switch(S.params[w]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),1049===S.params[w]&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(S,w){const x=this._coreService.decPrivateModes,{activeProtocol:T,activeEncoding:F}=this._coreMouseService,j=this._coreService,{buffers:q,cols:Y}=this._bufferService,{active:M,alt:b}=q,P=this._optionsService.rawOptions,N=ie=>ie?1:2,V=S.params[0];return G=V,Q=w?2===V?4:4===V?N(j.modes.insertMode):12===V?3:20===V?N(P.convertEol):0:1===V?N(x.applicationCursorKeys):3===V?P.windowOptions.setWinLines?80===Y?2:132===Y?1:0:0:6===V?N(x.origin):7===V?N(x.wraparound):8===V?3:9===V?N("X10"===T):12===V?N(P.cursorBlink):25===V?N(!j.isCursorHidden):45===V?N(x.reverseWraparound):66===V?N(x.applicationKeypad):67===V?4:1e3===V?N("VT200"===T):1002===V?N("DRAG"===T):1003===V?N("ANY"===T):1004===V?N(x.sendFocus):1005===V?4:1006===V?N("SGR"===F):1015===V?4:1016===V?N("SGR_PIXELS"===F):1048===V?1:47===V||1047===V||1049===V?N(M===b):2004===V?N(x.bracketedPasteMode):0,j.triggerDataEvent(`${o.C0.ESC}[${w?"":"?"}${G};${Q}$y`),!0;var G,Q}_updateAttrColor(S,w,x,T,F){return 2===w?(S|=50331648,S&=-16777216,S|=c.AttributeData.fromColorRGB([x,T,F])):5===w&&(S&=-50331904,S|=33554432|255&x),S}_extractColor(S,w,x){const T=[0,0,-1,0,0,0];let F=0,j=0;do{if(T[j+F]=S.params[w+j],S.hasSubParams(w+j)){const q=S.getSubParams(w+j);let Y=0;do{5===T[1]&&(F=1),T[j+Y+1+F]=q[Y]}while(++Y<q.length&&Y+j+1+F<T.length);break}if(5===T[1]&&j+F>=2||2===T[1]&&j+F>=5)break;T[1]&&(F=1)}while(++j+w<S.length&&j+F<T.length);for(let q=2;q<T.length;++q)-1===T[q]&&(T[q]=0);switch(T[0]){case 38:x.fg=this._updateAttrColor(x.fg,T[1],T[3],T[4],T[5]);break;case 48:x.bg=this._updateAttrColor(x.bg,T[1],T[3],T[4],T[5]);break;case 58:x.extended=x.extended.clone(),x.extended.underlineColor=this._updateAttrColor(x.extended.underlineColor,T[1],T[3],T[4],T[5])}return j}_processUnderline(S,w){w.extended=w.extended.clone(),(!~S||S>5)&&(S=1),w.extended.underlineStyle=S,w.fg|=268435456,0===S&&(w.fg&=-268435457),w.updateExtended()}_processSGR0(S){S.fg=i.DEFAULT_ATTR_DATA.fg,S.bg=i.DEFAULT_ATTR_DATA.bg,S.extended=S.extended.clone(),S.extended.underlineStyle=0,S.extended.underlineColor&=-67108864,S.updateExtended()}charAttributes(S){if(1===S.length&&0===S.params[0])return this._processSGR0(this._curAttrData),!0;const w=S.length;let x;const T=this._curAttrData;for(let F=0;F<w;F++)x=S.params[F],x>=30&&x<=37?(T.fg&=-50331904,T.fg|=16777216|x-30):x>=40&&x<=47?(T.bg&=-50331904,T.bg|=16777216|x-40):x>=90&&x<=97?(T.fg&=-50331904,T.fg|=16777224|x-90):x>=100&&x<=107?(T.bg&=-50331904,T.bg|=16777224|x-100):0===x?this._processSGR0(T):1===x?T.fg|=134217728:3===x?T.bg|=67108864:4===x?(T.fg|=268435456,this._processUnderline(S.hasSubParams(F)?S.getSubParams(F)[0]:1,T)):5===x?T.fg|=536870912:7===x?T.fg|=67108864:8===x?T.fg|=1073741824:9===x?T.fg|=2147483648:2===x?T.bg|=134217728:21===x?this._processUnderline(2,T):22===x?(T.fg&=-134217729,T.bg&=-134217729):23===x?T.bg&=-67108865:24===x?(T.fg&=-268435457,this._processUnderline(0,T)):25===x?T.fg&=-536870913:27===x?T.fg&=-67108865:28===x?T.fg&=-1073741825:29===x?T.fg&=2147483647:39===x?(T.fg&=-67108864,T.fg|=16777215&i.DEFAULT_ATTR_DATA.fg):49===x?(T.bg&=-67108864,T.bg|=16777215&i.DEFAULT_ATTR_DATA.bg):38===x||48===x||58===x?F+=this._extractColor(S,F,T):53===x?T.bg|=1073741824:55===x?T.bg&=-1073741825:59===x?(T.extended=T.extended.clone(),T.extended.underlineColor=-1,T.updateExtended()):100===x?(T.fg&=-67108864,T.fg|=16777215&i.DEFAULT_ATTR_DATA.fg,T.bg&=-67108864,T.bg|=16777215&i.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",x);return!0}deviceStatus(S){switch(S.params[0]){case 5:this._coreService.triggerDataEvent(`${o.C0.ESC}[0n`);break;case 6:this._coreService.triggerDataEvent(`${o.C0.ESC}[${this._activeBuffer.y+1};${this._activeBuffer.x+1}R`)}return!0}deviceStatusPrivate(S){return 6===S.params[0]&&this._coreService.triggerDataEvent(`${o.C0.ESC}[?${this._activeBuffer.y+1};${this._activeBuffer.x+1}R`),!0}softReset(S){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(S){const w=S.params[0]||1;switch(w){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}return this._optionsService.options.cursorBlink=w%2==1,!0}setScrollRegion(S){const w=S.params[0]||1;let x;return(S.length<2||(x=S.params[1])>this._bufferService.rows||0===x)&&(x=this._bufferService.rows),x>w&&(this._activeBuffer.scrollTop=w-1,this._activeBuffer.scrollBottom=x-1,this._setCursor(0,0)),!0}windowOptions(S){if(!B(S.params[0],this._optionsService.rawOptions.windowOptions))return!0;const w=S.length>1?S.params[1]:0;switch(S.params[0]){case 14:2!==w&&this._onRequestWindowsOptionsReport.fire(y.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(y.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${o.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:0!==w&&2!==w||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),0!==w&&1!==w||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:0!==w&&2!==w||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),0!==w&&1!==w||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(S){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(S){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(S){return this._windowTitle=S,this._onTitleChange.fire(S),!0}setIconName(S){return this._iconName=S,!0}setOrReportIndexedColor(S){const w=[],x=S.split(";");for(;x.length>1;){const T=x.shift(),F=x.shift();if(/^\d+$/.exec(T)){const j=parseInt(T);if(z(j))if("?"===F)w.push({type:0,index:j});else{const q=(0,v.parseColor)(F);q&&w.push({type:1,index:j,color:q})}}}return w.length&&this._onColor.fire(w),!0}setHyperlink(S){const w=S.split(";");return!(w.length<2)&&(w[1]?this._createHyperlink(w[0],w[1]):!w[0]&&this._finishHyperlink())}_createHyperlink(S,w){this._getCurrentLinkId()&&this._finishHyperlink();const x=S.split(":");let T;const F=x.findIndex(j=>j.startsWith("id="));return-1!==F&&(T=x[F].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:T,uri:w}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(S,w){const x=S.split(";");for(let T=0;T<x.length&&!(w>=this._specialColors.length);++T,++w)if("?"===x[T])this._onColor.fire([{type:0,index:this._specialColors[w]}]);else{const F=(0,v.parseColor)(x[T]);F&&this._onColor.fire([{type:1,index:this._specialColors[w],color:F}])}return!0}setOrReportFgColor(S){return this._setOrReportSpecialColor(S,0)}setOrReportBgColor(S){return this._setOrReportSpecialColor(S,1)}setOrReportCursorColor(S){return this._setOrReportSpecialColor(S,2)}restoreIndexedColor(S){if(!S)return this._onColor.fire([{type:2}]),!0;const w=[],x=S.split(";");for(let T=0;T<x.length;++T)if(/^\d+$/.exec(x[T])){const F=parseInt(x[T]);z(F)&&w.push({type:2,index:F})}return w.length&&this._onColor.fire(w),!0}restoreFgColor(S){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(S){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(S){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),!0}selectCharset(S){return 2!==S.length?(this.selectDefaultCharset(),!0):("/"===S[0]||this._charsetService.setgCharset(R[S[0]],d.CHARSETS[S[1]]||d.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){return this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop?(this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)):(this._activeBuffer.y--,this._restrictCursor()),!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=i.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=i.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(S){return this._charsetService.setgLevel(S),!0}screenAlignmentPattern(){const S=new r.CellData;S.content=4194373,S.fg=this._curAttrData.fg,S.bg=this._curAttrData.bg,this._setCursor(0,0);for(let w=0;w<this._bufferService.rows;++w){const T=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y+w);T&&(T.fill(S),T.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(S,w){const x=this._bufferService.buffer,T=this._optionsService.rawOptions;return(F=>(this._coreService.triggerDataEvent(`${o.C0.ESC}${F}${o.C0.ESC}\\`),!0))('"q'===S?`P1$r${this._curAttrData.isProtected()?1:0}"q`:'"p'===S?'P1$r61;1"p':"r"===S?`P1$r${x.scrollTop+1};${x.scrollBottom+1}r`:"m"===S?"P1$r0m":" q"===S?`P1$r${{block:2,underline:4,bar:6}[T.cursorStyle]-(T.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(S,w){this._dirtyRowTracker.markRangeDirty(S,w)}};let U=class{constructor($){this._bufferService=$,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty($){$<this.start?this.start=$:$>this.end&&(this.end=$)}markRangeDirty($,S){$>S&&(O=$,$=S,S=O),$<this.start&&(this.start=$),S>this.end&&(this.end=S)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function z($){return 0<=$&&$<256}U=l([f(0,_.IBufferService)],U)},844:(I,n)=>{function a(l){for(const f of l)f.dispose();l.length=0}Object.defineProperty(n,"__esModule",{value:!0}),n.getDisposeArrayDisposable=n.disposeArray=n.toDisposable=n.MutableDisposable=n.Disposable=void 0,n.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const l of this._disposables)l.dispose();this._disposables.length=0}register(l){return this._disposables.push(l),l}unregister(l){const f=this._disposables.indexOf(l);-1!==f&&this._disposables.splice(f,1)}},n.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(l){this._isDisposed||l===this._value||(this._value?.dispose(),this._value=l)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},n.toDisposable=function(l){return{dispose:l}},n.disposeArray=a,n.getDisposeArrayDisposable=function(l){return{dispose:()=>a(l)}}},1505:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FourKeyMap=n.TwoKeyMap=void 0;class a{constructor(){this._data={}}set(f,o,d){this._data[f]||(this._data[f]={}),this._data[f][o]=d}get(f,o){return this._data[f]?this._data[f][o]:void 0}clear(){this._data={}}}n.TwoKeyMap=a,n.FourKeyMap=class{constructor(){this._data=new a}set(l,f,o,d,e){this._data.get(l,f)||this._data.set(l,f,new a),this._data.get(l,f).set(o,d,e)}get(l,f,o,d){return this._data.get(l,f)?.get(o,d)}clear(){this._data.clear()}}},6114:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isChromeOS=n.isLinux=n.isWindows=n.isIphone=n.isIpad=n.isMac=n.getSafariVersion=n.isSafari=n.isLegacyEdge=n.isFirefox=n.isNode=void 0,n.isNode=typeof process<"u"&&"title"in process;const a=n.isNode?"node":navigator.userAgent,l=n.isNode?"node":navigator.platform;n.isFirefox=a.includes("Firefox"),n.isLegacyEdge=a.includes("Edge"),n.isSafari=/^((?!chrome|android).)*safari/i.test(a),n.getSafariVersion=function(){if(!n.isSafari)return 0;const f=a.match(/Version\/(\d+)/);return null===f||f.length<2?0:parseInt(f[1])},n.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(l),n.isIpad="iPad"===l,n.isIphone="iPhone"===l,n.isWindows=["Windows","Win16","Win32","WinCE"].includes(l),n.isLinux=l.indexOf("Linux")>=0,n.isChromeOS=/\bCrOS\b/.test(a)},6106:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SortedList=void 0;let a=0;n.SortedList=class{constructor(l){this._getKey=l,this._array=[]}clear(){this._array.length=0}insert(l){0!==this._array.length?(a=this._search(this._getKey(l)),this._array.splice(a,0,l)):this._array.push(l)}delete(l){if(0===this._array.length)return!1;const f=this._getKey(l);if(void 0===f||(a=this._search(f),-1===a)||this._getKey(this._array[a])!==f)return!1;do{if(this._array[a]===l)return this._array.splice(a,1),!0}while(++a<this._array.length&&this._getKey(this._array[a])===f);return!1}*getKeyIterator(l){if(0!==this._array.length&&(a=this._search(l),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===l))do{yield this._array[a]}while(++a<this._array.length&&this._getKey(this._array[a])===l)}forEachByKey(l,f){if(0!==this._array.length&&(a=this._search(l),!(a<0||a>=this._array.length)&&this._getKey(this._array[a])===l))do{f(this._array[a])}while(++a<this._array.length&&this._getKey(this._array[a])===l)}values(){return[...this._array].values()}_search(l){let f=0,o=this._array.length-1;for(;o>=f;){let d=f+o>>1;const e=this._getKey(this._array[d]);if(e>l)o=d-1;else{if(!(e<l)){for(;d>0&&this._getKey(this._array[d-1])===l;)d--;return d}f=d+1}}return f}}},7226:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DebouncedIdleTask=n.IdleTaskQueue=n.PriorityTaskQueue=void 0;const l=a(6114);class f{constructor(){this._tasks=[],this._i=0}enqueue(e){this._tasks.push(e),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(e){this._idleCallback=void 0;let g=0,h=0,i=e.timeRemaining(),s=0;for(;this._i<this._tasks.length;){if(g=Date.now(),this._tasks[this._i]()||this._i++,g=Math.max(1,Date.now()-g),h=Math.max(g,h),s=e.timeRemaining(),1.5*h>s)return i-g<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(i-g))}ms`),void this._start();i=s}this.clear()}}class o extends f{_requestCallback(e){return setTimeout(()=>e(this._createDeadline(16)))}_cancelCallback(e){clearTimeout(e)}_createDeadline(e){const g=Date.now()+e;return{timeRemaining:()=>Math.max(0,g-Date.now())}}}n.PriorityTaskQueue=o,n.IdleTaskQueue=!l.isNode&&"requestIdleCallback"in window?class extends f{_requestCallback(d){return requestIdleCallback(d)}_cancelCallback(d){cancelIdleCallback(d)}}:o,n.DebouncedIdleTask=class{constructor(){this._queue=new n.IdleTaskQueue}set(d){this._queue.clear(),this._queue.enqueue(d)}flush(){this._queue.flush()}}},9282:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.updateWindowsModeWrappedState=void 0;const l=a(643);n.updateWindowsModeWrappedState=function(f){const o=f.buffer.lines.get(f.buffer.ybase+f.buffer.y-1),d=o?.get(f.cols-1),e=f.buffer.lines.get(f.buffer.ybase+f.buffer.y);e&&d&&(e.isWrapped=d[l.CHAR_DATA_CODE_INDEX]!==l.NULL_CELL_CODE&&d[l.CHAR_DATA_CODE_INDEX]!==l.WHITESPACE_CELL_CODE)}},3734:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ExtendedAttrs=n.AttributeData=void 0;class a{constructor(){this.fg=0,this.bg=0,this.extended=new l}static toColorRGB(o){return[o>>>16&255,o>>>8&255,255&o]}static fromColorRGB(o){return(255&o[0])<<16|(255&o[1])<<8|255&o[2]}clone(){const o=new a;return o.fg=this.fg,o.bg=this.bg,o.extended=this.extended.clone(),o}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&0!==this.extended.underlineStyle?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return!(50331648&~this.fg)}isBgRGB(){return!(50331648&~this.bg)}isFgPalette(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)}isBgPalette(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)}isFgDefault(){return!(50331648&this.fg)}isBgDefault(){return!(50331648&this.bg)}isAttributeDefault(){return 0===this.fg&&0===this.bg}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&~this.extended.underlineColor):this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?!(50331648&this.extended.underlineColor):this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}n.AttributeData=a;class l{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(o){this._ext=o}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(o){this._ext&=-469762049,this._ext|=o<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(o){this._ext&=-67108864,this._ext|=67108863&o}get urlId(){return this._urlId}set urlId(o){this._urlId=o}get underlineVariantOffset(){const o=(3758096384&this._ext)>>29;return o<0?4294967288^o:o}set underlineVariantOffset(o){this._ext&=536870911,this._ext|=o<<29&3758096384}constructor(o=0,d=0){this._ext=0,this._urlId=0,this._ext=o,this._urlId=d}clone(){return new l(this._ext,this._urlId)}isEmpty(){return 0===this.underlineStyle&&0===this._urlId}}n.ExtendedAttrs=l},9092:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Buffer=n.MAX_BUFFER_SIZE=void 0;const l=a(6349),f=a(7226),o=a(3734),d=a(8437),e=a(4634),g=a(511),h=a(643),i=a(4863),s=a(7116);n.MAX_BUFFER_SIZE=4294967295,n.Buffer=class{constructor(t,r,c){this._hasScrollback=t,this._optionsService=r,this._bufferService=c,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=d.DEFAULT_ATTR_DATA.clone(),this.savedCharset=s.DEFAULT_CHARSET,this.markers=[],this._nullCell=g.CellData.fromCharData([0,h.NULL_CELL_CHAR,h.NULL_CELL_WIDTH,h.NULL_CELL_CODE]),this._whitespaceCell=g.CellData.fromCharData([0,h.WHITESPACE_CELL_CHAR,h.WHITESPACE_CELL_WIDTH,h.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new f.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(t){return t?(this._nullCell.fg=t.fg,this._nullCell.bg=t.bg,this._nullCell.extended=t.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new o.ExtendedAttrs),this._nullCell}getWhitespaceCell(t){return t?(this._whitespaceCell.fg=t.fg,this._whitespaceCell.bg=t.bg,this._whitespaceCell.extended=t.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new o.ExtendedAttrs),this._whitespaceCell}getBlankLine(t,r){return new d.BufferLine(this._bufferService.cols,this.getNullCell(t),r)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const t=this.ybase+this.y-this.ydisp;return t>=0&&t<this._rows}_getCorrectBufferLength(t){if(!this._hasScrollback)return t;const r=t+this._optionsService.rawOptions.scrollback;return r>n.MAX_BUFFER_SIZE?n.MAX_BUFFER_SIZE:r}fillViewportRows(t){if(0===this.lines.length){void 0===t&&(t=d.DEFAULT_ATTR_DATA);let r=this._rows;for(;r--;)this.lines.push(this.getBlankLine(t))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new l.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(t,r){const c=this.getNullCell(d.DEFAULT_ATTR_DATA);let _=0;const p=this._getCorrectBufferLength(r);if(p>this.lines.maxLength&&(this.lines.maxLength=p),this.lines.length>0){if(this._cols<t)for(let u=0;u<this.lines.length;u++)_+=+this.lines.get(u).resize(t,c);let m=0;if(this._rows<r)for(let u=this._rows;u<r;u++)this.lines.length<r+this.ybase&&(this._optionsService.rawOptions.windowsMode||void 0!==this._optionsService.rawOptions.windowsPty.backend||void 0!==this._optionsService.rawOptions.windowsPty.buildNumber?this.lines.push(new d.BufferLine(t,c)):this.ybase>0&&this.lines.length<=this.ybase+this.y+m+1?(this.ybase--,m++,this.ydisp>0&&this.ydisp--):this.lines.push(new d.BufferLine(t,c)));else for(let u=this._rows;u>r;u--)this.lines.length>r+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(p<this.lines.maxLength){const u=this.lines.length-p;u>0&&(this.lines.trimStart(u),this.ybase=Math.max(this.ybase-u,0),this.ydisp=Math.max(this.ydisp-u,0),this.savedY=Math.max(this.savedY-u,0)),this.lines.maxLength=p}this.x=Math.min(this.x,t-1),this.y=Math.min(this.y,r-1),m&&(this.y+=m),this.savedX=Math.min(this.savedX,t-1),this.scrollTop=0}if(this.scrollBottom=r-1,this._isReflowEnabled&&(this._reflow(t,r),this._cols>t))for(let m=0;m<this.lines.length;m++)_+=+this.lines.get(m).resize(t,c);this._cols=t,this._rows=r,this._memoryCleanupQueue.clear(),_>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let t=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,t=!1);let r=0;for(;this._memoryCleanupPosition<this.lines.length;)if(r+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),r>100)return!0;return t}get _isReflowEnabled(){const t=this._optionsService.rawOptions.windowsPty;return t&&t.buildNumber?this._hasScrollback&&"conpty"===t.backend&&t.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(t,r){this._cols!==t&&(t>this._cols?this._reflowLarger(t,r):this._reflowSmaller(t,r))}_reflowLarger(t,r){const c=(0,e.reflowLargerGetLinesToRemove)(this.lines,this._cols,t,this.ybase+this.y,this.getNullCell(d.DEFAULT_ATTR_DATA));if(c.length>0){const _=(0,e.reflowLargerCreateNewLayout)(this.lines,c);(0,e.reflowLargerApplyNewLayout)(this.lines,_.layout),this._reflowLargerAdjustViewport(t,r,_.countRemoved)}}_reflowLargerAdjustViewport(t,r,c){const _=this.getNullCell(d.DEFAULT_ATTR_DATA);let p=c;for(;p-- >0;)0===this.ybase?(this.y>0&&this.y--,this.lines.length<r&&this.lines.push(new d.BufferLine(t,_))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-c,0)}_reflowSmaller(t,r){const c=this.getNullCell(d.DEFAULT_ATTR_DATA),_=[];let p=0;for(let m=this.lines.length-1;m>=0;m--){let u=this.lines.get(m);if(!u||!u.isWrapped&&u.getTrimmedLength()<=t)continue;const v=[u];for(;u.isWrapped&&m>0;)u=this.lines.get(--m),v.unshift(u);const R=this.ybase+this.y;if(R>=m&&R<m+v.length)continue;const D=v[v.length-1].getTrimmedLength(),B=(0,e.reflowSmallerGetNewLineLengths)(v,this._cols,t),y=B.length-v.length;let O;O=0===this.ybase&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+y):Math.max(0,this.lines.length-this.lines.maxLength+y);const H=[];for(let x=0;x<y;x++){const T=this.getBlankLine(d.DEFAULT_ATTR_DATA,!0);H.push(T)}H.length>0&&(_.push({start:m+v.length+p,newLines:H}),p+=H.length),v.push(...H);let U=B.length-1,z=B[U];0===z&&(U--,z=B[U]);let $=v.length-y-1,S=D;for(;$>=0;){const x=Math.min(S,z);if(void 0===v[U])break;if(v[U].copyCellsFrom(v[$],S-x,z-x,x,!0),z-=x,0===z&&(U--,z=B[U]),S-=x,0===S){$--;const T=Math.max($,0);S=(0,e.getWrappedLineTrimmedLength)(v,T,this._cols)}}for(let x=0;x<v.length;x++)B[x]<t&&v[x].setCell(B[x],c);let w=y-O;for(;w-- >0;)0===this.ybase?this.y<r-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+p)-r&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+y,this.ybase+r-1)}if(_.length>0){const m=[],u=[];for(let U=0;U<this.lines.length;U++)u.push(this.lines.get(U));const v=this.lines.length;let R=v-1,D=0,B=_[D];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+p);let y=0;for(let U=Math.min(this.lines.maxLength-1,v+p-1);U>=0;U--)if(B&&B.start>R+y){for(let z=B.newLines.length-1;z>=0;z--)this.lines.set(U--,B.newLines[z]);U++,m.push({index:R+1,amount:B.newLines.length}),y+=B.newLines.length,B=_[++D]}else this.lines.set(U,u[R--]);let O=0;for(let U=m.length-1;U>=0;U--)m[U].index+=O,this.lines.onInsertEmitter.fire(m[U]),O+=m[U].amount;const H=Math.max(0,v+p-this.lines.maxLength);H>0&&this.lines.onTrimEmitter.fire(H)}}translateBufferLineToString(t,r,c=0,_){const p=this.lines.get(t);return p?p.translateToString(r,c,_):""}getWrappedRangeForLine(t){let r=t,c=t;for(;r>0&&this.lines.get(r).isWrapped;)r--;for(;c+1<this.lines.length&&this.lines.get(c+1).isWrapped;)c++;return{first:r,last:c}}setupTabStops(t){for(null!=t?this.tabs[t]||(t=this.prevStop(t)):(this.tabs={},t=0);t<this._cols;t+=this._optionsService.rawOptions.tabStopWidth)this.tabs[t]=!0}prevStop(t){for(null==t&&(t=this.x);!this.tabs[--t]&&t>0;);return t>=this._cols?this._cols-1:t<0?0:t}nextStop(t){for(null==t&&(t=this.x);!this.tabs[++t]&&t<this._cols;);return t>=this._cols?this._cols-1:t<0?0:t}clearMarkers(t){this._isClearing=!0;for(let r=0;r<this.markers.length;r++)this.markers[r].line===t&&(this.markers[r].dispose(),this.markers.splice(r--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let t=0;t<this.markers.length;t++)this.markers[t].dispose(),this.markers.splice(t--,1);this._isClearing=!1}addMarker(t){const r=new i.Marker(t);return this.markers.push(r),r.register(this.lines.onTrim(c=>{r.line-=c,r.line<0&&r.dispose()})),r.register(this.lines.onInsert(c=>{r.line>=c.index&&(r.line+=c.amount)})),r.register(this.lines.onDelete(c=>{r.line>=c.index&&r.line<c.index+c.amount&&r.dispose(),r.line>c.index&&(r.line-=c.amount)})),r.register(r.onDispose(()=>this._removeMarker(r))),r}_removeMarker(t){this._isClearing||this.markers.splice(this.markers.indexOf(t),1)}}},8437:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferLine=n.DEFAULT_ATTR_DATA=void 0;const l=a(3734),f=a(511),o=a(643),d=a(482);n.DEFAULT_ATTR_DATA=Object.freeze(new l.AttributeData);let e=0;class g{constructor(i,s,t=!1){this.isWrapped=t,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*i);const r=s||f.CellData.fromCharData([0,o.NULL_CELL_CHAR,o.NULL_CELL_WIDTH,o.NULL_CELL_CODE]);for(let c=0;c<i;++c)this.setCell(c,r);this.length=i}get(i){const s=this._data[3*i+0],t=2097151&s;return[this._data[3*i+1],2097152&s?this._combined[i]:t?(0,d.stringFromCodePoint)(t):"",s>>22,2097152&s?this._combined[i].charCodeAt(this._combined[i].length-1):t]}set(i,s){this._data[3*i+1]=s[o.CHAR_DATA_ATTR_INDEX],s[o.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[i]=s[1],this._data[3*i+0]=2097152|i|s[o.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*i+0]=s[o.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|s[o.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(i){return this._data[3*i+0]>>22}hasWidth(i){return 12582912&this._data[3*i+0]}getFg(i){return this._data[3*i+1]}getBg(i){return this._data[3*i+2]}hasContent(i){return 4194303&this._data[3*i+0]}getCodePoint(i){const s=this._data[3*i+0];return 2097152&s?this._combined[i].charCodeAt(this._combined[i].length-1):2097151&s}isCombined(i){return 2097152&this._data[3*i+0]}getString(i){const s=this._data[3*i+0];return 2097152&s?this._combined[i]:2097151&s?(0,d.stringFromCodePoint)(2097151&s):""}isProtected(i){return 536870912&this._data[3*i+2]}loadCell(i,s){return e=3*i,s.content=this._data[e+0],s.fg=this._data[e+1],s.bg=this._data[e+2],2097152&s.content&&(s.combinedData=this._combined[i]),268435456&s.bg&&(s.extended=this._extendedAttrs[i]),s}setCell(i,s){2097152&s.content&&(this._combined[i]=s.combinedData),268435456&s.bg&&(this._extendedAttrs[i]=s.extended),this._data[3*i+0]=s.content,this._data[3*i+1]=s.fg,this._data[3*i+2]=s.bg}setCellFromCodepoint(i,s,t,r){268435456&r.bg&&(this._extendedAttrs[i]=r.extended),this._data[3*i+0]=s|t<<22,this._data[3*i+1]=r.fg,this._data[3*i+2]=r.bg}addCodepointToCell(i,s,t){let r=this._data[3*i+0];2097152&r?this._combined[i]+=(0,d.stringFromCodePoint)(s):2097151&r?(this._combined[i]=(0,d.stringFromCodePoint)(2097151&r)+(0,d.stringFromCodePoint)(s),r&=-2097152,r|=2097152):r=4194304|s,t&&(r&=-12582913,r|=t<<22),this._data[3*i+0]=r}insertCells(i,s,t){if((i%=this.length)&&2===this.getWidth(i-1)&&this.setCellFromCodepoint(i-1,0,1,t),s<this.length-i){const r=new f.CellData;for(let c=this.length-i-s-1;c>=0;--c)this.setCell(i+s+c,this.loadCell(i+c,r));for(let c=0;c<s;++c)this.setCell(i+c,t)}else for(let r=i;r<this.length;++r)this.setCell(r,t);2===this.getWidth(this.length-1)&&this.setCellFromCodepoint(this.length-1,0,1,t)}deleteCells(i,s,t){if(s<this.length-(i%=this.length)){const r=new f.CellData;for(let c=0;c<this.length-i-s;++c)this.setCell(i+c,this.loadCell(i+s+c,r));for(let c=this.length-s;c<this.length;++c)this.setCell(c,t)}else for(let r=i;r<this.length;++r)this.setCell(r,t);i&&2===this.getWidth(i-1)&&this.setCellFromCodepoint(i-1,0,1,t),0!==this.getWidth(i)||this.hasContent(i)||this.setCellFromCodepoint(i,0,1,t)}replaceCells(i,s,t,r=!1){if(r)for(i&&2===this.getWidth(i-1)&&!this.isProtected(i-1)&&this.setCellFromCodepoint(i-1,0,1,t),s<this.length&&2===this.getWidth(s-1)&&!this.isProtected(s)&&this.setCellFromCodepoint(s,0,1,t);i<s&&i<this.length;)this.isProtected(i)||this.setCell(i,t),i++;else for(i&&2===this.getWidth(i-1)&&this.setCellFromCodepoint(i-1,0,1,t),s<this.length&&2===this.getWidth(s-1)&&this.setCellFromCodepoint(s,0,1,t);i<s&&i<this.length;)this.setCell(i++,t)}resize(i,s){if(i===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const t=3*i;if(i>this.length){if(this._data.buffer.byteLength>=4*t)this._data=new Uint32Array(this._data.buffer,0,t);else{const r=new Uint32Array(t);r.set(this._data),this._data=r}for(let r=this.length;r<i;++r)this.setCell(r,s)}else{this._data=this._data.subarray(0,t);const r=Object.keys(this._combined);for(let _=0;_<r.length;_++){const p=parseInt(r[_],10);p>=i&&delete this._combined[p]}const c=Object.keys(this._extendedAttrs);for(let _=0;_<c.length;_++){const p=parseInt(c[_],10);p>=i&&delete this._extendedAttrs[p]}}return this.length=i,4*t*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const i=new Uint32Array(this._data.length);return i.set(this._data),this._data=i,1}return 0}fill(i,s=!1){if(s)for(let t=0;t<this.length;++t)this.isProtected(t)||this.setCell(t,i);else{this._combined={},this._extendedAttrs={};for(let t=0;t<this.length;++t)this.setCell(t,i)}}copyFrom(i){this.length!==i.length?this._data=new Uint32Array(i._data):this._data.set(i._data),this.length=i.length,this._combined={};for(const s in i._combined)this._combined[s]=i._combined[s];this._extendedAttrs={};for(const s in i._extendedAttrs)this._extendedAttrs[s]=i._extendedAttrs[s];this.isWrapped=i.isWrapped}clone(){const i=new g(0);i._data=new Uint32Array(this._data),i.length=this.length;for(const s in this._combined)i._combined[s]=this._combined[s];for(const s in this._extendedAttrs)i._extendedAttrs[s]=this._extendedAttrs[s];return i.isWrapped=this.isWrapped,i}getTrimmedLength(){for(let i=this.length-1;i>=0;--i)if(4194303&this._data[3*i+0])return i+(this._data[3*i+0]>>22);return 0}getNoBgTrimmedLength(){for(let i=this.length-1;i>=0;--i)if(4194303&this._data[3*i+0]||50331648&this._data[3*i+2])return i+(this._data[3*i+0]>>22);return 0}copyCellsFrom(i,s,t,r,c){const _=i._data;if(c)for(let m=r-1;m>=0;m--){for(let u=0;u<3;u++)this._data[3*(t+m)+u]=_[3*(s+m)+u];268435456&_[3*(s+m)+2]&&(this._extendedAttrs[t+m]=i._extendedAttrs[s+m])}else for(let m=0;m<r;m++){for(let u=0;u<3;u++)this._data[3*(t+m)+u]=_[3*(s+m)+u];268435456&_[3*(s+m)+2]&&(this._extendedAttrs[t+m]=i._extendedAttrs[s+m])}const p=Object.keys(i._combined);for(let m=0;m<p.length;m++){const u=parseInt(p[m],10);u>=s&&(this._combined[u-s+t]=i._combined[u])}}translateToString(i,s,t,r){s=s??0,t=t??this.length,i&&(t=Math.min(t,this.getTrimmedLength())),r&&(r.length=0);let c="";for(;s<t;){const _=this._data[3*s+0],p=2097151&_,m=2097152&_?this._combined[s]:p?(0,d.stringFromCodePoint)(p):o.WHITESPACE_CELL_CHAR;if(c+=m,r)for(let u=0;u<m.length;++u)r.push(s);s+=_>>22||1}return r&&r.push(s),c}}n.BufferLine=g},4841:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getRangeLength=void 0,n.getRangeLength=function(a,l){if(a.start.y>a.end.y)throw new Error(`Buffer range end (${a.end.x}, ${a.end.y}) cannot be before start (${a.start.x}, ${a.start.y})`);return l*(a.end.y-a.start.y)+(a.end.x-a.start.x+1)}},4634:(I,n)=>{function a(l,f,o){if(f===l.length-1)return l[f].getTrimmedLength();const d=!l[f].hasContent(o-1)&&1===l[f].getWidth(o-1),e=2===l[f+1].getWidth(0);return d&&e?o-1:o}Object.defineProperty(n,"__esModule",{value:!0}),n.getWrappedLineTrimmedLength=n.reflowSmallerGetNewLineLengths=n.reflowLargerApplyNewLayout=n.reflowLargerCreateNewLayout=n.reflowLargerGetLinesToRemove=void 0,n.reflowLargerGetLinesToRemove=function(l,f,o,d,e){const g=[];for(let h=0;h<l.length-1;h++){let i=h,s=l.get(++i);if(!s.isWrapped)continue;const t=[l.get(h)];for(;i<l.length&&s.isWrapped;)t.push(s),s=l.get(++i);if(d>=h&&d<i){h+=t.length-1;continue}let r=0,c=a(t,r,f),_=1,p=0;for(;_<t.length;){const u=a(t,_,f),D=Math.min(u-p,o-c);t[r].copyCellsFrom(t[_],p,c,D,!1),c+=D,c===o&&(r++,c=0),p+=D,p===u&&(_++,p=0),0===c&&0!==r&&2===t[r-1].getWidth(o-1)&&(t[r].copyCellsFrom(t[r-1],o-1,c++,1,!1),t[r-1].setCell(o-1,e))}t[r].replaceCells(c,o,e);let m=0;for(let u=t.length-1;u>0&&(u>r||0===t[u].getTrimmedLength());u--)m++;m>0&&(g.push(h+t.length-m),g.push(m)),h+=t.length-1}return g},n.reflowLargerCreateNewLayout=function(l,f){const o=[];let d=0,e=f[d],g=0;for(let h=0;h<l.length;h++)if(e===h){const i=f[++d];l.onDeleteEmitter.fire({index:h-g,amount:i}),h+=i-1,g+=i,e=f[++d]}else o.push(h);return{layout:o,countRemoved:g}},n.reflowLargerApplyNewLayout=function(l,f){const o=[];for(let d=0;d<f.length;d++)o.push(l.get(f[d]));for(let d=0;d<o.length;d++)l.set(d,o[d]);l.length=f.length},n.reflowSmallerGetNewLineLengths=function(l,f,o){const d=[],e=l.map((s,t)=>a(l,t,f)).reduce((s,t)=>s+t);let g=0,h=0,i=0;for(;i<e;){if(e-i<o){d.push(e-i);break}g+=o;const s=a(l,h,f);g>s&&(g-=s,h++);const t=2===l[h].getWidth(g-1);t&&g--;const r=t?o-1:o;d.push(r),i+=r}return d},n.getWrappedLineTrimmedLength=a},5295:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferSet=void 0;const l=a(8460),f=a(844),o=a(9092);n.BufferSet=class d extends f.Disposable{constructor(g,h){super(),this._optionsService=g,this._bufferService=h,this._onBufferActivate=this.register(new l.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new o.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new o.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(g){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(g),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(g,h){this._normal.resize(g,h),this._alt.resize(g,h),this.setupTabStops(g)}setupTabStops(g){this._normal.setupTabStops(g),this._alt.setupTabStops(g)}}},511:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CellData=void 0;const l=a(482),f=a(643),o=a(3734);class d extends o.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new o.ExtendedAttrs,this.combinedData=""}static fromCharData(g){const h=new d;return h.setFromCharData(g),h}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,l.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(g){this.fg=g[f.CHAR_DATA_ATTR_INDEX],this.bg=0;let h=!1;if(g[f.CHAR_DATA_CHAR_INDEX].length>2)h=!0;else if(2===g[f.CHAR_DATA_CHAR_INDEX].length){const i=g[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){const s=g[f.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=s&&s<=57343?this.content=1024*(i-55296)+s-56320+65536|g[f.CHAR_DATA_WIDTH_INDEX]<<22:h=!0}else h=!0}else this.content=g[f.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|g[f.CHAR_DATA_WIDTH_INDEX]<<22;h&&(this.combinedData=g[f.CHAR_DATA_CHAR_INDEX],this.content=2097152|g[f.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}n.CellData=d},643:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WHITESPACE_CELL_CODE=n.WHITESPACE_CELL_WIDTH=n.WHITESPACE_CELL_CHAR=n.NULL_CELL_CODE=n.NULL_CELL_WIDTH=n.NULL_CELL_CHAR=n.CHAR_DATA_CODE_INDEX=n.CHAR_DATA_WIDTH_INDEX=n.CHAR_DATA_CHAR_INDEX=n.CHAR_DATA_ATTR_INDEX=n.DEFAULT_EXT=n.DEFAULT_ATTR=n.DEFAULT_COLOR=void 0,n.DEFAULT_COLOR=0,n.DEFAULT_ATTR=256|n.DEFAULT_COLOR<<9,n.DEFAULT_EXT=0,n.CHAR_DATA_ATTR_INDEX=0,n.CHAR_DATA_CHAR_INDEX=1,n.CHAR_DATA_WIDTH_INDEX=2,n.CHAR_DATA_CODE_INDEX=3,n.NULL_CELL_CHAR="",n.NULL_CELL_WIDTH=1,n.NULL_CELL_CODE=0,n.WHITESPACE_CELL_CHAR=" ",n.WHITESPACE_CELL_WIDTH=1,n.WHITESPACE_CELL_CODE=32},4863:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Marker=void 0;const l=a(8460),f=a(844);class o{get id(){return this._id}constructor(e){this.line=e,this.isDisposed=!1,this._disposables=[],this._id=o._nextId++,this._onDispose=this.register(new l.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,f.disposeArray)(this._disposables),this._disposables.length=0)}register(e){return this._disposables.push(e),e}}n.Marker=o,o._nextId=1},7116:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_CHARSET=n.CHARSETS=void 0,n.CHARSETS={},n.DEFAULT_CHARSET=n.CHARSETS.B,n.CHARSETS[0]={"`":"\u25c6",a:"\u2592",b:"\u2409",c:"\u240c",d:"\u240d",e:"\u240a",f:"\xb0",g:"\xb1",h:"\u2424",i:"\u240b",j:"\u2518",k:"\u2510",l:"\u250c",m:"\u2514",n:"\u253c",o:"\u23ba",p:"\u23bb",q:"\u2500",r:"\u23bc",s:"\u23bd",t:"\u251c",u:"\u2524",v:"\u2534",w:"\u252c",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03c0","|":"\u2260","}":"\xa3","~":"\xb7"},n.CHARSETS.A={"#":"\xa3"},n.CHARSETS.B=void 0,n.CHARSETS[4]={"#":"\xa3","@":"\xbe","[":"ij","\\":"\xbd","]":"|","{":"\xa8","|":"f","}":"\xbc","~":"\xb4"},n.CHARSETS.C=n.CHARSETS[5]={"[":"\xc4","\\":"\xd6","]":"\xc5","^":"\xdc","`":"\xe9","{":"\xe4","|":"\xf6","}":"\xe5","~":"\xfc"},n.CHARSETS.R={"#":"\xa3","@":"\xe0","[":"\xb0","\\":"\xe7","]":"\xa7","{":"\xe9","|":"\xf9","}":"\xe8","~":"\xa8"},n.CHARSETS.Q={"@":"\xe0","[":"\xe2","\\":"\xe7","]":"\xea","^":"\xee","`":"\xf4","{":"\xe9","|":"\xf9","}":"\xe8","~":"\xfb"},n.CHARSETS.K={"@":"\xa7","[":"\xc4","\\":"\xd6","]":"\xdc","{":"\xe4","|":"\xf6","}":"\xfc","~":"\xdf"},n.CHARSETS.Y={"#":"\xa3","@":"\xa7","[":"\xb0","\\":"\xe7","]":"\xe9","`":"\xf9","{":"\xe0","|":"\xf2","}":"\xe8","~":"\xec"},n.CHARSETS.E=n.CHARSETS[6]={"@":"\xc4","[":"\xc6","\\":"\xd8","]":"\xc5","^":"\xdc","`":"\xe4","{":"\xe6","|":"\xf8","}":"\xe5","~":"\xfc"},n.CHARSETS.Z={"#":"\xa3","@":"\xa7","[":"\xa1","\\":"\xd1","]":"\xbf","{":"\xb0","|":"\xf1","}":"\xe7"},n.CHARSETS.H=n.CHARSETS[7]={"@":"\xc9","[":"\xc4","\\":"\xd6","]":"\xc5","^":"\xdc","`":"\xe9","{":"\xe4","|":"\xf6","}":"\xe5","~":"\xfc"},n.CHARSETS["="]={"#":"\xf9","@":"\xe0","[":"\xe9","\\":"\xe7","]":"\xea","^":"\xee",_:"\xe8","`":"\xf4","{":"\xe4","|":"\xf6","}":"\xfc","~":"\xfb"}},2584:(I,n)=>{var a,l,f,o;Object.defineProperty(n,"__esModule",{value:!0}),n.C1_ESCAPED=n.C1=n.C0=void 0,(o=a||(n.C0=a={})).NUL="\0",o.SOH="\x01",o.STX="\x02",o.ETX="\x03",o.EOT="\x04",o.ENQ="\x05",o.ACK="\x06",o.BEL="\x07",o.BS="\b",o.HT="\t",o.LF="\n",o.VT="\v",o.FF="\f",o.CR="\r",o.SO="\x0e",o.SI="\x0f",o.DLE="\x10",o.DC1="\x11",o.DC2="\x12",o.DC3="\x13",o.DC4="\x14",o.NAK="\x15",o.SYN="\x16",o.ETB="\x17",o.CAN="\x18",o.EM="\x19",o.SUB="\x1a",o.ESC="\x1b",o.FS="\x1c",o.GS="\x1d",o.RS="\x1e",o.US="\x1f",o.SP=" ",o.DEL="\x7f",function(o){o.PAD="\x80",o.HOP="\x81",o.BPH="\x82",o.NBH="\x83",o.IND="\x84",o.NEL="\x85",o.SSA="\x86",o.ESA="\x87",o.HTS="\x88",o.HTJ="\x89",o.VTS="\x8a",o.PLD="\x8b",o.PLU="\x8c",o.RI="\x8d",o.SS2="\x8e",o.SS3="\x8f",o.DCS="\x90",o.PU1="\x91",o.PU2="\x92",o.STS="\x93",o.CCH="\x94",o.MW="\x95",o.SPA="\x96",o.EPA="\x97",o.SOS="\x98",o.SGCI="\x99",o.SCI="\x9a",o.CSI="\x9b",o.ST="\x9c",o.OSC="\x9d",o.PM="\x9e",o.APC="\x9f"}(l||(n.C1=l={})),function(o){o.ST=`${a.ESC}\\`}(f||(n.C1_ESCAPED=f={}))},7399:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.evaluateKeyboardEvent=void 0;const l=a(2584),f={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};n.evaluateKeyboardEvent=function(o,d,e,g){const h={type:0,cancel:!1,key:void 0},i=(o.shiftKey?1:0)|(o.altKey?2:0)|(o.ctrlKey?4:0)|(o.metaKey?8:0);switch(o.keyCode){case 0:"UIKeyInputUpArrow"===o.key?h.key=d?l.C0.ESC+"OA":l.C0.ESC+"[A":"UIKeyInputLeftArrow"===o.key?h.key=d?l.C0.ESC+"OD":l.C0.ESC+"[D":"UIKeyInputRightArrow"===o.key?h.key=d?l.C0.ESC+"OC":l.C0.ESC+"[C":"UIKeyInputDownArrow"===o.key&&(h.key=d?l.C0.ESC+"OB":l.C0.ESC+"[B");break;case 8:h.key=o.ctrlKey?"\b":l.C0.DEL,o.altKey&&(h.key=l.C0.ESC+h.key);break;case 9:if(o.shiftKey){h.key=l.C0.ESC+"[Z";break}h.key=l.C0.HT,h.cancel=!0;break;case 13:h.key=o.altKey?l.C0.ESC+l.C0.CR:l.C0.CR,h.cancel=!0;break;case 27:h.key=l.C0.ESC,o.altKey&&(h.key=l.C0.ESC+l.C0.ESC),h.cancel=!0;break;case 37:if(o.metaKey)break;i?(h.key=l.C0.ESC+"[1;"+(i+1)+"D",h.key===l.C0.ESC+"[1;3D"&&(h.key=l.C0.ESC+(e?"b":"[1;5D"))):h.key=d?l.C0.ESC+"OD":l.C0.ESC+"[D";break;case 39:if(o.metaKey)break;i?(h.key=l.C0.ESC+"[1;"+(i+1)+"C",h.key===l.C0.ESC+"[1;3C"&&(h.key=l.C0.ESC+(e?"f":"[1;5C"))):h.key=d?l.C0.ESC+"OC":l.C0.ESC+"[C";break;case 38:if(o.metaKey)break;i?(h.key=l.C0.ESC+"[1;"+(i+1)+"A",e||h.key!==l.C0.ESC+"[1;3A"||(h.key=l.C0.ESC+"[1;5A")):h.key=d?l.C0.ESC+"OA":l.C0.ESC+"[A";break;case 40:if(o.metaKey)break;i?(h.key=l.C0.ESC+"[1;"+(i+1)+"B",e||h.key!==l.C0.ESC+"[1;3B"||(h.key=l.C0.ESC+"[1;5B")):h.key=d?l.C0.ESC+"OB":l.C0.ESC+"[B";break;case 45:o.shiftKey||o.ctrlKey||(h.key=l.C0.ESC+"[2~");break;case 46:h.key=i?l.C0.ESC+"[3;"+(i+1)+"~":l.C0.ESC+"[3~";break;case 36:h.key=i?l.C0.ESC+"[1;"+(i+1)+"H":d?l.C0.ESC+"OH":l.C0.ESC+"[H";break;case 35:h.key=i?l.C0.ESC+"[1;"+(i+1)+"F":d?l.C0.ESC+"OF":l.C0.ESC+"[F";break;case 33:o.shiftKey?h.type=2:h.key=o.ctrlKey?l.C0.ESC+"[5;"+(i+1)+"~":l.C0.ESC+"[5~";break;case 34:o.shiftKey?h.type=3:h.key=o.ctrlKey?l.C0.ESC+"[6;"+(i+1)+"~":l.C0.ESC+"[6~";break;case 112:h.key=i?l.C0.ESC+"[1;"+(i+1)+"P":l.C0.ESC+"OP";break;case 113:h.key=i?l.C0.ESC+"[1;"+(i+1)+"Q":l.C0.ESC+"OQ";break;case 114:h.key=i?l.C0.ESC+"[1;"+(i+1)+"R":l.C0.ESC+"OR";break;case 115:h.key=i?l.C0.ESC+"[1;"+(i+1)+"S":l.C0.ESC+"OS";break;case 116:h.key=i?l.C0.ESC+"[15;"+(i+1)+"~":l.C0.ESC+"[15~";break;case 117:h.key=i?l.C0.ESC+"[17;"+(i+1)+"~":l.C0.ESC+"[17~";break;case 118:h.key=i?l.C0.ESC+"[18;"+(i+1)+"~":l.C0.ESC+"[18~";break;case 119:h.key=i?l.C0.ESC+"[19;"+(i+1)+"~":l.C0.ESC+"[19~";break;case 120:h.key=i?l.C0.ESC+"[20;"+(i+1)+"~":l.C0.ESC+"[20~";break;case 121:h.key=i?l.C0.ESC+"[21;"+(i+1)+"~":l.C0.ESC+"[21~";break;case 122:h.key=i?l.C0.ESC+"[23;"+(i+1)+"~":l.C0.ESC+"[23~";break;case 123:h.key=i?l.C0.ESC+"[24;"+(i+1)+"~":l.C0.ESC+"[24~";break;default:if(!o.ctrlKey||o.shiftKey||o.altKey||o.metaKey)if(e&&!g||!o.altKey||o.metaKey)!e||o.altKey||o.ctrlKey||o.shiftKey||!o.metaKey?o.key&&!o.ctrlKey&&!o.altKey&&!o.metaKey&&o.keyCode>=48&&1===o.key.length?h.key=o.key:o.key&&o.ctrlKey&&("_"===o.key&&(h.key=l.C0.US),"@"===o.key&&(h.key=l.C0.NUL)):65===o.keyCode&&(h.type=1);else{const s=f[o.keyCode],t=s?.[o.shiftKey?1:0];if(t)h.key=l.C0.ESC+t;else if(o.keyCode>=65&&o.keyCode<=90){let c=String.fromCharCode(o.ctrlKey?o.keyCode-64:o.keyCode+32);o.shiftKey&&(c=c.toUpperCase()),h.key=l.C0.ESC+c}else if(32===o.keyCode)h.key=l.C0.ESC+(o.ctrlKey?l.C0.NUL:" ");else if("Dead"===o.key&&o.code.startsWith("Key")){let r=o.code.slice(3,4);o.shiftKey||(r=r.toLowerCase()),h.key=l.C0.ESC+r,h.cancel=!0}}else o.keyCode>=65&&o.keyCode<=90?h.key=String.fromCharCode(o.keyCode-64):32===o.keyCode?h.key=l.C0.NUL:o.keyCode>=51&&o.keyCode<=55?h.key=String.fromCharCode(o.keyCode-51+27):56===o.keyCode?h.key=l.C0.DEL:219===o.keyCode?h.key=l.C0.ESC:220===o.keyCode?h.key=l.C0.FS:221===o.keyCode&&(h.key=l.C0.GS)}return h}},482:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Utf8ToUtf32=n.StringToUtf32=n.utf32ToString=n.stringFromCodePoint=void 0,n.stringFromCodePoint=function(a){return a>65535?(a-=65536,String.fromCharCode(55296+(a>>10))+String.fromCharCode(a%1024+56320)):String.fromCharCode(a)},n.utf32ToString=function(a,l=0,f=a.length){let o="";for(let d=l;d<f;++d){let e=a[d];e>65535?(e-=65536,o+=String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):o+=String.fromCharCode(e)}return o},n.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(a,l){const f=a.length;if(!f)return 0;let o=0,d=0;if(this._interim){const e=a.charCodeAt(d++);56320<=e&&e<=57343?l[o++]=1024*(this._interim-55296)+e-56320+65536:(l[o++]=this._interim,l[o++]=e),this._interim=0}for(let e=d;e<f;++e){const g=a.charCodeAt(e);if(55296<=g&&g<=56319){if(++e>=f)return this._interim=g,o;const h=a.charCodeAt(e);56320<=h&&h<=57343?l[o++]=1024*(g-55296)+h-56320+65536:(l[o++]=g,l[o++]=h)}else 65279!==g&&(l[o++]=g)}return o}},n.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(a,l){const f=a.length;if(!f)return 0;let o,d,e,g,h=0,i=0,s=0;if(this.interim[0]){let c=!1,_=this.interim[0];_&=192==(224&_)?31:224==(240&_)?15:7;let p,m=0;for(;(p=63&this.interim[++m])&&m<4;)_<<=6,_|=p;const u=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,v=u-m;for(;s<v;){if(s>=f)return 0;if(p=a[s++],128!=(192&p)){s--,c=!0;break}this.interim[m++]=p,_<<=6,_|=63&p}c||(2===u?_<128?s--:l[h++]=_:3===u?_<2048||_>=55296&&_<=57343||65279===_||(l[h++]=_):_<65536||_>1114111||(l[h++]=_)),this.interim.fill(0)}const t=f-4;let r=s;for(;r<f;){for(;!(!(r<t)||128&(o=a[r])||128&(d=a[r+1])||128&(e=a[r+2])||128&(g=a[r+3]));)l[h++]=o,l[h++]=d,l[h++]=e,l[h++]=g,r+=4;if(o=a[r++],o<128)l[h++]=o;else if(192==(224&o)){if(r>=f)return this.interim[0]=o,h;if(d=a[r++],128!=(192&d)){r--;continue}if(i=(31&o)<<6|63&d,i<128){r--;continue}l[h++]=i}else if(224==(240&o)){if(r>=f)return this.interim[0]=o,h;if(d=a[r++],128!=(192&d)){r--;continue}if(r>=f)return this.interim[0]=o,this.interim[1]=d,h;if(e=a[r++],128!=(192&e)){r--;continue}if(i=(15&o)<<12|(63&d)<<6|63&e,i<2048||i>=55296&&i<=57343||65279===i)continue;l[h++]=i}else if(240==(248&o)){if(r>=f)return this.interim[0]=o,h;if(d=a[r++],128!=(192&d)){r--;continue}if(r>=f)return this.interim[0]=o,this.interim[1]=d,h;if(e=a[r++],128!=(192&e)){r--;continue}if(r>=f)return this.interim[0]=o,this.interim[1]=d,this.interim[2]=e,h;if(g=a[r++],128!=(192&g)){r--;continue}if(i=(7&o)<<18|(63&d)<<12|(63&e)<<6|63&g,i<65536||i>1114111)continue;l[h++]=i}}return h}}},225:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeV6=void 0;const l=a(1480),f=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],o=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let d;n.UnicodeV6=class{constructor(){if(this.version="6",!d){d=new Uint8Array(65536),d.fill(1),d[0]=0,d.fill(0,1,32),d.fill(0,127,160),d.fill(2,4352,4448),d[9001]=2,d[9002]=2,d.fill(2,11904,42192),d[12351]=1,d.fill(2,44032,55204),d.fill(2,63744,64256),d.fill(2,65040,65050),d.fill(2,65072,65136),d.fill(2,65280,65377),d.fill(2,65504,65511);for(let e=0;e<f.length;++e)d.fill(0,f[e][0],f[e][1]+1)}}wcwidth(e){return e<32?0:e<127?1:e<65536?d[e]:function(g,h){let i,s=0,t=h.length-1;if(g<h[0][0]||g>h[t][1])return!1;for(;t>=s;)if(i=s+t>>1,g>h[i][1])s=i+1;else{if(!(g<h[i][0]))return!0;t=i-1}return!1}(e,o)?0:e>=131072&&e<=196605||e>=196608&&e<=262141?2:1}charProperties(e,g){let h=this.wcwidth(e),i=0===h&&0!==g;if(i){const s=l.UnicodeService.extractWidth(g);0===s?i=!1:s>h&&(h=s)}return l.UnicodeService.createPropertyValue(0,h,i)}}},5981:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.WriteBuffer=void 0;const l=a(8460),f=a(844);n.WriteBuffer=class o extends f.Disposable{constructor(e){super(),this._action=e,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new l.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(e,g){if(void 0!==g&&this._syncCalls>g)return void(this._syncCalls=0);if(this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let h;for(this._isSyncWriting=!0;h=this._writeBuffer.shift();){this._action(h);const i=this._callbacks.shift();i&&i()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(e,g){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(g),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(g)}_innerWrite(e=0,g=!0){const h=e||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const i=this._writeBuffer[this._bufferOffset],s=this._action(i,g);if(s){const r=c=>Date.now()-h>=12?setTimeout(()=>this._innerWrite(0,c)):this._innerWrite(h,c);return void s.catch(c=>(queueMicrotask(()=>{throw c}),Promise.resolve(!1))).then(r)}const t=this._callbacks[this._bufferOffset];if(t&&t(),this._bufferOffset++,this._pendingData-=i.length,Date.now()-h>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}},5941:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.toRgbString=n.parseColor=void 0;const a=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,l=/^[\da-f]+$/;function f(o,d){const e=o.toString(16),g=e.length<2?"0"+e:e;switch(d){case 4:return e[0];case 8:return g;case 12:return(g+g).slice(0,3);default:return g+g}}n.parseColor=function(o){if(!o)return;let d=o.toLowerCase();if(0===d.indexOf("rgb:")){d=d.slice(4);const e=a.exec(d);if(e){const g=e[1]?15:e[4]?255:e[7]?4095:65535;return[Math.round(parseInt(e[1]||e[4]||e[7]||e[10],16)/g*255),Math.round(parseInt(e[2]||e[5]||e[8]||e[11],16)/g*255),Math.round(parseInt(e[3]||e[6]||e[9]||e[12],16)/g*255)]}}else if(0===d.indexOf("#")&&(d=d.slice(1),l.exec(d)&&[3,6,9,12].includes(d.length))){const e=d.length/3,g=[0,0,0];for(let h=0;h<3;++h){const i=parseInt(d.slice(e*h,e*h+e),16);g[h]=1===e?i<<4:2===e?i:3===e?i>>4:i>>8}return g}},n.toRgbString=function(o,d=16){const[e,g,h]=o;return`rgb:${f(e,d)}/${f(g,d)}/${f(h,d)}`}},5770:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PAYLOAD_LIMIT=void 0,n.PAYLOAD_LIMIT=1e7},6351:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DcsHandler=n.DcsParser=void 0;const l=a(482),f=a(8742),o=a(5770),d=[];n.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=d,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=d}registerHandler(g,h){void 0===this._handlers[g]&&(this._handlers[g]=[]);const i=this._handlers[g];return i.push(h),{dispose:()=>{const s=i.indexOf(h);-1!==s&&i.splice(s,1)}}}clearHandler(g){this._handlers[g]&&delete this._handlers[g]}setHandlerFallback(g){this._handlerFb=g}reset(){if(this._active.length)for(let g=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;g>=0;--g)this._active[g].unhook(!1);this._stack.paused=!1,this._active=d,this._ident=0}hook(g,h){if(this.reset(),this._ident=g,this._active=this._handlers[g]||d,this._active.length)for(let i=this._active.length-1;i>=0;i--)this._active[i].hook(h);else this._handlerFb(this._ident,"HOOK",h)}put(g,h,i){if(this._active.length)for(let s=this._active.length-1;s>=0;s--)this._active[s].put(g,h,i);else this._handlerFb(this._ident,"PUT",(0,l.utf32ToString)(g,h,i))}unhook(g,h=!0){if(this._active.length){let i=!1,s=this._active.length-1,t=!1;if(this._stack.paused&&(s=this._stack.loopPosition-1,i=h,t=this._stack.fallThrough,this._stack.paused=!1),!t&&!1===i){for(;s>=0&&(i=this._active[s].unhook(g),!0!==i);s--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!1,i;s--}for(;s>=0;s--)if(i=this._active[s].unhook(!1),i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!0,i}else this._handlerFb(this._ident,"UNHOOK",g);this._active=d,this._ident=0}};const e=new f.Params;e.addParam(0),n.DcsHandler=class{constructor(g){this._handler=g,this._data="",this._params=e,this._hitLimit=!1}hook(g){this._params=g.length>1||g.params[0]?g.clone():e,this._data="",this._hitLimit=!1}put(g,h,i){this._hitLimit||(this._data+=(0,l.utf32ToString)(g,h,i),this._data.length>o.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(g){let h=!1;if(this._hitLimit)h=!1;else if(g&&(h=this._handler(this._data,this._params),h instanceof Promise))return h.then(i=>(this._params=e,this._data="",this._hitLimit=!1,i));return this._params=e,this._data="",this._hitLimit=!1,h}}},2015:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.EscapeSequenceParser=n.VT500_TRANSITION_TABLE=n.TransitionTable=void 0;const l=a(844),f=a(8742),o=a(6242),d=a(6351);class e{constructor(s){this.table=new Uint8Array(s)}setDefault(s,t){this.table.fill(s<<4|t)}add(s,t,r,c){this.table[t<<8|s]=r<<4|c}addMany(s,t,r,c){for(let _=0;_<s.length;_++)this.table[t<<8|s[_]]=r<<4|c}}n.TransitionTable=e;const g=160;n.VT500_TRANSITION_TABLE=function(){const i=new e(4095),s=Array.apply(null,Array(256)).map((m,u)=>u),t=(m,u)=>s.slice(m,u),r=t(32,127),c=t(0,24);c.push(25),c.push.apply(c,t(28,32));const _=t(0,14);let p;for(p in i.setDefault(1,0),i.addMany(r,0,2,0),_)i.addMany([24,26,153,154],p,3,0),i.addMany(t(128,144),p,3,0),i.addMany(t(144,152),p,3,0),i.add(156,p,0,0),i.add(27,p,11,1),i.add(157,p,4,8),i.addMany([152,158,159],p,0,7),i.add(155,p,11,3),i.add(144,p,11,9);return i.addMany(c,0,3,0),i.addMany(c,1,3,1),i.add(127,1,0,1),i.addMany(c,8,0,8),i.addMany(c,3,3,3),i.add(127,3,0,3),i.addMany(c,4,3,4),i.add(127,4,0,4),i.addMany(c,6,3,6),i.addMany(c,5,3,5),i.add(127,5,0,5),i.addMany(c,2,3,2),i.add(127,2,0,2),i.add(93,1,4,8),i.addMany(r,8,5,8),i.add(127,8,5,8),i.addMany([156,27,24,26,7],8,6,0),i.addMany(t(28,32),8,0,8),i.addMany([88,94,95],1,0,7),i.addMany(r,7,0,7),i.addMany(c,7,0,7),i.add(156,7,0,0),i.add(127,7,0,7),i.add(91,1,11,3),i.addMany(t(64,127),3,7,0),i.addMany(t(48,60),3,8,4),i.addMany([60,61,62,63],3,9,4),i.addMany(t(48,60),4,8,4),i.addMany(t(64,127),4,7,0),i.addMany([60,61,62,63],4,0,6),i.addMany(t(32,64),6,0,6),i.add(127,6,0,6),i.addMany(t(64,127),6,0,0),i.addMany(t(32,48),3,9,5),i.addMany(t(32,48),5,9,5),i.addMany(t(48,64),5,0,6),i.addMany(t(64,127),5,7,0),i.addMany(t(32,48),4,9,5),i.addMany(t(32,48),1,9,2),i.addMany(t(32,48),2,9,2),i.addMany(t(48,127),2,10,0),i.addMany(t(48,80),1,10,0),i.addMany(t(81,88),1,10,0),i.addMany([89,90,92],1,10,0),i.addMany(t(96,127),1,10,0),i.add(80,1,11,9),i.addMany(c,9,0,9),i.add(127,9,0,9),i.addMany(t(28,32),9,0,9),i.addMany(t(32,48),9,9,12),i.addMany(t(48,60),9,8,10),i.addMany([60,61,62,63],9,9,10),i.addMany(c,11,0,11),i.addMany(t(32,128),11,0,11),i.addMany(t(28,32),11,0,11),i.addMany(c,10,0,10),i.add(127,10,0,10),i.addMany(t(28,32),10,0,10),i.addMany(t(48,60),10,8,10),i.addMany([60,61,62,63],10,0,11),i.addMany(t(32,48),10,9,12),i.addMany(c,12,0,12),i.add(127,12,0,12),i.addMany(t(28,32),12,0,12),i.addMany(t(32,48),12,9,12),i.addMany(t(48,64),12,0,11),i.addMany(t(64,127),12,12,13),i.addMany(t(64,127),10,12,13),i.addMany(t(64,127),9,12,13),i.addMany(c,13,13,13),i.addMany(r,13,13,13),i.add(127,13,0,13),i.addMany([27,156,24,26],13,14,0),i.add(g,0,2,0),i.add(g,8,5,8),i.add(g,6,0,6),i.add(g,11,0,11),i.add(g,13,13,13),i}(),n.EscapeSequenceParser=class h extends l.Disposable{constructor(s=n.VT500_TRANSITION_TABLE){super(),this._transitions=s,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new f.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(t,r,c)=>{},this._executeHandlerFb=t=>{},this._csiHandlerFb=(t,r)=>{},this._escHandlerFb=t=>{},this._errorHandlerFb=t=>t,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,l.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new o.OscParser),this._dcsParser=this.register(new d.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(s,t=[64,126]){let r=0;if(s.prefix){if(s.prefix.length>1)throw new Error("only one byte as prefix supported");if(r=s.prefix.charCodeAt(0),r&&60>r||r>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(s.intermediates){if(s.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let _=0;_<s.intermediates.length;++_){const p=s.intermediates.charCodeAt(_);if(32>p||p>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");r<<=8,r|=p}}if(1!==s.final.length)throw new Error("final must be a single byte");const c=s.final.charCodeAt(0);if(t[0]>c||c>t[1])throw new Error(`final must be in range ${t[0]} .. ${t[1]}`);return r<<=8,r|=c,r}identToString(s){const t=[];for(;s;)t.push(String.fromCharCode(255&s)),s>>=8;return t.reverse().join("")}setPrintHandler(s){this._printHandler=s}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(s,t){const r=this._identifier(s,[48,126]);void 0===this._escHandlers[r]&&(this._escHandlers[r]=[]);const c=this._escHandlers[r];return c.push(t),{dispose:()=>{const _=c.indexOf(t);-1!==_&&c.splice(_,1)}}}clearEscHandler(s){this._escHandlers[this._identifier(s,[48,126])]&&delete this._escHandlers[this._identifier(s,[48,126])]}setEscHandlerFallback(s){this._escHandlerFb=s}setExecuteHandler(s,t){this._executeHandlers[s.charCodeAt(0)]=t}clearExecuteHandler(s){this._executeHandlers[s.charCodeAt(0)]&&delete this._executeHandlers[s.charCodeAt(0)]}setExecuteHandlerFallback(s){this._executeHandlerFb=s}registerCsiHandler(s,t){const r=this._identifier(s);void 0===this._csiHandlers[r]&&(this._csiHandlers[r]=[]);const c=this._csiHandlers[r];return c.push(t),{dispose:()=>{const _=c.indexOf(t);-1!==_&&c.splice(_,1)}}}clearCsiHandler(s){this._csiHandlers[this._identifier(s)]&&delete this._csiHandlers[this._identifier(s)]}setCsiHandlerFallback(s){this._csiHandlerFb=s}registerDcsHandler(s,t){return this._dcsParser.registerHandler(this._identifier(s),t)}clearDcsHandler(s){this._dcsParser.clearHandler(this._identifier(s))}setDcsHandlerFallback(s){this._dcsParser.setHandlerFallback(s)}registerOscHandler(s,t){return this._oscParser.registerHandler(s,t)}clearOscHandler(s){this._oscParser.clearHandler(s)}setOscHandlerFallback(s){this._oscParser.setHandlerFallback(s)}setErrorHandler(s){this._errorHandler=s}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,0!==this._parseStack.state&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(s,t,r,c,_){this._parseStack.state=s,this._parseStack.handlers=t,this._parseStack.handlerPos=r,this._parseStack.transition=c,this._parseStack.chunkPos=_}parse(s,t,r){let c,_=0,p=0,m=0;if(this._parseStack.state)if(2===this._parseStack.state)this._parseStack.state=0,m=this._parseStack.chunkPos+1;else{if(void 0===r||1===this._parseStack.state)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const u=this._parseStack.handlers;let v=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(!1===r&&v>-1)for(;v>=0&&(c=u[v](this._params),!0!==c);v--)if(c instanceof Promise)return this._parseStack.handlerPos=v,c;this._parseStack.handlers=[];break;case 4:if(!1===r&&v>-1)for(;v>=0&&(c=u[v](),!0!==c);v--)if(c instanceof Promise)return this._parseStack.handlerPos=v,c;this._parseStack.handlers=[];break;case 6:if(_=s[this._parseStack.chunkPos],c=this._dcsParser.unhook(24!==_&&26!==_,r),c)return c;27===_&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(_=s[this._parseStack.chunkPos],c=this._oscParser.end(24!==_&&26!==_,r),c)return c;27===_&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,m=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let u=m;u<t;++u){switch(_=s[u],p=this._transitions.table[this.currentState<<8|(_<160?_:g)],p>>4){case 2:for(let y=u+1;;++y){if(y>=t||(_=s[y])<32||_>126&&_<g){this._printHandler(s,u,y),u=y-1;break}if(++y>=t||(_=s[y])<32||_>126&&_<g){this._printHandler(s,u,y),u=y-1;break}if(++y>=t||(_=s[y])<32||_>126&&_<g){this._printHandler(s,u,y),u=y-1;break}if(++y>=t||(_=s[y])<32||_>126&&_<g){this._printHandler(s,u,y),u=y-1;break}}break;case 3:this._executeHandlers[_]?this._executeHandlers[_]():this._executeHandlerFb(_),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:u,code:_,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const v=this._csiHandlers[this._collect<<8|_];let R=v?v.length-1:-1;for(;R>=0&&(c=v[R](this._params),!0!==c);R--)if(c instanceof Promise)return this._preserveStack(3,v,R,p,u),c;R<0&&this._csiHandlerFb(this._collect<<8|_,this._params),this.precedingJoinState=0;break;case 8:do{switch(_){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(_-48)}}while(++u<t&&(_=s[u])>47&&_<60);u--;break;case 9:this._collect<<=8,this._collect|=_;break;case 10:const D=this._escHandlers[this._collect<<8|_];let B=D?D.length-1:-1;for(;B>=0&&(c=D[B](),!0!==c);B--)if(c instanceof Promise)return this._preserveStack(4,D,B,p,u),c;B<0&&this._escHandlerFb(this._collect<<8|_),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|_,this._params);break;case 13:for(let y=u+1;;++y)if(y>=t||24===(_=s[y])||26===_||27===_||_>127&&_<g){this._dcsParser.put(s,u,y),u=y-1;break}break;case 14:if(c=this._dcsParser.unhook(24!==_&&26!==_),c)return this._preserveStack(6,[],0,p,u),c;27===_&&(p|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let y=u+1;;y++)if(y>=t||(_=s[y])<32||_>127&&_<g){this._oscParser.put(s,u,y),u=y-1;break}break;case 6:if(c=this._oscParser.end(24!==_&&26!==_),c)return this._preserveStack(5,[],0,p,u),c;27===_&&(p|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&p}}}},6242:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OscHandler=n.OscParser=void 0;const l=a(5770),f=a(482),o=[];n.OscParser=class{constructor(){this._state=0,this._active=o,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(d,e){void 0===this._handlers[d]&&(this._handlers[d]=[]);const g=this._handlers[d];return g.push(e),{dispose:()=>{const h=g.indexOf(e);-1!==h&&g.splice(h,1)}}}clearHandler(d){this._handlers[d]&&delete this._handlers[d]}setHandlerFallback(d){this._handlerFb=d}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=o}reset(){if(2===this._state)for(let d=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;d>=0;--d)this._active[d].end(!1);this._stack.paused=!1,this._active=o,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||o,this._active.length)for(let d=this._active.length-1;d>=0;d--)this._active[d].start();else this._handlerFb(this._id,"START")}_put(d,e,g){if(this._active.length)for(let h=this._active.length-1;h>=0;h--)this._active[h].put(d,e,g);else this._handlerFb(this._id,"PUT",(0,f.utf32ToString)(d,e,g))}start(){this.reset(),this._state=1}put(d,e,g){if(3!==this._state){if(1===this._state)for(;e<g;){const h=d[e++];if(59===h){this._state=2,this._start();break}if(h<48||57<h)return void(this._state=3);-1===this._id&&(this._id=0),this._id=10*this._id+h-48}2===this._state&&g-e>0&&this._put(d,e,g)}}end(d,e=!0){if(0!==this._state){if(3!==this._state)if(1===this._state&&this._start(),this._active.length){let g=!1,h=this._active.length-1,i=!1;if(this._stack.paused&&(h=this._stack.loopPosition-1,g=e,i=this._stack.fallThrough,this._stack.paused=!1),!i&&!1===g){for(;h>=0&&(g=this._active[h].end(d),!0!==g);h--)if(g instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!1,g;h--}for(;h>=0;h--)if(g=this._active[h].end(!1),g instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!0,g}else this._handlerFb(this._id,"END",d);this._active=o,this._id=-1,this._state=0}}},n.OscHandler=class{constructor(d){this._handler=d,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(d,e,g){this._hitLimit||(this._data+=(0,f.utf32ToString)(d,e,g),this._data.length>l.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(d){let e=!1;if(this._hitLimit)e=!1;else if(d&&(e=this._handler(this._data),e instanceof Promise))return e.then(g=>(this._data="",this._hitLimit=!1,g));return this._data="",this._hitLimit=!1,e}}},8742:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Params=void 0;const a=2147483647;class l{static fromArray(o){const d=new l;if(!o.length)return d;for(let e=Array.isArray(o[0])?1:0;e<o.length;++e){const g=o[e];if(Array.isArray(g))for(let h=0;h<g.length;++h)d.addSubParam(g[h]);else d.addParam(g)}return d}constructor(o=32,d=32){if(this.maxLength=o,this.maxSubParamsLength=d,d>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(o),this.length=0,this._subParams=new Int32Array(d),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(o),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const o=new l(this.maxLength,this.maxSubParamsLength);return o.params.set(this.params),o.length=this.length,o._subParams.set(this._subParams),o._subParamsLength=this._subParamsLength,o._subParamsIdx.set(this._subParamsIdx),o._rejectDigits=this._rejectDigits,o._rejectSubDigits=this._rejectSubDigits,o._digitIsSub=this._digitIsSub,o}toArray(){const o=[];for(let d=0;d<this.length;++d){o.push(this.params[d]);const e=this._subParamsIdx[d]>>8,g=255&this._subParamsIdx[d];g-e>0&&o.push(Array.prototype.slice.call(this._subParams,e,g))}return o}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(o){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(o<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=o>a?a:o}}addSubParam(o){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(o<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=o>a?a:o,this._subParamsIdx[this.length-1]++}}hasSubParams(o){return(255&this._subParamsIdx[o])-(this._subParamsIdx[o]>>8)>0}getSubParams(o){const d=this._subParamsIdx[o]>>8,e=255&this._subParamsIdx[o];return e-d>0?this._subParams.subarray(d,e):null}getSubParamsAll(){const o={};for(let d=0;d<this.length;++d){const e=this._subParamsIdx[d]>>8,g=255&this._subParamsIdx[d];g-e>0&&(o[d]=this._subParams.slice(e,g))}return o}addDigit(o){let d;if(this._rejectDigits||!(d=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const e=this._digitIsSub?this._subParams:this.params,g=e[d-1];e[d-1]=~g?Math.min(10*g+o,a):o}}n.Params=l},5741:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AddonManager=void 0,n.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let a=this._addons.length-1;a>=0;a--)this._addons[a].instance.dispose()}loadAddon(a,l){const f={instance:l,dispose:l.dispose,isDisposed:!1};this._addons.push(f),l.dispose=()=>this._wrappedAddonDispose(f),l.activate(a)}_wrappedAddonDispose(a){if(a.isDisposed)return;let l=-1;for(let f=0;f<this._addons.length;f++)if(this._addons[f]===a){l=f;break}if(-1===l)throw new Error("Could not dispose an addon that has not been loaded");a.isDisposed=!0,a.dispose.apply(a.instance),this._addons.splice(l,1)}}},8771:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferApiView=void 0;const l=a(3785),f=a(511);n.BufferApiView=class{constructor(o,d){this._buffer=o,this.type=d}init(o){return this._buffer=o,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(o){const d=this._buffer.lines.get(o);if(d)return new l.BufferLineApiView(d)}getNullCell(){return new f.CellData}}},3785:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferLineApiView=void 0;const l=a(511);n.BufferLineApiView=class{constructor(f){this._line=f}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(f,o){if(!(f<0||f>=this._line.length))return o?(this._line.loadCell(f,o),o):this._line.loadCell(f,new l.CellData)}translateToString(f,o,d){return this._line.translateToString(f,o,d)}}},8285:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BufferNamespaceApi=void 0;const l=a(8771),f=a(8460),o=a(844);n.BufferNamespaceApi=class d extends o.Disposable{constructor(g){super(),this._core=g,this._onBufferChange=this.register(new f.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new l.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new l.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ParserApi=void 0,n.ParserApi=class{constructor(a){this._core=a}registerCsiHandler(a,l){return this._core.registerCsiHandler(a,f=>l(f.toArray()))}addCsiHandler(a,l){return this.registerCsiHandler(a,l)}registerDcsHandler(a,l){return this._core.registerDcsHandler(a,(f,o)=>l(f,o.toArray()))}addDcsHandler(a,l){return this.registerDcsHandler(a,l)}registerEscHandler(a,l){return this._core.registerEscHandler(a,l)}addEscHandler(a,l){return this.registerEscHandler(a,l)}registerOscHandler(a,l){return this._core.registerOscHandler(a,l)}addOscHandler(a,l){return this.registerOscHandler(a,l)}}},7090:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeApi=void 0,n.UnicodeApi=class{constructor(a){this._core=a}register(a){this._core.unicodeService.register(a)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(a){this._core.unicodeService.activeVersion=a}}},744:function(I,n,a){var l=this&&this.__decorate||function(i,s,t,r){var c,_=arguments.length,p=_<3?s:null===r?r=Object.getOwnPropertyDescriptor(s,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(i,s,t,r);else for(var m=i.length-1;m>=0;m--)(c=i[m])&&(p=(_<3?c(p):_>3?c(s,t,p):c(s,t))||p);return _>3&&p&&Object.defineProperty(s,t,p),p},f=this&&this.__param||function(i,s){return function(t,r){s(t,r,i)}};Object.defineProperty(n,"__esModule",{value:!0}),n.BufferService=n.MINIMUM_ROWS=n.MINIMUM_COLS=void 0;const o=a(8460),d=a(844),e=a(5295),g=a(2585);n.MINIMUM_COLS=2,n.MINIMUM_ROWS=1;let h=n.BufferService=class extends d.Disposable{get buffer(){return this.buffers.active}constructor(i){super(),this.isUserScrolling=!1,this._onResize=this.register(new o.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new o.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(i.rawOptions.cols||0,n.MINIMUM_COLS),this.rows=Math.max(i.rawOptions.rows||0,n.MINIMUM_ROWS),this.buffers=this.register(new e.BufferSet(i,this))}resize(i,s){this.cols=i,this.rows=s,this.buffers.resize(i,s),this._onResize.fire({cols:i,rows:s})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(i,s=!1){const t=this.buffer;let r;r=this._cachedBlankLine,r&&r.length===this.cols&&r.getFg(0)===i.fg&&r.getBg(0)===i.bg||(r=t.getBlankLine(i,s),this._cachedBlankLine=r),r.isWrapped=s;const c=t.ybase+t.scrollTop,_=t.ybase+t.scrollBottom;if(0===t.scrollTop){const p=t.lines.isFull;_===t.lines.length-1?p?t.lines.recycle().copyFrom(r):t.lines.push(r.clone()):t.lines.splice(_+1,0,r.clone()),p?this.isUserScrolling&&(t.ydisp=Math.max(t.ydisp-1,0)):(t.ybase++,this.isUserScrolling||t.ydisp++)}else t.lines.shiftElements(c+1,_-c+1-1,-1),t.lines.set(_,r.clone());this.isUserScrolling||(t.ydisp=t.ybase),this._onScroll.fire(t.ydisp)}scrollLines(i,s,t){const r=this.buffer;if(i<0){if(0===r.ydisp)return;this.isUserScrolling=!0}else i+r.ydisp>=r.ybase&&(this.isUserScrolling=!1);const c=r.ydisp;r.ydisp=Math.max(Math.min(r.ydisp+i,r.ybase),0),c!==r.ydisp&&(s||this._onScroll.fire(r.ydisp))}};n.BufferService=h=l([f(0,g.IOptionsService)],h)},7994:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CharsetService=void 0,n.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(a){this.glevel=a,this.charset=this._charsets[a]}setgCharset(a,l){this._charsets[a]=l,this.glevel===a&&(this.charset=l)}}},1753:function(I,n,a){var l=this&&this.__decorate||function(r,c,_,p){var m,u=arguments.length,v=u<3?c:null===p?p=Object.getOwnPropertyDescriptor(c,_):p;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)v=Reflect.decorate(r,c,_,p);else for(var R=r.length-1;R>=0;R--)(m=r[R])&&(v=(u<3?m(v):u>3?m(c,_,v):m(c,_))||v);return u>3&&v&&Object.defineProperty(c,_,v),v},f=this&&this.__param||function(r,c){return function(_,p){c(_,p,r)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CoreMouseService=void 0;const o=a(2585),d=a(8460),e=a(844),g={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:r=>4!==r.button&&1===r.action&&(r.ctrl=!1,r.alt=!1,r.shift=!1,!0)},VT200:{events:19,restrict:r=>32!==r.action},DRAG:{events:23,restrict:r=>32!==r.action||3!==r.button},ANY:{events:31,restrict:r=>!0}};function h(r,c){let _=(r.ctrl?16:0)|(r.shift?4:0)|(r.alt?8:0);return 4===r.button?(_|=64,_|=r.action):(_|=3&r.button,4&r.button&&(_|=64),8&r.button&&(_|=128),32===r.action?_|=32:0!==r.action||c||(_|=3)),_}const i=String.fromCharCode,s={DEFAULT:r=>{const c=[h(r,!1)+32,r.col+32,r.row+32];return c[0]>255||c[1]>255||c[2]>255?"":`\x1b[M${i(c[0])}${i(c[1])}${i(c[2])}`},SGR:r=>{const c=0===r.action&&4!==r.button?"m":"M";return`\x1b[<${h(r,!0)};${r.col};${r.row}${c}`},SGR_PIXELS:r=>{const c=0===r.action&&4!==r.button?"m":"M";return`\x1b[<${h(r,!0)};${r.x};${r.y}${c}`}};let t=n.CoreMouseService=class extends e.Disposable{constructor(r,c){super(),this._bufferService=r,this._coreService=c,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new d.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const _ of Object.keys(g))this.addProtocol(_,g[_]);for(const _ of Object.keys(s))this.addEncoding(_,s[_]);this.reset()}addProtocol(r,c){this._protocols[r]=c}addEncoding(r,c){this._encodings[r]=c}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return 0!==this._protocols[this._activeProtocol].events}set activeProtocol(r){if(!this._protocols[r])throw new Error(`unknown protocol "${r}"`);this._activeProtocol=r,this._onProtocolChange.fire(this._protocols[r].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(r){if(!this._encodings[r])throw new Error(`unknown encoding "${r}"`);this._activeEncoding=r}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(r){if(r.col<0||r.col>=this._bufferService.cols||r.row<0||r.row>=this._bufferService.rows||4===r.button&&32===r.action||3===r.button&&32!==r.action||4!==r.button&&(2===r.action||3===r.action)||(r.col++,r.row++,32===r.action&&this._lastEvent&&this._equalEvents(this._lastEvent,r,"SGR_PIXELS"===this._activeEncoding))||!this._protocols[this._activeProtocol].restrict(r))return!1;const c=this._encodings[this._activeEncoding](r);return c&&("DEFAULT"===this._activeEncoding?this._coreService.triggerBinaryEvent(c):this._coreService.triggerDataEvent(c,!0)),this._lastEvent=r,!0}explainEvents(r){return{down:!!(1&r),up:!!(2&r),drag:!!(4&r),move:!!(8&r),wheel:!!(16&r)}}_equalEvents(r,c,_){if(_){if(r.x!==c.x||r.y!==c.y)return!1}else if(r.col!==c.col||r.row!==c.row)return!1;return r.button===c.button&&r.action===c.action&&r.ctrl===c.ctrl&&r.alt===c.alt&&r.shift===c.shift}};n.CoreMouseService=t=l([f(0,o.IBufferService),f(1,o.ICoreService)],t)},6975:function(I,n,a){var l=this&&this.__decorate||function(t,r,c,_){var p,m=arguments.length,u=m<3?r:null===_?_=Object.getOwnPropertyDescriptor(r,c):_;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,r,c,_);else for(var v=t.length-1;v>=0;v--)(p=t[v])&&(u=(m<3?p(u):m>3?p(r,c,u):p(r,c))||u);return m>3&&u&&Object.defineProperty(r,c,u),u},f=this&&this.__param||function(t,r){return function(c,_){r(c,_,t)}};Object.defineProperty(n,"__esModule",{value:!0}),n.CoreService=void 0;const o=a(1439),d=a(8460),e=a(844),g=a(2585),h=Object.freeze({insertMode:!1}),i=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let s=n.CoreService=class extends e.Disposable{constructor(t,r,c){super(),this._bufferService=t,this._logService=r,this._optionsService=c,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new d.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new d.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new d.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new d.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,o.clone)(h),this.decPrivateModes=(0,o.clone)(i)}reset(){this.modes=(0,o.clone)(h),this.decPrivateModes=(0,o.clone)(i)}triggerDataEvent(t,r=!1){if(this._optionsService.rawOptions.disableStdin)return;const c=this._bufferService.buffer;r&&this._optionsService.rawOptions.scrollOnUserInput&&c.ybase!==c.ydisp&&this._onRequestScrollToBottom.fire(),r&&this._onUserInput.fire(),this._logService.debug(`sending data "${t}"`,()=>t.split("").map(_=>_.charCodeAt(0))),this._onData.fire(t)}triggerBinaryEvent(t){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${t}"`,()=>t.split("").map(r=>r.charCodeAt(0))),this._onBinary.fire(t))}};n.CoreService=s=l([f(0,g.IBufferService),f(1,g.ILogService),f(2,g.IOptionsService)],s)},9074:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DecorationService=void 0;const l=a(8055),f=a(8460),o=a(844),d=a(6106);let e=0,g=0;n.DecorationService=class h extends o.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new d.SortedList(t=>t?.marker.line),this._onDecorationRegistered=this.register(new f.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new f.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,o.toDisposable)(()=>this.reset()))}registerDecoration(t){if(t.marker.isDisposed)return;const r=new i(t);if(r){const c=r.marker.onDispose(()=>r.dispose());r.onDispose(()=>{r&&(this._decorations.delete(r)&&this._onDecorationRemoved.fire(r),c.dispose())}),this._decorations.insert(r),this._onDecorationRegistered.fire(r)}return r}reset(){for(const t of this._decorations.values())t.dispose();this._decorations.clear()}*getDecorationsAtCell(t,r,c){let _=0,p=0;for(const m of this._decorations.getKeyIterator(r))_=m.options.x??0,p=_+(m.options.width??1),t>=_&&t<p&&(!c||(m.options.layer??"bottom")===c)&&(yield m)}forEachDecorationAtCell(t,r,c,_){this._decorations.forEachByKey(r,p=>{e=p.options.x??0,g=e+(p.options.width??1),t>=e&&t<g&&(!c||(p.options.layer??"bottom")===c)&&_(p)})}};class i extends o.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return null===this._cachedBg&&(this._cachedBg=this.options.backgroundColor?l.css.toColor(this.options.backgroundColor):void 0),this._cachedBg}get foregroundColorRGB(){return null===this._cachedFg&&(this._cachedFg=this.options.foregroundColor?l.css.toColor(this.options.foregroundColor):void 0),this._cachedFg}constructor(t){super(),this.options=t,this.onRenderEmitter=this.register(new f.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new f.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=t.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.InstantiationService=n.ServiceCollection=void 0;const l=a(2585),f=a(8343);class o{constructor(...e){this._entries=new Map;for(const[g,h]of e)this.set(g,h)}set(e,g){const h=this._entries.get(e);return this._entries.set(e,g),h}forEach(e){for(const[g,h]of this._entries.entries())e(g,h)}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}n.ServiceCollection=o,n.InstantiationService=class{constructor(){this._services=new o,this._services.set(l.IInstantiationService,this)}setService(d,e){this._services.set(d,e)}getService(d){return this._services.get(d)}createInstance(d,...e){const g=(0,f.getServiceDependencies)(d).sort((s,t)=>s.index-t.index),h=[];for(const s of g){const t=this._services.get(s.id);if(!t)throw new Error(`[createInstance] ${d.name} depends on UNKNOWN service ${s.id}.`);h.push(t)}const i=g.length>0?g[0].index:e.length;if(e.length!==i)throw new Error(`[createInstance] First service dependency of ${d.name} at position ${i+1} conflicts with ${e.length} static arguments`);return new d(...e,...h)}}},7866:function(I,n,a){var l=this&&this.__decorate||function(i,s,t,r){var c,_=arguments.length,p=_<3?s:null===r?r=Object.getOwnPropertyDescriptor(s,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(i,s,t,r);else for(var m=i.length-1;m>=0;m--)(c=i[m])&&(p=(_<3?c(p):_>3?c(s,t,p):c(s,t))||p);return _>3&&p&&Object.defineProperty(s,t,p),p},f=this&&this.__param||function(i,s){return function(t,r){s(t,r,i)}};Object.defineProperty(n,"__esModule",{value:!0}),n.traceCall=n.setTraceLogger=n.LogService=void 0;const o=a(844),d=a(2585),e={trace:d.LogLevelEnum.TRACE,debug:d.LogLevelEnum.DEBUG,info:d.LogLevelEnum.INFO,warn:d.LogLevelEnum.WARN,error:d.LogLevelEnum.ERROR,off:d.LogLevelEnum.OFF};let g,h=n.LogService=class extends o.Disposable{get logLevel(){return this._logLevel}constructor(i){super(),this._optionsService=i,this._logLevel=d.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),g=this}_updateLogLevel(){this._logLevel=e[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(i){for(let s=0;s<i.length;s++)"function"==typeof i[s]&&(i[s]=i[s]())}_log(i,s,t){this._evalLazyOptionalParams(t),i.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+s,...t)}trace(i,...s){this._logLevel<=d.LogLevelEnum.TRACE&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,i,s)}debug(i,...s){this._logLevel<=d.LogLevelEnum.DEBUG&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,i,s)}info(i,...s){this._logLevel<=d.LogLevelEnum.INFO&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,i,s)}warn(i,...s){this._logLevel<=d.LogLevelEnum.WARN&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,i,s)}error(i,...s){this._logLevel<=d.LogLevelEnum.ERROR&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,i,s)}};n.LogService=h=l([f(0,d.IOptionsService)],h),n.setTraceLogger=function(i){g=i},n.traceCall=function(i,s,t){if("function"!=typeof t.value)throw new Error("not supported");const r=t.value;t.value=function(...c){if(g.logLevel!==d.LogLevelEnum.TRACE)return r.apply(this,c);g.trace(`GlyphRenderer#${r.name}(${c.map(p=>JSON.stringify(p)).join(", ")})`);const _=r.apply(this,c);return g.trace(`GlyphRenderer#${r.name} return`,_),_}}},7302:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OptionsService=n.DEFAULT_OPTIONS=void 0;const l=a(8460),f=a(844),o=a(6114);n.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:o.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const d=["normal","bold","100","200","300","400","500","600","700","800","900"];n.OptionsService=class e extends f.Disposable{constructor(h){super(),this._onOptionChange=this.register(new l.EventEmitter),this.onOptionChange=this._onOptionChange.event;const i={...n.DEFAULT_OPTIONS};for(const s in h)if(s in i)try{i[s]=this._sanitizeAndValidateOption(s,h[s])}catch(t){console.error(t)}this.rawOptions=i,this.options={...i},this._setupOptions(),this.register((0,f.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(h,i){return this.onOptionChange(s=>{s===h&&i(this.rawOptions[h])})}onMultipleOptionChange(h,i){return this.onOptionChange(s=>{-1!==h.indexOf(s)&&i()})}_setupOptions(){const h=s=>{if(!(s in n.DEFAULT_OPTIONS))throw new Error(`No option with key "${s}"`);return this.rawOptions[s]},i=(s,t)=>{if(!(s in n.DEFAULT_OPTIONS))throw new Error(`No option with key "${s}"`);t=this._sanitizeAndValidateOption(s,t),this.rawOptions[s]!==t&&(this.rawOptions[s]=t,this._onOptionChange.fire(s))};for(const s in this.rawOptions){const t={get:h.bind(this,s),set:i.bind(this,s)};Object.defineProperty(this.options,s,t)}}_sanitizeAndValidateOption(h,i){switch(h){case"cursorStyle":if(i||(i=n.DEFAULT_OPTIONS[h]),!function(s){return"block"===s||"underline"===s||"bar"===s}(i))throw new Error(`"${i}" is not a valid value for ${h}`);break;case"wordSeparator":i||(i=n.DEFAULT_OPTIONS[h]);break;case"fontWeight":case"fontWeightBold":if("number"==typeof i&&1<=i&&i<=1e3)break;i=d.includes(i)?i:n.DEFAULT_OPTIONS[h];break;case"cursorWidth":i=Math.floor(i);case"lineHeight":case"tabStopWidth":if(i<1)throw new Error(`${h} cannot be less than 1, value: ${i}`);break;case"minimumContrastRatio":i=Math.max(1,Math.min(21,Math.round(10*i)/10));break;case"scrollback":if((i=Math.min(i,4294967295))<0)throw new Error(`${h} cannot be less than 0, value: ${i}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(i<=0)throw new Error(`${h} cannot be less than or equal to 0, value: ${i}`);break;case"rows":case"cols":if(!i&&0!==i)throw new Error(`${h} must be numeric, value: ${i}`);break;case"windowsPty":i=i??{}}return i}}},2660:function(I,n,a){var l=this&&this.__decorate||function(e,g,h,i){var s,t=arguments.length,r=t<3?g:null===i?i=Object.getOwnPropertyDescriptor(g,h):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,g,h,i);else for(var c=e.length-1;c>=0;c--)(s=e[c])&&(r=(t<3?s(r):t>3?s(g,h,r):s(g,h))||r);return t>3&&r&&Object.defineProperty(g,h,r),r},f=this&&this.__param||function(e,g){return function(h,i){g(h,i,e)}};Object.defineProperty(n,"__esModule",{value:!0}),n.OscLinkService=void 0;const o=a(2585);let d=n.OscLinkService=class{constructor(e){this._bufferService=e,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(e){const g=this._bufferService.buffer;if(void 0===e.id){const c=g.addMarker(g.ybase+g.y),_={data:e,id:this._nextId++,lines:[c]};return c.onDispose(()=>this._removeMarkerFromLink(_,c)),this._dataByLinkId.set(_.id,_),_.id}const h=e,i=this._getEntryIdKey(h),s=this._entriesWithId.get(i);if(s)return this.addLineToLink(s.id,g.ybase+g.y),s.id;const t=g.addMarker(g.ybase+g.y),r={id:this._nextId++,key:this._getEntryIdKey(h),data:h,lines:[t]};return t.onDispose(()=>this._removeMarkerFromLink(r,t)),this._entriesWithId.set(r.key,r),this._dataByLinkId.set(r.id,r),r.id}addLineToLink(e,g){const h=this._dataByLinkId.get(e);if(h&&h.lines.every(i=>i.line!==g)){const i=this._bufferService.buffer.addMarker(g);h.lines.push(i),i.onDispose(()=>this._removeMarkerFromLink(h,i))}}getLinkData(e){return this._dataByLinkId.get(e)?.data}_getEntryIdKey(e){return`${e.id};;${e.uri}`}_removeMarkerFromLink(e,g){const h=e.lines.indexOf(g);-1!==h&&(e.lines.splice(h,1),0===e.lines.length&&(void 0!==e.data.id&&this._entriesWithId.delete(e.key),this._dataByLinkId.delete(e.id)))}};n.OscLinkService=d=l([f(0,o.IBufferService)],d)},8343:(I,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createDecorator=n.getServiceDependencies=n.serviceRegistry=void 0;const a="di$target",l="di$dependencies";n.serviceRegistry=new Map,n.getServiceDependencies=function(f){return f[l]||[]},n.createDecorator=function(f){if(n.serviceRegistry.has(f))return n.serviceRegistry.get(f);const o=function(d,e,g){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");var h,i,s;h=o,s=g,(i=d)[a]===i?i[l].push({id:h,index:s}):(i[l]=[{id:h,index:s}],i[a]=i)};return o.toString=()=>f,n.serviceRegistry.set(f,o),o}},2585:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.IDecorationService=n.IUnicodeService=n.IOscLinkService=n.IOptionsService=n.ILogService=n.LogLevelEnum=n.IInstantiationService=n.ICharsetService=n.ICoreService=n.ICoreMouseService=n.IBufferService=void 0;const l=a(8343);var f,o;n.IBufferService=(0,l.createDecorator)("BufferService"),n.ICoreMouseService=(0,l.createDecorator)("CoreMouseService"),n.ICoreService=(0,l.createDecorator)("CoreService"),n.ICharsetService=(0,l.createDecorator)("CharsetService"),n.IInstantiationService=(0,l.createDecorator)("InstantiationService"),(o=f||(n.LogLevelEnum=f={}))[o.TRACE=0]="TRACE",o[o.DEBUG=1]="DEBUG",o[o.INFO=2]="INFO",o[o.WARN=3]="WARN",o[o.ERROR=4]="ERROR",o[o.OFF=5]="OFF",n.ILogService=(0,l.createDecorator)("LogService"),n.IOptionsService=(0,l.createDecorator)("OptionsService"),n.IOscLinkService=(0,l.createDecorator)("OscLinkService"),n.IUnicodeService=(0,l.createDecorator)("UnicodeService"),n.IDecorationService=(0,l.createDecorator)("DecorationService")},1480:(I,n,a)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.UnicodeService=void 0;const l=a(8460),f=a(225);class o{static extractShouldJoin(e){return!!(1&e)}static extractWidth(e){return e>>1&3}static extractCharKind(e){return e>>3}static createPropertyValue(e,g,h=!1){return(16777215&e)<<3|(3&g)<<1|(h?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new l.EventEmitter,this.onChange=this._onChange.event;const e=new f.UnicodeV6;this.register(e),this._active=e.version,this._activeProvider=e}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(e){if(!this._providers[e])throw new Error(`unknown Unicode version "${e}"`);this._active=e,this._activeProvider=this._providers[e],this._onChange.fire(e)}register(e){this._providers[e.version]=e}wcwidth(e){return this._activeProvider.wcwidth(e)}getStringCellWidth(e){let g=0,h=0;const i=e.length;for(let s=0;s<i;++s){let t=e.charCodeAt(s);if(55296<=t&&t<=56319){if(++s>=i)return g+this.wcwidth(t);const _=e.charCodeAt(s);56320<=_&&_<=57343?t=1024*(t-55296)+_-56320+65536:g+=this.wcwidth(_)}const r=this.charProperties(t,h);let c=o.extractWidth(r);o.extractShouldJoin(r)&&(c-=o.extractWidth(h)),g+=c,h=r}return g}charProperties(e,g){return this._activeProvider.charProperties(e,g)}}n.UnicodeService=o}},K={};function ee(I){var n=K[I];if(void 0!==n)return n.exports;var a=K[I]={exports:{}};return oe[I].call(a.exports,a,a.exports,ee),a.exports}var Z={};return(()=>{var I=Z;Object.defineProperty(I,"__esModule",{value:!0}),I.Terminal=void 0;const n=ee(9042),a=ee(3236),l=ee(844),f=ee(5741),o=ee(8285),d=ee(7975),e=ee(7090),g=["cols","rows"];I.Terminal=class h extends l.Disposable{constructor(s){super(),this._core=this.register(new a.Terminal(s)),this._addonManager=this.register(new f.AddonManager),this._publicOptions={...this._core.options};const t=c=>this._core.options[c],r=(c,_)=>{this._checkReadonlyOptions(c),this._core.options[c]=_};for(const c in this._core.options){const _={get:t.bind(this,c),set:r.bind(this,c)};Object.defineProperty(this._publicOptions,c,_)}}_checkReadonlyOptions(s){if(g.includes(s))throw new Error(`Option "${s}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new d.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new e.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new o.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const s=this._core.coreService.decPrivateModes;let t="none";switch(this._core.coreMouseService.activeProtocol){case"X10":t="x10";break;case"VT200":t="vt200";break;case"DRAG":t="drag";break;case"ANY":t="any"}return{applicationCursorKeysMode:s.applicationCursorKeys,applicationKeypadMode:s.applicationKeypad,bracketedPasteMode:s.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:t,originMode:s.origin,reverseWraparoundMode:s.reverseWraparound,sendFocusMode:s.sendFocus,wraparoundMode:s.wraparound}}get options(){return this._publicOptions}set options(s){for(const t in s)this._publicOptions[t]=s[t]}blur(){this._core.blur()}focus(){this._core.focus()}input(s,t=!0){this._core.input(s,t)}resize(s,t){this._verifyIntegers(s,t),this._core.resize(s,t)}open(s){this._core.open(s)}attachCustomKeyEventHandler(s){this._core.attachCustomKeyEventHandler(s)}attachCustomWheelEventHandler(s){this._core.attachCustomWheelEventHandler(s)}registerLinkProvider(s){return this._core.registerLinkProvider(s)}registerCharacterJoiner(s){return this._checkProposedApi(),this._core.registerCharacterJoiner(s)}deregisterCharacterJoiner(s){this._checkProposedApi(),this._core.deregisterCharacterJoiner(s)}registerMarker(s=0){return this._verifyIntegers(s),this._core.registerMarker(s)}registerDecoration(s){return this._checkProposedApi(),this._verifyPositiveIntegers(s.x??0,s.width??0,s.height??0),this._core.registerDecoration(s)}hasSelection(){return this._core.hasSelection()}select(s,t,r){this._verifyIntegers(s,t,r),this._core.select(s,t,r)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(s,t){this._verifyIntegers(s,t),this._core.selectLines(s,t)}dispose(){super.dispose()}scrollLines(s){this._verifyIntegers(s),this._core.scrollLines(s)}scrollPages(s){this._verifyIntegers(s),this._core.scrollPages(s)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(s){this._verifyIntegers(s),this._core.scrollToLine(s)}clear(){this._core.clear()}write(s,t){this._core.write(s,t)}writeln(s,t){this._core.write(s),this._core.write("\r\n",t)}paste(s){this._core.paste(s)}refresh(s,t){this._verifyIntegers(s,t),this._core.refresh(s,t)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(s){this._addonManager.loadAddon(this,s)}static get strings(){return n}_verifyIntegers(...s){for(const t of s)if(t===1/0||isNaN(t)||t%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...s){for(const t of s)if(t&&(t===1/0||isNaN(t)||t%1!=0||t<0))throw new Error("This API only accepts positive integers")}}})(),Z})()}}]);